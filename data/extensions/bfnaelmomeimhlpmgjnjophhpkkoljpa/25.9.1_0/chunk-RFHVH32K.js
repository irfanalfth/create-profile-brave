import{v as vf}from"./chunk-BBWCN5OU.js";import{p as Tf}from"./chunk-2JLBDXN2.js";import{e as wp}from"./chunk-T2ZXNVG7.js";import{q as Af,v as Ef}from"./chunk-QYQ24YHA.js";import{a as uf}from"./chunk-BB4NLGB2.js";import{A as Yd,Ab as Ss,Ad as bs,B as ds,Bc as Sf,Ca as Jd,Cc as Ot,D as Xd,Db as af,Eb as en,Fb as cf,Gb as pf,Ka as Zd,La as ef,Qa as hp,Ra as tf,Sb as _e,Sc as wf,Tb as Tt,Ub as mf,Vc as rr,Wc as po,Xb as df,Xc as Oe,Yc as hf,Za as rf,Zb as ff,Zc as uo,_a as of,ab as nf,cb as fs,d as Hd,db as sf,e as Mt,eb as Zo,fb as gs,fd as bf,g as $d,h as zd,i as Wd,j as ms,jd as z,kd as vt,ld as or,mc as ws,nc as gf,od as hs,qc as _t,rc as rt,sd as yt,tc as yf,vc as Yn,vd as bp,yb as ys,z as jd}from"./chunk-PQZYPWXP.js";import{d as lf,h as Qr}from"./chunk-FIZDH5HD.js";import{b as Pe}from"./chunk-QDZH7H34.js";import{M as _d,S as Od,ea as Kd,j as Md,o as Ie}from"./chunk-LWOUUIX7.js";import{c as is,h as ss,j as Sp,k as jn}from"./chunk-ETHULGZP.js";import{a as dT}from"./chunk-IBEI3NGL.js";import{e as Ap,g as Tp}from"./chunk-RNP7TDDY.js";import{Aa as Cd,Ac as Me,Bc as Br,C as Ji,Cd as Jo,Ce as co,Db as gt,Ed as cs,Gb as jo,Ge as Fe,Hb as Yo,Hc as Bd,Ie as Gd,Jd as ps,L as Rr,Nd as us,Ob as Dd,Qd as qd,S as Y,Sb as Nd,V as se,Vc as Xo,Xa as Wn,Yd as Vd,Zc as Qd,fb as Rd,fe as ue,gb as I,gd as te,hb as er,ia as so,ib as ee,jb as Nr,jd as as,kd as Ld,mb as tr,md as Ud,me as ls,nb as Wo,nd as je,ob as J,pb as ao,sb as ns,vb as kd,y as Cr}from"./chunk-ERHX3GUR.js";import{n as Go,u as dd}from"./chunk-WY7QFQOG.js";import{c as As}from"./chunk-ZTEVIBRP.js";import{v as Lr}from"./chunk-X6EPTHBD.js";import{c as pt}from"./chunk-DHK5JDA3.js";import{a as k,m as tt,n as Ee}from"./chunk-FI5JCZQR.js";import{$ as M,B as Ne,D as gd,E as yd,G as Ho,H as es,I as Sd,J as wd,L as j,N as de,O as Qt,P as hd,Q as W,V as re,_ as Dr,f as lT,la as Pd,ta as me}from"./chunk-W476YZUB.js";import{c as Zi,e as Zt,f as kr,h as Ko,j as fp,q as Se,s as De,t as fd,u as $e}from"./chunk-ZIPBM4OE.js";import{$ as ft,T as $o,U as Td,W as vd,X as zo,Y as mT,Z as Ed,_ as Ut,a as d,b as V,ba as yp,c as H,ca as xd,da as ne,ea as Id,fa as Fd,ga as et,ha as os,o as bd,p as Ad,q as ts,t as gp,v as rs,w as Lt,x as X}from"./chunk-HTY4DAML.js";import{a as U}from"./chunk-6MAAUKN7.js";import{c as Ze,f as D,h as s,i as m,l as uT,m as Buffer,n as a}from"./chunk-3KENBVE7.js";var Cf=Ze((nr,Pf)=>{s();a();var Ff=typeof self<"u"?self:nr,vs=function(){function t(){this.fetch=!1,this.DOMException=Ff.DOMException}return t.prototype=Ff,new t}();(function(t){var e=function(r){var o={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function n(v){return v&&DataView.prototype.isPrototypeOf(v)}if(o.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(v){return v&&i.indexOf(Object.prototype.toString.call(v))>-1};function p(v){if(typeof v!="string"&&(v=String(v)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(v))throw new TypeError("Invalid character in header field name");return v.toLowerCase()}function u(v){return typeof v!="string"&&(v=String(v)),v}function l(v){var x={next:function(){var P=v.shift();return{done:P===void 0,value:P}}};return o.iterable&&(x[Symbol.iterator]=function(){return x}),x}function f(v){this.map={},v instanceof f?v.forEach(function(x,P){this.append(P,x)},this):Array.isArray(v)?v.forEach(function(x){this.append(x[0],x[1])},this):v&&Object.getOwnPropertyNames(v).forEach(function(x){this.append(x,v[x])},this)}f.prototype.append=function(v,x){v=p(v),x=u(x);var P=this.map[v];this.map[v]=P?P+", "+x:x},f.prototype.delete=function(v){delete this.map[p(v)]},f.prototype.get=function(v){return v=p(v),this.has(v)?this.map[v]:null},f.prototype.has=function(v){return this.map.hasOwnProperty(p(v))},f.prototype.set=function(v,x){this.map[p(v)]=u(x)},f.prototype.forEach=function(v,x){for(var P in this.map)this.map.hasOwnProperty(P)&&v.call(x,this.map[P],P,this)},f.prototype.keys=function(){var v=[];return this.forEach(function(x,P){v.push(P)}),l(v)},f.prototype.values=function(){var v=[];return this.forEach(function(x){v.push(x)}),l(v)},f.prototype.entries=function(){var v=[];return this.forEach(function(x,P){v.push([P,x])}),l(v)},o.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);function g(v){if(v.bodyUsed)return Promise.reject(new TypeError("Already read"));v.bodyUsed=!0}function y(v){return new Promise(function(x,P){v.onload=function(){x(v.result)},v.onerror=function(){P(v.error)}})}function w(v){var x=new FileReader,P=y(x);return x.readAsArrayBuffer(v),P}function S(v){var x=new FileReader,P=y(x);return x.readAsText(v),P}function h(v){for(var x=new Uint8Array(v),P=new Array(x.length),Q=0;Q<x.length;Q++)P[Q]=String.fromCharCode(x[Q]);return P.join("")}function b(v){if(v.slice)return v.slice(0);var x=new Uint8Array(v.byteLength);return x.set(new Uint8Array(v)),x.buffer}function E(){return this.bodyUsed=!1,this._initBody=function(v){this._bodyInit=v,v?typeof v=="string"?this._bodyText=v:o.blob&&Blob.prototype.isPrototypeOf(v)?this._bodyBlob=v:o.formData&&FormData.prototype.isPrototypeOf(v)?this._bodyFormData=v:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)?this._bodyText=v.toString():o.arrayBuffer&&o.blob&&n(v)?(this._bodyArrayBuffer=b(v.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(v)||c(v))?this._bodyArrayBuffer=b(v):this._bodyText=v=Object.prototype.toString.call(v):this._bodyText="",this.headers.get("content-type")||(typeof v=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var v=g(this);if(v)return v;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(w)}),this.text=function(){var v=g(this);if(v)return v;if(this._bodyBlob)return S(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(h(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(B)}),this.json=function(){return this.text().then(JSON.parse)},this}var T=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function F(v){var x=v.toUpperCase();return T.indexOf(x)>-1?x:v}function C(v,x){x=x||{};var P=x.body;if(v instanceof C){if(v.bodyUsed)throw new TypeError("Already read");this.url=v.url,this.credentials=v.credentials,x.headers||(this.headers=new f(v.headers)),this.method=v.method,this.mode=v.mode,this.signal=v.signal,!P&&v._bodyInit!=null&&(P=v._bodyInit,v.bodyUsed=!0)}else this.url=String(v);if(this.credentials=x.credentials||this.credentials||"same-origin",(x.headers||!this.headers)&&(this.headers=new f(x.headers)),this.method=F(x.method||this.method||"GET"),this.mode=x.mode||this.mode||null,this.signal=x.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&P)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(P)}C.prototype.clone=function(){return new C(this,{body:this._bodyInit})};function B(v){var x=new FormData;return v.trim().split("&").forEach(function(P){if(P){var Q=P.split("="),_=Q.shift().replace(/\+/g," "),R=Q.join("=").replace(/\+/g," ");x.append(decodeURIComponent(_),decodeURIComponent(R))}}),x}function q(v){var x=new f,P=v.replace(/\r?\n[\t ]+/g," ");return P.split(/\r?\n/).forEach(function(Q){var _=Q.split(":"),R=_.shift().trim();if(R){var O=_.join(":").trim();x.append(R,O)}}),x}E.call(C.prototype);function L(v,x){x||(x={}),this.type="default",this.status=x.status===void 0?200:x.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in x?x.statusText:"OK",this.headers=new f(x.headers),this.url=x.url||"",this._initBody(v)}E.call(L.prototype),L.prototype.clone=function(){return new L(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},L.error=function(){var v=new L(null,{status:0,statusText:""});return v.type="error",v};var K=[301,302,303,307,308];L.redirect=function(v,x){if(K.indexOf(x)===-1)throw new RangeError("Invalid status code");return new L(null,{status:x,headers:{location:v}})},r.DOMException=t.DOMException;try{new r.DOMException}catch{r.DOMException=function(x,P){this.message=x,this.name=P;var Q=Error(x);this.stack=Q.stack},r.DOMException.prototype=Object.create(Error.prototype),r.DOMException.prototype.constructor=r.DOMException}function G(v,x){return new Promise(function(P,Q){var _=new C(v,x);if(_.signal&&_.signal.aborted)return Q(new r.DOMException("Aborted","AbortError"));var R=new XMLHttpRequest;function O(){R.abort()}R.onload=function(){var $={status:R.status,statusText:R.statusText,headers:q(R.getAllResponseHeaders()||"")};$.url="responseURL"in R?R.responseURL:$.headers.get("X-Request-URL");var N="response"in R?R.response:R.responseText;P(new L(N,$))},R.onerror=function(){Q(new TypeError("Network request failed"))},R.ontimeout=function(){Q(new TypeError("Network request failed"))},R.onabort=function(){Q(new r.DOMException("Aborted","AbortError"))},R.open(_.method,_.url,!0),_.credentials==="include"?R.withCredentials=!0:_.credentials==="omit"&&(R.withCredentials=!1),"responseType"in R&&o.blob&&(R.responseType="blob"),_.headers.forEach(function($,N){R.setRequestHeader(N,$)}),_.signal&&(_.signal.addEventListener("abort",O),R.onreadystatechange=function(){R.readyState===4&&_.signal.removeEventListener("abort",O)}),R.send(typeof _._bodyInit>"u"?null:_._bodyInit)})}return G.polyfill=!0,t.fetch||(t.fetch=G,t.Headers=f,t.Request=C,t.Response=L),r.Headers=f,r.Request=C,r.Response=L,r.fetch=G,Object.defineProperty(r,"__esModule",{value:!0}),r}({})})(vs);vs.fetch.ponyfill=!0;delete vs.fetch.polyfill;var tn=vs;nr=tn.fetch;nr.default=tn.fetch;nr.fetch=tn.fetch;nr.Headers=tn.Headers;nr.Request=tn.Request;nr.Response=tn.Response;Pf.exports=nr});var kf=Ze((vB,Rf)=>{s();a();(function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(r,o){return r<<o|r>>>32-o},rotr:function(r,o){return r<<32-o|r>>>o},endian:function(r){if(r.constructor==Number)return e.rotl(r,8)&16711935|e.rotl(r,24)&4278255360;for(var o=0;o<r.length;o++)r[o]=e.endian(r[o]);return r},randomBytes:function(r){for(var o=[];r>0;r--)o.push(Math.floor(Math.random()*256));return o},bytesToWords:function(r){for(var o=[],n=0,i=0;n<r.length;n++,i+=8)o[i>>>5]|=r[n]<<24-i%32;return o},wordsToBytes:function(r){for(var o=[],n=0;n<r.length*32;n+=8)o.push(r[n>>>5]>>>24-n%32&255);return o},bytesToHex:function(r){for(var o=[],n=0;n<r.length;n++)o.push((r[n]>>>4).toString(16)),o.push((r[n]&15).toString(16));return o.join("")},hexToBytes:function(r){for(var o=[],n=0;n<r.length;n+=2)o.push(parseInt(r.substr(n,2),16));return o},bytesToBase64:function(r){for(var o=[],n=0;n<r.length;n+=3)for(var i=r[n]<<16|r[n+1]<<8|r[n+2],c=0;c<4;c++)n*8+c*6<=r.length*8?o.push(t.charAt(i>>>6*(3-c)&63)):o.push("=");return o.join("")},base64ToBytes:function(r){r=r.replace(/[^A-Z0-9+\/]/ig,"");for(var o=[],n=0,i=0;n<r.length;i=++n%4)i!=0&&o.push((t.indexOf(r.charAt(n-1))&Math.pow(2,-2*i+8)-1)<<i*2|t.indexOf(r.charAt(n))>>>6-i*2);return o}};Rf.exports=e})()});var Ip=Ze((IB,Df)=>{s();a();var xp={utf8:{stringToBytes:function(t){return xp.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(xp.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(t.charCodeAt(r)&255);return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}};Df.exports=xp});var Bf=Ze((CB,Nf)=>{s();a();(function(){var t=kf(),e=Ip().utf8,r=Ip().bin,o=function(i){i.constructor==String?i=e.stringToBytes(i):typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(i)?i=Array.prototype.slice.call(i,0):Array.isArray(i)||(i=i.toString());var c=t.bytesToWords(i),p=i.length*8,u=[],l=1732584193,f=-271733879,g=-1732584194,y=271733878,w=-1009589776;c[p>>5]|=128<<24-p%32,c[(p+64>>>9<<4)+15]=p;for(var S=0;S<c.length;S+=16){for(var h=l,b=f,E=g,T=y,F=w,C=0;C<80;C++){if(C<16)u[C]=c[S+C];else{var B=u[C-3]^u[C-8]^u[C-14]^u[C-16];u[C]=B<<1|B>>>31}var q=(l<<5|l>>>27)+w+(u[C]>>>0)+(C<20?(f&g|~f&y)+1518500249:C<40?(f^g^y)+1859775393:C<60?(f&g|f&y|g&y)-1894007588:(f^g^y)-899497514);w=y,y=g,g=f<<30|f>>>2,f=l,l=q}l+=h,f+=b,g+=E,y+=T,w+=F}return[l,f,g,y,w]},n=function(i,c){var p=t.wordsToBytes(o(i));return c&&c.asBytes?p:c&&c.asString?r.bytesToString(p):t.bytesToHex(p)};n._blocksize=16,n._digestsize=20,Nf.exports=n})()});var Uf=Ze((LB,ST)=>{ST.exports={name:"@phantom-labs/blocklist",version:"0.13.0",main:"index.js",types:"index.d.ts",repository:"git@github.com:phantom-labs/blocklist.git",author:"Jordan Leigh <AlwaysBCoding@gmail.com>",license:"MIT",scripts:{build:"node build.js"},dependencies:{"js-yaml":"^4.1.0",sha3:"^2.1.4"}}});var Mf=Ze((UB,wT)=>{wT.exports={blocklist:["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],whitelist:[],fuzzylist:[],contentHash:"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}});var _f=Ze(Cp=>{s();a();var{version:hT}=Uf(),bT=Mf(),AT=()=>hT,TT=()=>bT;Cp.getVersion=AT;Cp.getBlocklist=TT});var qf=Ze(on=>{"use strict";s();a();on.__esModule=!0;on.distance=on.closest=void 0;var ir=new Uint32Array(65536),vT=function(t,e){for(var r=t.length,o=e.length,n=1<<r-1,i=-1,c=0,p=r,u=r;u--;)ir[t.charCodeAt(u)]|=1<<u;for(u=0;u<o;u++){var l=ir[e.charCodeAt(u)],f=l|c;l|=(l&i)+i^i,c|=~(l|i),i&=l,c&n&&p++,i&n&&p--,c=c<<1|1,i=i<<1|~(f|c),c&=f}for(u=r;u--;)ir[t.charCodeAt(u)]=0;return p},ET=function(t,e){for(var r=e.length,o=t.length,n=[],i=[],c=Math.ceil(r/32),p=Math.ceil(o/32),u=0;u<c;u++)i[u]=-1,n[u]=0;for(var l=0;l<p-1;l++){for(var f=0,g=-1,y=l*32,w=Math.min(32,o)+y,S=y;S<w;S++)ir[t.charCodeAt(S)]|=1<<S;for(var u=0;u<r;u++){var h=ir[e.charCodeAt(u)],b=i[u/32|0]>>>u&1,E=n[u/32|0]>>>u&1,T=h|f,F=((h|E)&g)+g^g|h|E,C=f|~(F|g),B=g&F;C>>>31^b&&(i[u/32|0]^=1<<u),B>>>31^E&&(n[u/32|0]^=1<<u),C=C<<1|b,B=B<<1|E,g=B|~(T|C),f=C&T}for(var S=y;S<w;S++)ir[t.charCodeAt(S)]=0}for(var q=0,L=-1,K=l*32,G=Math.min(32,o-K)+K,S=K;S<G;S++)ir[t.charCodeAt(S)]|=1<<S;for(var v=o,u=0;u<r;u++){var h=ir[e.charCodeAt(u)],b=i[u/32|0]>>>u&1,E=n[u/32|0]>>>u&1,T=h|q,F=((h|E)&L)+L^L|h|E,C=q|~(F|L),B=L&F;v+=C>>>o-1&1,v-=B>>>o-1&1,C>>>31^b&&(i[u/32|0]^=1<<u),B>>>31^E&&(n[u/32|0]^=1<<u),C=C<<1|b,B=B<<1|E,L=B|~(T|C),q=C&T}for(var S=K;S<G;S++)ir[t.charCodeAt(S)]=0;return v},Of=function(t,e){if(t.length<e.length){var r=e;e=t,t=r}return e.length===0?t.length:t.length<=32?vT(t,e):ET(t,e)};on.distance=Of;var xT=function(t,e){for(var r=1/0,o=0,n=0;n<e.length;n++){var i=Of(t,e[n]);i<r&&(r=i,o=n)}return e[o]};on.closest=xT});var Vf=Ze((Rp,Xn)=>{s();a();(function(){"use strict";var t;try{t=typeof Intl<"u"&&typeof Intl.Collator<"u"?Intl.Collator("generic",{sensitivity:"base"}):null}catch{console.log("Collator could not be initialized and wouldn't be used")}var e=qf(),r=[],o=[],n={get:function(i,c,p){var u=p&&t&&p.useCollator;if(u){var l=i.length,f=c.length;if(l===0)return f;if(f===0)return l;var g,y,w,S,h;for(w=0;w<f;++w)r[w]=w,o[w]=c.charCodeAt(w);r[f]=f;var b;for(w=0;w<l;++w){for(y=w+1,S=0;S<f;++S)g=y,b=t.compare(i.charAt(w),String.fromCharCode(o[S]))===0,y=r[S]+(b?0:1),h=g+1,y>h&&(y=h),h=r[S+1]+1,y>h&&(y=h),r[S]=g;r[S]=y}return y}return e.distance(i,c)}};typeof define<"u"&&define!==null&&define.amd?define(function(){return n}):typeof Xn<"u"&&Xn!==null&&typeof Rp<"u"&&Xn.exports===Rp?Xn.exports=n:(typeof self<"u"&&typeof self.postMessage=="function"&&typeof self.importScripts=="function"||typeof self<"u"&&self!==null)&&(self.Levenshtein=n)})()});var Fy=Ze((oi,cn)=>{s();a();var oy=200,cv="Expected a function",Pu="__lodash_hash_undefined__",Os=1,un=2,Cu=1/0,ny=9007199254740991,Qs="[object Arguments]",Au="[object Array]",iy="[object Boolean]",sy="[object Date]",ay="[object Error]",cy="[object Function]",pv="[object GeneratorFunction]",Ls="[object Map]",py="[object Number]",an="[object Object]",Wg="[object Promise]",uy="[object RegExp]",Us="[object Set]",ly="[object String]",my="[object Symbol]",Tu="[object WeakMap]",dy="[object ArrayBuffer]",Ms="[object DataView]",uv="[object Float32Array]",lv="[object Float64Array]",mv="[object Int8Array]",dv="[object Int16Array]",fv="[object Int32Array]",gv="[object Uint8Array]",yv="[object Uint8ClampedArray]",Sv="[object Uint16Array]",wv="[object Uint32Array]",hv=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bv=/^\w*$/,Av=/^\./,Tv=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vv=/[\\^$.*+?()[\]{}|]/g,Ev=/\\(\\)?/g,xv=/^\[object .+?Constructor\]$/,Iv=/^(?:0|[1-9]\d*)$/,we={};we[uv]=we[lv]=we[mv]=we[dv]=we[fv]=we[gv]=we[yv]=we[Sv]=we[wv]=!0;we[Qs]=we[Au]=we[dy]=we[iy]=we[Ms]=we[sy]=we[ay]=we[cy]=we[Ls]=we[py]=we[an]=we[uy]=we[Us]=we[ly]=we[Tu]=!1;var fy=typeof self=="object"&&self&&self.Object===Object&&self,Fv=typeof self=="object"&&self&&self.Object===Object&&self,_r=fy||Fv||Function("return this")(),gy=typeof oi=="object"&&oi&&!oi.nodeType&&oi,jg=gy&&typeof cn=="object"&&cn&&!cn.nodeType&&cn,Pv=jg&&jg.exports===gy,Yg=Pv&&fy.process,Xg=function(){try{return Yg&&Yg.binding("util")}catch{}}(),Jg=Xg&&Xg.isTypedArray;function Cv(t,e){var r=t?t.length:0;return!!r&&Nv(t,e,0)>-1}function Rv(t,e,r){for(var o=-1,n=t?t.length:0;++o<n;)if(r(e,t[o]))return!0;return!1}function kv(t,e){for(var r=-1,o=t?t.length:0;++r<o;)if(e(t[r],r,t))return!0;return!1}function Dv(t,e,r,o){for(var n=t.length,i=r+(o?1:-1);o?i--:++i<n;)if(e(t[i],i,t))return i;return-1}function Nv(t,e,r){if(e!==e)return Dv(t,Bv,r);for(var o=r-1,n=t.length;++o<n;)if(t[o]===e)return o;return-1}function Bv(t){return t!==t}function Qv(t){return function(e){return e?.[t]}}function Lv(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}function Uv(t){return function(e){return t(e)}}function Mv(t,e){return t.has(e)}function _v(t,e){return t?.[e]}function vu(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function Ov(t){var e=-1,r=Array(t.size);return t.forEach(function(o,n){r[++e]=[n,o]}),r}function qv(t,e){return function(r){return t(e(r))}}function Ru(t){var e=-1,r=Array(t.size);return t.forEach(function(o){r[++e]=o}),r}var Vv=Array.prototype,Gv=Function.prototype,qs=Object.prototype,hu=_r["__core-js_shared__"],Zg=function(){var t=/[^.]+$/.exec(hu&&hu.keys&&hu.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),yy=Gv.toString,cr=qs.hasOwnProperty,ln=qs.toString,Kv=RegExp("^"+yy.call(cr).replace(vv,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ey=_r.Symbol,ty=_r.Uint8Array,Hv=qs.propertyIsEnumerable,$v=Vv.splice,zv=qv(Object.keys,Object),Eu=mn(_r,"DataView"),ni=mn(_r,"Map"),xu=mn(_r,"Promise"),pn=mn(_r,"Set"),Iu=mn(_r,"WeakMap"),ii=mn(Object,"create"),Wv=yo(Eu),jv=yo(ni),Yv=yo(xu),Xv=yo(pn),Jv=yo(Iu),_s=ey?ey.prototype:void 0,bu=_s?_s.valueOf:void 0,ry=_s?_s.toString:void 0;function fo(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function Zv(){this.__data__=ii?ii(null):{}}function eE(t){return this.has(t)&&delete this.__data__[t]}function tE(t){var e=this.__data__;if(ii){var r=e[t];return r===Pu?void 0:r}return cr.call(e,t)?e[t]:void 0}function rE(t){var e=this.__data__;return ii?e[t]!==void 0:cr.call(e,t)}function oE(t,e){var r=this.__data__;return r[t]=ii&&e===void 0?Pu:e,this}fo.prototype.clear=Zv;fo.prototype.delete=eE;fo.prototype.get=tE;fo.prototype.has=rE;fo.prototype.set=oE;function pr(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function nE(){this.__data__=[]}function iE(t){var e=this.__data__,r=Vs(e,t);if(r<0)return!1;var o=e.length-1;return r==o?e.pop():$v.call(e,r,1),!0}function sE(t){var e=this.__data__,r=Vs(e,t);return r<0?void 0:e[r][1]}function aE(t){return Vs(this.__data__,t)>-1}function cE(t,e){var r=this.__data__,o=Vs(r,t);return o<0?r.push([t,e]):r[o][1]=e,this}pr.prototype.clear=nE;pr.prototype.delete=iE;pr.prototype.get=sE;pr.prototype.has=aE;pr.prototype.set=cE;function ur(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function pE(){this.__data__={hash:new fo,map:new(ni||pr),string:new fo}}function uE(t){return Gs(this,t).delete(t)}function lE(t){return Gs(this,t).get(t)}function mE(t){return Gs(this,t).has(t)}function dE(t,e){return Gs(this,t).set(t,e),this}ur.prototype.clear=pE;ur.prototype.delete=uE;ur.prototype.get=lE;ur.prototype.has=mE;ur.prototype.set=dE;function si(t){var e=-1,r=t?t.length:0;for(this.__data__=new ur;++e<r;)this.add(t[e])}function fE(t){return this.__data__.set(t,Pu),this}function gE(t){return this.__data__.has(t)}si.prototype.add=si.prototype.push=fE;si.prototype.has=gE;function ar(t){this.__data__=new pr(t)}function yE(){this.__data__=new pr}function SE(t){return this.__data__.delete(t)}function wE(t){return this.__data__.get(t)}function hE(t){return this.__data__.has(t)}function bE(t,e){var r=this.__data__;if(r instanceof pr){var o=r.__data__;if(!ni||o.length<oy-1)return o.push([t,e]),this;r=this.__data__=new ur(o)}return r.set(t,e),this}ar.prototype.clear=yE;ar.prototype.delete=SE;ar.prototype.get=wE;ar.prototype.has=hE;ar.prototype.set=bE;function AE(t,e){var r=go(t)||Ey(t)?Lv(t.length,String):[],o=r.length,n=!!o;for(var i in t)(e||cr.call(t,i))&&!(n&&(i=="length"||by(i,o)))&&r.push(i);return r}function Vs(t,e){for(var r=t.length;r--;)if(vy(t[r][0],e))return r;return-1}function Sy(t,e){e=Ks(e,t)?[e]:wy(e);for(var r=0,o=e.length;t!=null&&r<o;)t=t[Hs(e[r++])];return r&&r==o?t:void 0}function TE(t){return ln.call(t)}function vE(t,e){return t!=null&&e in Object(t)}function ku(t,e,r,o,n){return t===e?!0:t==null||e==null||!$s(t)&&!zs(e)?t!==t&&e!==e:EE(t,e,ku,r,o,n)}function EE(t,e,r,o,n,i){var c=go(t),p=go(e),u=Au,l=Au;c||(u=Mr(t),u=u==Qs?an:u),p||(l=Mr(e),l=l==Qs?an:l);var f=u==an&&!vu(t),g=l==an&&!vu(e),y=u==l;if(y&&!f)return i||(i=new ar),c||$E(t)?hy(t,e,r,o,n,i):LE(t,e,u,r,o,n,i);if(!(n&un)){var w=f&&cr.call(t,"__wrapped__"),S=g&&cr.call(e,"__wrapped__");if(w||S){var h=w?t.value():t,b=S?e.value():e;return i||(i=new ar),r(h,b,o,n,i)}}return y?(i||(i=new ar),UE(t,e,r,o,n,i)):!1}function xE(t,e,r,o){var n=r.length,i=n,c=!o;if(t==null)return!i;for(t=Object(t);n--;){var p=r[n];if(c&&p[2]?p[1]!==t[p[0]]:!(p[0]in t))return!1}for(;++n<i;){p=r[n];var u=p[0],l=t[u],f=p[1];if(c&&p[2]){if(l===void 0&&!(u in t))return!1}else{var g=new ar;if(o)var y=o(l,f,u,t,e,g);if(!(y===void 0?ku(f,l,o,Os|un,g):y))return!1}}return!0}function IE(t){if(!$s(t)||qE(t))return!1;var e=Iy(t)||vu(t)?Kv:xv;return e.test(yo(t))}function FE(t){return zs(t)&&Nu(t.length)&&!!we[ln.call(t)]}function PE(t){return typeof t=="function"?t:t==null?YE:typeof t=="object"?go(t)?kE(t[0],t[1]):RE(t):JE(t)}function CE(t){if(!VE(t))return zv(t);var e=[];for(var r in Object(t))cr.call(t,r)&&r!="constructor"&&e.push(r);return e}function RE(t){var e=ME(t);return e.length==1&&e[0][2]?Ty(e[0][0],e[0][1]):function(r){return r===t||xE(r,t,e)}}function kE(t,e){return Ks(t)&&Ay(e)?Ty(Hs(t),e):function(r){var o=WE(r,t);return o===void 0&&o===e?jE(r,t):ku(e,o,void 0,Os|un)}}function DE(t){return function(e){return Sy(e,t)}}function NE(t){if(typeof t=="string")return t;if(Bu(t))return ry?ry.call(t):"";var e=t+"";return e=="0"&&1/t==-Cu?"-0":e}function BE(t,e,r){var o=-1,n=Cv,i=t.length,c=!0,p=[],u=p;if(r)c=!1,n=Rv;else if(i>=oy){var l=e?null:QE(t);if(l)return Ru(l);c=!1,n=Mv,u=new si}else u=e?[]:p;e:for(;++o<i;){var f=t[o],g=e?e(f):f;if(f=r||f!==0?f:0,c&&g===g){for(var y=u.length;y--;)if(u[y]===g)continue e;e&&u.push(g),p.push(f)}else n(u,g,r)||(u!==p&&u.push(g),p.push(f))}return p}function wy(t){return go(t)?t:GE(t)}var QE=pn&&1/Ru(new pn([,-0]))[1]==Cu?function(t){return new pn(t)}:XE;function hy(t,e,r,o,n,i){var c=n&un,p=t.length,u=e.length;if(p!=u&&!(c&&u>p))return!1;var l=i.get(t);if(l&&i.get(e))return l==e;var f=-1,g=!0,y=n&Os?new si:void 0;for(i.set(t,e),i.set(e,t);++f<p;){var w=t[f],S=e[f];if(o)var h=c?o(S,w,f,e,t,i):o(w,S,f,t,e,i);if(h!==void 0){if(h)continue;g=!1;break}if(y){if(!kv(e,function(b,E){if(!y.has(E)&&(w===b||r(w,b,o,n,i)))return y.add(E)})){g=!1;break}}else if(!(w===S||r(w,S,o,n,i))){g=!1;break}}return i.delete(t),i.delete(e),g}function LE(t,e,r,o,n,i,c){switch(r){case Ms:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case dy:return!(t.byteLength!=e.byteLength||!o(new ty(t),new ty(e)));case iy:case sy:case py:return vy(+t,+e);case ay:return t.name==e.name&&t.message==e.message;case uy:case ly:return t==e+"";case Ls:var p=Ov;case Us:var u=i&un;if(p||(p=Ru),t.size!=e.size&&!u)return!1;var l=c.get(t);if(l)return l==e;i|=Os,c.set(t,e);var f=hy(p(t),p(e),o,n,i,c);return c.delete(t),f;case my:if(bu)return bu.call(t)==bu.call(e)}return!1}function UE(t,e,r,o,n,i){var c=n&un,p=Fu(t),u=p.length,l=Fu(e),f=l.length;if(u!=f&&!c)return!1;for(var g=u;g--;){var y=p[g];if(!(c?y in e:cr.call(e,y)))return!1}var w=i.get(t);if(w&&i.get(e))return w==e;var S=!0;i.set(t,e),i.set(e,t);for(var h=c;++g<u;){y=p[g];var b=t[y],E=e[y];if(o)var T=c?o(E,b,y,e,t,i):o(b,E,y,t,e,i);if(!(T===void 0?b===E||r(b,E,o,n,i):T)){S=!1;break}h||(h=y=="constructor")}if(S&&!h){var F=t.constructor,C=e.constructor;F!=C&&"constructor"in t&&"constructor"in e&&!(typeof F=="function"&&F instanceof F&&typeof C=="function"&&C instanceof C)&&(S=!1)}return i.delete(t),i.delete(e),S}function Gs(t,e){var r=t.__data__;return OE(e)?r[typeof e=="string"?"string":"hash"]:r.map}function ME(t){for(var e=Fu(t),r=e.length;r--;){var o=e[r],n=t[o];e[r]=[o,n,Ay(n)]}return e}function mn(t,e){var r=_v(t,e);return IE(r)?r:void 0}var Mr=TE;(Eu&&Mr(new Eu(new ArrayBuffer(1)))!=Ms||ni&&Mr(new ni)!=Ls||xu&&Mr(xu.resolve())!=Wg||pn&&Mr(new pn)!=Us||Iu&&Mr(new Iu)!=Tu)&&(Mr=function(t){var e=ln.call(t),r=e==an?t.constructor:void 0,o=r?yo(r):void 0;if(o)switch(o){case Wv:return Ms;case jv:return Ls;case Yv:return Wg;case Xv:return Us;case Jv:return Tu}return e});function _E(t,e,r){e=Ks(e,t)?[e]:wy(e);for(var o,n=-1,c=e.length;++n<c;){var i=Hs(e[n]);if(!(o=t!=null&&r(t,i)))break;t=t[i]}if(o)return o;var c=t?t.length:0;return!!c&&Nu(c)&&by(i,c)&&(go(t)||Ey(t))}function by(t,e){return e=e??ny,!!e&&(typeof t=="number"||Iv.test(t))&&t>-1&&t%1==0&&t<e}function Ks(t,e){if(go(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Bu(t)?!0:bv.test(t)||!hv.test(t)||e!=null&&t in Object(e)}function OE(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function qE(t){return!!Zg&&Zg in t}function VE(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||qs;return t===r}function Ay(t){return t===t&&!$s(t)}function Ty(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var GE=Du(function(t){t=zE(t);var e=[];return Av.test(t)&&e.push(""),t.replace(Tv,function(r,o,n,i){e.push(n?i.replace(Ev,"$1"):o||r)}),e});function Hs(t){if(typeof t=="string"||Bu(t))return t;var e=t+"";return e=="0"&&1/t==-Cu?"-0":e}function yo(t){if(t!=null){try{return yy.call(t)}catch{}try{return t+""}catch{}}return""}function KE(t,e){return t&&t.length?BE(t,PE(e,2)):[]}function Du(t,e){if(typeof t!="function"||e&&typeof e!="function")throw new TypeError(cv);var r=function(){var o=arguments,n=e?e.apply(this,o):o[0],i=r.cache;if(i.has(n))return i.get(n);var c=t.apply(this,o);return r.cache=i.set(n,c),c};return r.cache=new(Du.Cache||ur),r}Du.Cache=ur;function vy(t,e){return t===e||t!==t&&e!==e}function Ey(t){return HE(t)&&cr.call(t,"callee")&&(!Hv.call(t,"callee")||ln.call(t)==Qs)}var go=Array.isArray;function xy(t){return t!=null&&Nu(t.length)&&!Iy(t)}function HE(t){return zs(t)&&xy(t)}function Iy(t){var e=$s(t)?ln.call(t):"";return e==cy||e==pv}function Nu(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=ny}function $s(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function zs(t){return!!t&&typeof t=="object"}function Bu(t){return typeof t=="symbol"||zs(t)&&ln.call(t)==my}var $E=Jg?Uv(Jg):FE;function zE(t){return t==null?"":NE(t)}function WE(t,e,r){var o=t==null?void 0:Sy(t,e);return o===void 0?r:o}function jE(t,e){return t!=null&&_E(t,e,vE)}function Fu(t){return xy(t)?AE(t):CE(t)}function YE(t){return t}function XE(){}function JE(t){return Ks(t)?Qv(Hs(t)):DE(t)}cn.exports=KE});var Yy=Ze((E2,jy)=>{"use strict";s();a();jy.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var rS=Ze((eS,tS)=>{"use strict";s();a();var Js=Yy(),{hasOwnProperty:Jy}=Object.prototype,{propertyIsEnumerable:oI}=Object,fn=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),nI=eS,Xy={concatArrays:!1,ignoreUndefined:!1},Zs=t=>{let e=[];for(let r in t)Jy.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let o of r)oI.call(t,o)&&e.push(o)}return e};function gn(t){return Array.isArray(t)?iI(t):Js(t)?sI(t):t}function iI(t){let e=t.slice(0,0);return Zs(t).forEach(r=>{fn(e,r,gn(t[r]))}),e}function sI(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return Zs(t).forEach(r=>{fn(e,r,gn(t[r]))}),e}var Zy=(t,e,r,o)=>(r.forEach(n=>{typeof e[n]>"u"&&o.ignoreUndefined||(n in t&&t[n]!==Object.getPrototypeOf(t)?fn(t,n,Wu(t[n],e[n],o)):fn(t,n,gn(e[n])))}),t),aI=(t,e,r)=>{let o=t.slice(0,0),n=0;return[t,e].forEach(i=>{let c=[];for(let p=0;p<i.length;p++)Jy.call(i,p)&&(c.push(String(p)),i===t?fn(o,n++,i[p]):fn(o,n++,gn(i[p])));o=Zy(o,i,Zs(i).filter(p=>!c.includes(p)),r)}),o};function Wu(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?aI(t,e,r):!Js(e)||!Js(t)?gn(e):Zy(t,e,Zs(e),r)}tS.exports=function(...t){let e=Wu(gn(Xy),this!==nI&&this||{},Xy),r={_:{}};for(let o of t)if(o!==void 0){if(!Js(o))throw new TypeError("`"+o+"` is not an Option Object");r=Wu(r,{_:o},e)}return r._}});var VS=Ze((fi,hn)=>{s();a();var bI=200,AI="Expected a function",il="__lodash_hash_undefined__",la=1,bn=2,hS=1/0,bS=9007199254740991,na="[object Arguments]",Ju="[object Array]",AS="[object Boolean]",TS="[object Date]",vS="[object Error]",ES="[object Function]",TI="[object GeneratorFunction]",ia="[object Map]",xS="[object Number]",wn="[object Object]",uS="[object Promise]",IS="[object RegExp]",sa="[object Set]",FS="[object String]",PS="[object Symbol]",Zu="[object WeakMap]",CS="[object ArrayBuffer]",aa="[object DataView]",vI="[object Float32Array]",EI="[object Float64Array]",xI="[object Int8Array]",II="[object Int16Array]",FI="[object Int32Array]",PI="[object Uint8Array]",CI="[object Uint8ClampedArray]",RI="[object Uint16Array]",kI="[object Uint32Array]",DI=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,NI=/^\w*$/,BI=/^\./,QI=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,LI=/[\\^$.*+?()[\]{}|]/g,UI=/\\(\\)?/g,MI=/^\[object .+?Constructor\]$/,_I=/^(?:0|[1-9]\d*)$/,be={};be[vI]=be[EI]=be[xI]=be[II]=be[FI]=be[PI]=be[CI]=be[RI]=be[kI]=!0;be[na]=be[Ju]=be[CS]=be[AS]=be[aa]=be[TS]=be[vS]=be[ES]=be[ia]=be[xS]=be[wn]=be[IS]=be[sa]=be[FS]=be[Zu]=!1;var RS=typeof self=="object"&&self&&self.Object===Object&&self,OI=typeof self=="object"&&self&&self.Object===Object&&self,Gr=RS||OI||Function("return this")(),kS=typeof fi=="object"&&fi&&!fi.nodeType&&fi,lS=kS&&typeof hn=="object"&&hn&&!hn.nodeType&&hn,qI=lS&&lS.exports===kS,mS=qI&&RS.process,dS=function(){try{return mS&&mS.binding("util")}catch{}}(),fS=dS&&dS.isTypedArray;function VI(t,e,r,o){for(var n=-1,i=t?t.length:0;++n<i;){var c=t[n];e(o,c,r(c),t)}return o}function GI(t,e){for(var r=-1,o=t?t.length:0;++r<o;)if(e(t[r],r,t))return!0;return!1}function KI(t){return function(e){return e?.[t]}}function HI(t,e){for(var r=-1,o=Array(t);++r<t;)o[r]=e(r);return o}function $I(t){return function(e){return t(e)}}function zI(t,e){return t?.[e]}function el(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function WI(t){var e=-1,r=Array(t.size);return t.forEach(function(o,n){r[++e]=[n,o]}),r}function jI(t,e){return function(r){return t(e(r))}}function YI(t){var e=-1,r=Array(t.size);return t.forEach(function(o){r[++e]=o}),r}var XI=Array.prototype,JI=Function.prototype,ma=Object.prototype,Yu=Gr["__core-js_shared__"],gS=function(){var t=/[^.]+$/.exec(Yu&&Yu.keys&&Yu.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),DS=JI.toString,fr=ma.hasOwnProperty,An=ma.toString,ZI=RegExp("^"+DS.call(fr).replace(LI,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),yS=Gr.Symbol,SS=Gr.Uint8Array,eF=ma.propertyIsEnumerable,tF=XI.splice,rF=jI(Object.keys,Object),tl=Tn(Gr,"DataView"),gi=Tn(Gr,"Map"),rl=Tn(Gr,"Promise"),ol=Tn(Gr,"Set"),nl=Tn(Gr,"WeakMap"),yi=Tn(Object,"create"),oF=To(tl),nF=To(gi),iF=To(rl),sF=To(ol),aF=To(nl),ca=yS?yS.prototype:void 0,Xu=ca?ca.valueOf:void 0,wS=ca?ca.toString:void 0;function Ao(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function cF(){this.__data__=yi?yi(null):{}}function pF(t){return this.has(t)&&delete this.__data__[t]}function uF(t){var e=this.__data__;if(yi){var r=e[t];return r===il?void 0:r}return fr.call(e,t)?e[t]:void 0}function lF(t){var e=this.__data__;return yi?e[t]!==void 0:fr.call(e,t)}function mF(t,e){var r=this.__data__;return r[t]=yi&&e===void 0?il:e,this}Ao.prototype.clear=cF;Ao.prototype.delete=pF;Ao.prototype.get=uF;Ao.prototype.has=lF;Ao.prototype.set=mF;function gr(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function dF(){this.__data__=[]}function fF(t){var e=this.__data__,r=da(e,t);if(r<0)return!1;var o=e.length-1;return r==o?e.pop():tF.call(e,r,1),!0}function gF(t){var e=this.__data__,r=da(e,t);return r<0?void 0:e[r][1]}function yF(t){return da(this.__data__,t)>-1}function SF(t,e){var r=this.__data__,o=da(r,t);return o<0?r.push([t,e]):r[o][1]=e,this}gr.prototype.clear=dF;gr.prototype.delete=fF;gr.prototype.get=gF;gr.prototype.has=yF;gr.prototype.set=SF;function yr(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var o=t[e];this.set(o[0],o[1])}}function wF(){this.__data__={hash:new Ao,map:new(gi||gr),string:new Ao}}function hF(t){return fa(this,t).delete(t)}function bF(t){return fa(this,t).get(t)}function AF(t){return fa(this,t).has(t)}function TF(t,e){return fa(this,t).set(t,e),this}yr.prototype.clear=wF;yr.prototype.delete=hF;yr.prototype.get=bF;yr.prototype.has=AF;yr.prototype.set=TF;function pa(t){var e=-1,r=t?t.length:0;for(this.__data__=new yr;++e<r;)this.add(t[e])}function vF(t){return this.__data__.set(t,il),this}function EF(t){return this.__data__.has(t)}pa.prototype.add=pa.prototype.push=vF;pa.prototype.has=EF;function dr(t){this.__data__=new gr(t)}function xF(){this.__data__=new gr}function IF(t){return this.__data__.delete(t)}function FF(t){return this.__data__.get(t)}function PF(t){return this.__data__.has(t)}function CF(t,e){var r=this.__data__;if(r instanceof gr){var o=r.__data__;if(!gi||o.length<bI-1)return o.push([t,e]),this;r=this.__data__=new yr(o)}return r.set(t,e),this}dr.prototype.clear=xF;dr.prototype.delete=IF;dr.prototype.get=FF;dr.prototype.has=PF;dr.prototype.set=CF;function RF(t,e){var r=Vr(t)||OS(t)?HI(t.length,String):[],o=r.length,n=!!o;for(var i in t)(e||fr.call(t,i))&&!(n&&(i=="length"||LS(i,o)))&&r.push(i);return r}function da(t,e){for(var r=t.length;r--;)if(_S(t[r][0],e))return r;return-1}function kF(t,e,r,o){return DF(t,function(n,i,c){e(o,n,r(n),c)}),o}var DF=WF(BF),NF=jF();function BF(t,e){return t&&NF(t,e,ua)}function NS(t,e){e=ga(e,t)?[e]:BS(e);for(var r=0,o=e.length;t!=null&&r<o;)t=t[ya(e[r++])];return r&&r==o?t:void 0}function QF(t){return An.call(t)}function LF(t,e){return t!=null&&e in Object(t)}function sl(t,e,r,o,n){return t===e?!0:t==null||e==null||!Sa(t)&&!wa(e)?t!==t&&e!==e:UF(t,e,sl,r,o,n)}function UF(t,e,r,o,n,i){var c=Vr(t),p=Vr(e),u=Ju,l=Ju;c||(u=qr(t),u=u==na?wn:u),p||(l=qr(e),l=l==na?wn:l);var f=u==wn&&!el(t),g=l==wn&&!el(e),y=u==l;if(y&&!f)return i||(i=new dr),c||sP(t)?QS(t,e,r,o,n,i):YF(t,e,u,r,o,n,i);if(!(n&bn)){var w=f&&fr.call(t,"__wrapped__"),S=g&&fr.call(e,"__wrapped__");if(w||S){var h=w?t.value():t,b=S?e.value():e;return i||(i=new dr),r(h,b,o,n,i)}}return y?(i||(i=new dr),XF(t,e,r,o,n,i)):!1}function MF(t,e,r,o){var n=r.length,i=n,c=!o;if(t==null)return!i;for(t=Object(t);n--;){var p=r[n];if(c&&p[2]?p[1]!==t[p[0]]:!(p[0]in t))return!1}for(;++n<i;){p=r[n];var u=p[0],l=t[u],f=p[1];if(c&&p[2]){if(l===void 0&&!(u in t))return!1}else{var g=new dr;if(o)var y=o(l,f,u,t,e,g);if(!(y===void 0?sl(f,l,o,la|bn,g):y))return!1}}return!0}function _F(t){if(!Sa(t)||tP(t))return!1;var e=qS(t)||el(t)?ZI:MI;return e.test(To(t))}function OF(t){return wa(t)&&pl(t.length)&&!!be[An.call(t)]}function qF(t){return typeof t=="function"?t:t==null?uP:typeof t=="object"?Vr(t)?KF(t[0],t[1]):GF(t):lP(t)}function VF(t){if(!rP(t))return rF(t);var e=[];for(var r in Object(t))fr.call(t,r)&&r!="constructor"&&e.push(r);return e}function GF(t){var e=JF(t);return e.length==1&&e[0][2]?MS(e[0][0],e[0][1]):function(r){return r===t||MF(r,t,e)}}function KF(t,e){return ga(t)&&US(e)?MS(ya(t),e):function(r){var o=cP(r,t);return o===void 0&&o===e?pP(r,t):sl(e,o,void 0,la|bn)}}function HF(t){return function(e){return NS(e,t)}}function $F(t){if(typeof t=="string")return t;if(ul(t))return wS?wS.call(t):"";var e=t+"";return e=="0"&&1/t==-hS?"-0":e}function BS(t){return Vr(t)?t:oP(t)}function zF(t,e){return function(r,o){var n=Vr(r)?VI:kF,i=e?e():{};return n(r,t,qF(o,2),i)}}function WF(t,e){return function(r,o){if(r==null)return r;if(!cl(r))return t(r,o);for(var n=r.length,i=e?n:-1,c=Object(r);(e?i--:++i<n)&&o(c[i],i,c)!==!1;);return r}}function jF(t){return function(e,r,o){for(var n=-1,i=Object(e),c=o(e),p=c.length;p--;){var u=c[t?p:++n];if(r(i[u],u,i)===!1)break}return e}}function QS(t,e,r,o,n,i){var c=n&bn,p=t.length,u=e.length;if(p!=u&&!(c&&u>p))return!1;var l=i.get(t);if(l&&i.get(e))return l==e;var f=-1,g=!0,y=n&la?new pa:void 0;for(i.set(t,e),i.set(e,t);++f<p;){var w=t[f],S=e[f];if(o)var h=c?o(S,w,f,e,t,i):o(w,S,f,t,e,i);if(h!==void 0){if(h)continue;g=!1;break}if(y){if(!GI(e,function(b,E){if(!y.has(E)&&(w===b||r(w,b,o,n,i)))return y.add(E)})){g=!1;break}}else if(!(w===S||r(w,S,o,n,i))){g=!1;break}}return i.delete(t),i.delete(e),g}function YF(t,e,r,o,n,i,c){switch(r){case aa:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case CS:return!(t.byteLength!=e.byteLength||!o(new SS(t),new SS(e)));case AS:case TS:case xS:return _S(+t,+e);case vS:return t.name==e.name&&t.message==e.message;case IS:case FS:return t==e+"";case ia:var p=WI;case sa:var u=i&bn;if(p||(p=YI),t.size!=e.size&&!u)return!1;var l=c.get(t);if(l)return l==e;i|=la,c.set(t,e);var f=QS(p(t),p(e),o,n,i,c);return c.delete(t),f;case PS:if(Xu)return Xu.call(t)==Xu.call(e)}return!1}function XF(t,e,r,o,n,i){var c=n&bn,p=ua(t),u=p.length,l=ua(e),f=l.length;if(u!=f&&!c)return!1;for(var g=u;g--;){var y=p[g];if(!(c?y in e:fr.call(e,y)))return!1}var w=i.get(t);if(w&&i.get(e))return w==e;var S=!0;i.set(t,e),i.set(e,t);for(var h=c;++g<u;){y=p[g];var b=t[y],E=e[y];if(o)var T=c?o(E,b,y,e,t,i):o(b,E,y,t,e,i);if(!(T===void 0?b===E||r(b,E,o,n,i):T)){S=!1;break}h||(h=y=="constructor")}if(S&&!h){var F=t.constructor,C=e.constructor;F!=C&&"constructor"in t&&"constructor"in e&&!(typeof F=="function"&&F instanceof F&&typeof C=="function"&&C instanceof C)&&(S=!1)}return i.delete(t),i.delete(e),S}function fa(t,e){var r=t.__data__;return eP(e)?r[typeof e=="string"?"string":"hash"]:r.map}function JF(t){for(var e=ua(t),r=e.length;r--;){var o=e[r],n=t[o];e[r]=[o,n,US(n)]}return e}function Tn(t,e){var r=zI(t,e);return _F(r)?r:void 0}var qr=QF;(tl&&qr(new tl(new ArrayBuffer(1)))!=aa||gi&&qr(new gi)!=ia||rl&&qr(rl.resolve())!=uS||ol&&qr(new ol)!=sa||nl&&qr(new nl)!=Zu)&&(qr=function(t){var e=An.call(t),r=e==wn?t.constructor:void 0,o=r?To(r):void 0;if(o)switch(o){case oF:return aa;case nF:return ia;case iF:return uS;case sF:return sa;case aF:return Zu}return e});function ZF(t,e,r){e=ga(e,t)?[e]:BS(e);for(var o,n=-1,c=e.length;++n<c;){var i=ya(e[n]);if(!(o=t!=null&&r(t,i)))break;t=t[i]}if(o)return o;var c=t?t.length:0;return!!c&&pl(c)&&LS(i,c)&&(Vr(t)||OS(t))}function LS(t,e){return e=e??bS,!!e&&(typeof t=="number"||_I.test(t))&&t>-1&&t%1==0&&t<e}function ga(t,e){if(Vr(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||ul(t)?!0:NI.test(t)||!DI.test(t)||e!=null&&t in Object(e)}function eP(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function tP(t){return!!gS&&gS in t}function rP(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||ma;return t===r}function US(t){return t===t&&!Sa(t)}function MS(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}var oP=al(function(t){t=aP(t);var e=[];return BI.test(t)&&e.push(""),t.replace(QI,function(r,o,n,i){e.push(n?i.replace(UI,"$1"):o||r)}),e});function ya(t){if(typeof t=="string"||ul(t))return t;var e=t+"";return e=="0"&&1/t==-hS?"-0":e}function To(t){if(t!=null){try{return DS.call(t)}catch{}try{return t+""}catch{}}return""}var nP=zF(function(t,e,r){t[r]=e});function al(t,e){if(typeof t!="function"||e&&typeof e!="function")throw new TypeError(AI);var r=function(){var o=arguments,n=e?e.apply(this,o):o[0],i=r.cache;if(i.has(n))return i.get(n);var c=t.apply(this,o);return r.cache=i.set(n,c),c};return r.cache=new(al.Cache||yr),r}al.Cache=yr;function _S(t,e){return t===e||t!==t&&e!==e}function OS(t){return iP(t)&&fr.call(t,"callee")&&(!eF.call(t,"callee")||An.call(t)==na)}var Vr=Array.isArray;function cl(t){return t!=null&&pl(t.length)&&!qS(t)}function iP(t){return wa(t)&&cl(t)}function qS(t){var e=Sa(t)?An.call(t):"";return e==ES||e==TI}function pl(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=bS}function Sa(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function wa(t){return!!t&&typeof t=="object"}function ul(t){return typeof t=="symbol"||wa(t)&&An.call(t)==PS}var sP=fS?$I(fS):OF;function aP(t){return t==null?"":$F(t)}function cP(t,e,r){var o=t==null?void 0:NS(t,e);return o===void 0?r:o}function pP(t,e){return t!=null&&ZF(t,e,LF)}function ua(t){return cl(t)?RF(t):VF(t)}function uP(t){return t}function lP(t){return ga(t)?KI(ya(t)):HF(t)}hn.exports=nP});var Qi=Ze(rm=>{"use strict";s();a();Object.defineProperty(rm,"__esModule",{value:!0});var vh=U();function nR(t){var e=vh.useRef();return vh.useEffect(function(){e.current=t}),e.current}rm.default=nR});s();a();s();a();s();a();var fT=d.object({balance:d.boolean(),history:d.boolean()}),cB=d.record(d.string(),fT),Ts=class extends Error{constructor(e){super(e),this.name="SetTermsAcknowledgementError"}};var xf=async(t,e)=>{try{return await t.set("termsHaveBeenAcknowledged2",e)}catch{throw new Ts("Error Setting Terms Acknowledgement")}};async function gT(t){return(await t.get("onboardedAt"))?.onboardedAt}async function If(t,e=Date.now()){e&&!await gT(t)?await t.set("onboardedAt",{onboardedAt:e}):e||await t.remove("onboardedAt")}s();a();s();a();var Qf=D(Cf(),1),Lf=D(Bf(),1),Fp=D(uT(),1),rn=(t=>(t.BLOCK="BLOCK",t.NONE="NONE",t))(rn||{});function yT(t,e){for(let r=0;r<t.k;r++){let o=(0,Lf.default)(`${t.salt}_${e}_${r}`,{asBytes:!0}),i=Fp.Buffer.from(o).subarray(0,4).readUInt32BE(0)%t.bits,c=Math.floor(i/24),p=Fp.Buffer.from(t.bitVector.slice(c*4,c*4+4),"base64"),u=i%24,l=Math.floor(u/8),f=u%8;if(!(p[l]&1<<7-f))return!1}return!0}var DB=typeof self<"u"&&self.fetch?self.fetch:Qf.default;function Pp(t,e,r,o){let i=new URL(o).hostname.toLowerCase().split(".");for(let c=0;c<i.length-1;c++){let p=i.slice(c).join(".");if(e.includes(p)||yT(t,p)&&!r.includes(p))return"BLOCK"}return"NONE"}var Es=D(_f());var zf=D(Vf());s();a();var Gf="https://blocklist.phantom.app/multichain.json",kp="https://blowfish-blocklist-proxy.phantom.app",IT="https://github.com/phantom-labs/blocklist",Dp=(t=3)=>({retry:t,retryDelay:e=>Math.min(1e3*2**e,3e4)}),qt={SLIPPAGE_EXCEEDED:"SLIPPAGE_EXCEEDED",INSUFFICIENT_FUNDS:"INSUFFICIENT_FUNDS",INSUFFICIENT_GAS:"INSUFFICIENT_GAS",UNKNOWN_ERROR:"UNKNOWN_ERROR",SIMULATION_FAILED:"SIMULATION_FAILED",TRANSACTION_EXPIRED:"TRANSACTION_EXPIRED",ACCOUNT_FROZEN:"ACCOUNT_FROZEN",SIMULATION_TIMEOUT:"SIMULATION_TIMEOUT",STALE_QUOTE:"STALE_QUOTE"};function FT(t){return{1:"1-critical-alert",2:"2-alert",3:"3-critical-error",4:"4-error",5:"5-information"}[t]}var CT=3,Lp=6e5,RT=6e4,rQ=d.object({type:d.union([d.literal("all"),d.literal("blocklist"),d.literal("whitelist"),d.literal("error"),d.literal("fuzzy"),d.literal("blowfishBloomFilter")]),result:d.boolean(),source:d.optional(d.string()),match:d.string().optional(),isSubdomainDomainWhitelisted:d.boolean().optional()}),oQ=d.object({localHash:d.any(),cursor:d.any()}),Up=d.object({bitVector:d.string(),k:d.number(),hash:d.string(),bits:d.number(),salt:d.string()}),Wf=d.union([d.object({bloomFilter:Up,bloomFilterHash:d.string(),recentlyAdded:d.array(d.string()),recentlyRemoved:d.array(d.string()),nextCursor:d.string()}),d.object({bloomFilter:Up.optional(),bloomFilterHash:d.optional(d.string()),recentlyAdded:d.array(d.string()),recentlyRemoved:d.array(d.string()),nextCursor:d.string()})]),jf=d.object({bloomFilter:Up,lastUpdated:d.number()}).nullish(),Yf=d.object({recentlyAdded:d.array(d.string()),recentlyRemoved:d.array(d.string()),lastUpdated:d.number().optional()}).nullish(),Jn=class{blocklist;whitelist;fuzzylist;tolerance;constructor(e,r,o,n){this.blocklist=Np(e),this.whitelist=Np(r),this.fuzzylist=Np(o),this.tolerance=n||CT}check(e,r){if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=xs(e),n=Mp(o);if(DT(n,this.whitelist)){let u=new URL(e).hostname;if(Bp(Mp(u),this.blocklist)){let f={type:"blocklist",result:!0,source:u,isSubdomainDomainWhitelisted:!0};return r.capture("blockedDomain",{data:f}),f}else return{type:"whitelist",result:!1,source:u,isSubdomainDomainWhitelisted:!0}}if(Bp(n,this.whitelist))return{type:"whitelist",result:!1,source:o,isSubdomainDomainWhitelisted:!1};if(Bp(n,this.blocklist)){let u={type:"blocklist",result:!0,source:o,isSubdomainDomainWhitelisted:!1};return r.capture("blockedDomain",{data:u}),u}if(this.tolerance>0){let u=Kf(n);u=u.replace("www.","");let l=this.fuzzylist.find(f=>{let g=Kf(f);return zf.default.get(u,g)<=this.tolerance});if(l)return{type:"fuzzy",result:!0,match:kT(l),source:o,isSubdomainDomainWhitelisted:!1}}return{type:"all",result:!1,source:o,isSubdomainDomainWhitelisted:!1}}},xs=t=>{let e=new URL(t).hostname.split(".");return e.slice(0).slice(-(e.length===4?3:2)).join(".")},Np=t=>t.map(Mp),Mp=t=>t.split(".").reverse(),kT=t=>t.slice().reverse().join("."),Kf=t=>t.slice(1).reverse().join("."),Bp=(t,e)=>e.some(r=>r.length>t.length?!1:r.every((o,n)=>t[n]===o)),DT=(t,e)=>e.some(r=>r[0]===t[0]&&r[1]===t[1]&&r[2]==="*"),NT=async t=>{let e=(0,Es.getBlocklist)(),r=await t.get("cachedBlocklistDiff"),o=null;try{o=JSON.parse(`${r}`)}catch(n){M.captureError(new Error(`Error parsing blocklist diff: ${n?.message}`),"generic")}if(o&&o.expiresAt&&o.expiresAt>Date.now())return new Jn(e.blocklist.concat(o.blocklist),e.whitelist.concat(o.whitelist),e.fuzzylist.concat(o.fuzzylist));{let n={},i=(0,Es.getVersion)();o&&(n.lastContentHash=`${o.contentHash}`),i&&(n.localBlocklistVersion=`${i}`);let c=await Y.headers(n).get(Gf);if(c.status===200){let p=c.data;return p.expiresAt=Date.now()+Lp,t.set("cachedBlocklistDiff",JSON.stringify(p)),new Jn(e.blocklist.concat(p.blocklist),e.whitelist.concat(p.whitelist),e.fuzzylist.concat(p.fuzzylist))}else{if(c.status===304)return o.expiresAt=Date.now()+Lp,t.set("cachedBlocklistDiff",JSON.stringify(o)),new Jn(e.blocklist.concat(o.blocklist),e.whitelist.concat(o.whitelist),e.fuzzylist.concat(o.fuzzylist));throw new Error("Invalid response from blocklist")}}},_p=async(t,e,r)=>{let o,n;try{let c=await ts(e.getFeatureFlags(),1e3);o=!!c["kill-blowfish-blocklist-cursor"],n=!!c["kill-previous-blocklist"]}catch{o=!1,n=!1}let i;try{if(n)return o?$f(r,t,e):Hf(r,t,e);{i=await NT(t);let c=i.check(r,e);return c.type==="all"?o?$f(r,t,e):Hf(r,t,e):c}}catch{return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}},Hf=async(t,e,r)=>{if(!t)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=xs(t),n=await e.getAll(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents","cachedScanDataCursor"]),i=n.cachedBloomFilter??null,c=n.cachedBloomFilterHash??null,p=n.cachedScanDataCursor??null,u=n.cachedScanDataRecents??null,l=null,f={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0},g=null;if(i){let w=jf.safeParse(i);w.success?l=w.data:await Qp(e)}if(u){let w=Yf.safeParse(u);w.success?f=w.data:await Qp(e)}if(p){let S=d.string().safeParse(p);S.success?g=S.data:await Qp(e)}if(!f||f.lastUpdated==null||Date.now()>f.lastUpdated+RT){let w={localHash:c,cursor:g},S=await Y.post(kp,w);if(S.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let h=S.data,b,E=Wf.safeParse(h);if(E.success)b=E.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let T=[],F=[],C=typeof c=="string"&&b.bloomFilterHash?c!==b.bloomFilterHash:!1;f!=null&&!C&&(T=f.recentlyAdded,F=f.recentlyRemoved),T=T.concat(b.recentlyAdded),F=F.concat(b.recentlyRemoved),T=T.filter(q=>b.recentlyRemoved.indexOf(q)<0),F=F.filter(q=>b.recentlyAdded.indexOf(q)<0);let B={recentlyAdded:T,recentlyRemoved:F,lastUpdated:Date.now()};if(await e.set("cachedScanDataRecents",B),f=B,b.nextCursor!==g&&await e.set("cachedScanDataCursor",b.nextCursor),b.bloomFilter!=null){let q={bloomFilter:b.bloomFilter,lastUpdated:Date.now()};await Promise.all([e.set("cachedBloomFilter",q),e.set("cachedBloomFilterHash",b.bloomFilterHash)]),l=q}}if(!l)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let y=Pp(l.bloomFilter,f.recentlyAdded,f.recentlyRemoved,t);if(y===rn.BLOCK){let w={result:!0,source:o,type:"blowfishBloomFilter"};return r.capture("blockedDomain",{data:w}),w}else if(y===rn.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}};async function Qp(t){await t.remove(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents","cachedScanDataCursor"])}var $f=async(t,e,r)=>{if(!t)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=xs(t),n=await e.getAll(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents"]),i=n.cachedBloomFilter??null,c=n.cachedBloomFilterHash??null,p=n.cachedScanDataRecents??null,u=null,l={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0};if(i){let g=jf.safeParse(i);g.success?u=g.data:await e.remove(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents"])}if(p){let g=Yf.safeParse(p);g.success?l=g.data:await e.remove(["cachedBloomFilter","cachedBloomFilterHash","cachedScanDataRecents"])}if(!l||l.lastUpdated==null||Date.now()>l.lastUpdated+Lp){let g={localHash:c},y=await Y.post(kp,g);if(y.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let w=y.data,S,h=Wf.safeParse(w);if(h.success)S=h.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let b={recentlyAdded:S.recentlyAdded,recentlyRemoved:S.recentlyRemoved,lastUpdated:Date.now()};if(await e.set("cachedScanDataRecents",b),l=b,S.bloomFilter!=null){let E={bloomFilter:S.bloomFilter,lastUpdated:Date.now()};await Promise.all([e.set("cachedBloomFilter",E),e.set("cachedBloomFilterHash",S.bloomFilterHash)]),u=E}}if(!u)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let f=Pp(u.bloomFilter,l.recentlyAdded,l.recentlyRemoved,t);if(f===rn.BLOCK){let g={result:!0,source:o,type:"blowfishBloomFilter"};return r.capture("blockedDomain",{data:g}),g}else if(f===rn.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}};s();a();s();a();var BT=t=>t/1e8;s();a();s();a();var Is={GREEN:"accentSuccess",RED:"accentAlert",WHITE:"textPrimary"};function LT(t){switch(t){case"PLUS":return Is.GREEN;case"MINUS":return Is.RED;case"EQUAL":return Is.WHITE;default:return Is.WHITE}}function UT(t){let e=t?.advancedDetails&&"safeguard"in t.advancedDetails?t?.advancedDetails?.safeguard:void 0;if(e?.recommended&&!e?.shouldBundle&&!e.error&&!e.verifyError&&e?.transactions&&e.transactions.length>0)return e.transactions}function Xf(t,e){if(t.params&&"safeguard"in t.params&&t.params.safeguard&&e?.advancedDetails&&"safeguard"in e.advancedDetails&&e.advancedDetails.safeguard?.transactions){let r=e.advancedDetails.safeguard;if(r.error)return r.error;let o=t.params.transactions,n=r.transactions;if(n){let i;try{pf(o,n)}catch(c){c instanceof en?i=c:c instanceof Error?i=en.createUnknownError(c.message):i=en.createUnknownError("Non error type",c)}if(i)return e.advancedDetails.safeguard.verifyError=i,i}}}function Jf(t){if(t.advancedDetails&&"requestId"in t.advancedDetails)return t.advancedDetails.requestId}s();a();s();a();var Op=async(t,e,r)=>{let o=`/simulation/v1?language=${t}`,n=await Y.api().post(o,{...r,chainId:r.networkID,appVersion:Se,platform:De,deviceId:e});if(!se(n))throw new Error("Failed to scan message");return n.data},Zn=async(t,e,r)=>{let o=`/simulation/v1?language=${t}`,n={...r.params,...r.params&&"safeguard"in r.params?{safeguard:{...r.params.safeguard,lighthouseProgramId:cf}}:{}},i=await Y.api().post(o,{...r,chainId:r.networkID,params:n,metadata:r.metadata,appVersion:Se,platform:De,deviceId:e});if(!se(i))throw new Error("Failed to scan transaction");let c=i.data,p=Xf(r,c);if(p instanceof en){let u=Jf(c);M.captureMessage(`Verify error ${u??""}: ${p.message}`,"safeguard")}return c};var QQ=d.union([d.literal("signTransaction"),d.literal("signAllTransactions"),d.literal("signAndSendTransaction"),d.literal("signAndSendAllTransactions")]);s();a();var MT=0;function ut(t,e){let r=`atom${++MT}`,o={toString(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&this.debugLabel?r+":"+this.debugLabel:r}};return typeof t=="function"?o.read=t:(o.init=t,o.read=_T,o.write=OT),e&&(o.write=e),o}function _T(t){return t(this)}function OT(t,e,r){return e(this,typeof r=="function"?r(t(this)):r)}var Zf=(t,e)=>t.unstable_is?t.unstable_is(e):e===t,Vp=t=>"init"in t,qp=t=>!!t.write,Ps=new WeakMap,Gp=t=>{var e;return Kp(t)&&!((e=Ps.get(t))!=null&&e[1])},qT=(t,e)=>{let r=Ps.get(t);if(r)r[1]=!0,r[0].forEach(o=>o(e));else if((import.meta.env?import.meta.env.MODE:void 0)!=="production")throw new Error("[Bug] cancelable promise not found")},VT=t=>{if(Ps.has(t))return;let e=[new Set,!1];Ps.set(t,e);let r=()=>{e[1]=!0};t.then(r,r),t.onCancel=o=>{e[0].add(o)}},Kp=t=>typeof t?.then=="function",eg=t=>"v"in t||"e"in t,Fs=t=>{if("e"in t)throw t.e;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("v"in t))throw new Error("[Bug] atom state is not initialized");return t.v},tg=(t,e,r)=>{r.p.has(t)||(r.p.add(t),e.then(()=>{r.p.delete(t)},()=>{r.p.delete(t)}))},GT=(t,e,r,o)=>{var n;if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&r===t)throw new Error("[Bug] atom cannot depend on itself");e.d.set(r,o.n),Gp(e.v)&&tg(t,e.v,o),(n=o.m)==null||n.t.add(t)},KT=Symbol.for("JOTAI.EXPERIMENTAL.FLUSHSTOREHOOK"),rg=(...t)=>{let[e,r,o,n,i,c]=t,p=x=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!x)throw new Error("Atom is undefined or null");let P=e(x);return P||(P={d:new Map,p:new Set,n:0},r(x,P),i?.(x,v)),P},u=new WeakMap,l=new Map,f=new Set,g=new Set,y=()=>{var x;let P=[],Q=_=>{try{_()}catch(R){P.push(R)}};do{(x=v[KT])==null||x.call(v);let _=new Set,R=_.add.bind(_);l.forEach(O=>{var $;return($=O.m)==null?void 0:$.l.forEach(R)}),l.clear(),f.forEach(R),f.clear(),g.forEach(R),g.clear(),_.forEach(Q),l.size&&T()}while(l.size||f.size||g.size);if(P.length)throw P[0]},w=(x,P,Q)=>{let _="v"in P,R=P.v,O=Gp(P.v)?P.v:null;if(Kp(Q)){VT(Q);for(let $ of P.d.keys())tg(x,Q,p($));P.v=Q}else P.v=Q;delete P.e,(!_||!Object.is(R,P.v))&&(++P.n,O&&qT(O,Q))},S=x=>{var P;let Q=p(x);if(eg(Q)&&(Q.m&&u.get(x)!==Q.n||Array.from(Q.d).every(([pe,ke])=>S(pe).n===ke)))return Q;Q.d.clear();let _=!0,R=()=>{Q.m&&(B(x,Q),T(),y())},O=pe=>{if(Zf(x,pe)){let Ae=p(pe);if(!eg(Ae))if(Vp(pe))w(pe,Ae,pe.init);else throw new Error("no atom init");return Fs(Ae)}let ke=S(pe);try{return Fs(ke)}finally{GT(x,Q,pe,ke),_||R()}},$,N,ce={get signal(){return $||($=new AbortController),$.signal},get setSelf(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!qp(x)&&console.warn("setSelf function cannot be used with read-only atom"),!N&&qp(x)&&(N=(...pe)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&_&&console.warn("setSelf function cannot be called in sync"),!_)return C(x,...pe)}),N}};try{let pe=o(x,O,ce);return w(x,Q,pe),Kp(pe)&&((P=pe.onCancel)==null||P.call(pe,()=>$?.abort()),pe.then(R,R)),Q}catch(pe){return delete Q.v,Q.e=pe,++Q.n,Q}finally{_=!1}},h=x=>Fs(S(x)),b=x=>{var P;let Q=new Map;for(let _ of((P=x.m)==null?void 0:P.t)||[]){let R=p(_);R.m&&Q.set(_,R)}for(let _ of x.p)Q.set(_,p(_));return Q},E=x=>{let P=[x];for(;P.length;){let Q=P.pop();for(let[_,R]of b(Q))u.has(_)||(u.set(_,R.n),P.push(R))}},T=()=>{var x;let P=[],Q=new WeakSet,_=new WeakSet,R=Array.from(l);for(;R.length;){let[O,$]=R[R.length-1];if(_.has(O)){R.pop();continue}if(Q.has(O)){u.get(O)===$.n?P.push([O,$,$.n]):(u.delete(O),l.set(O,$)),_.add(O),R.pop();continue}Q.add(O);for(let[N,ce]of b($))Q.has(N)||R.push([N,ce])}for(let O=P.length-1;O>=0;--O){let[$,N,ce]=P[O],pe=!1;for(let ke of N.d.keys())if(ke!==$&&l.has(ke)){pe=!0;break}pe&&(S($),B($,N),ce!==N.n&&(l.set($,N),(x=N.u)==null||x.call(N))),u.delete($)}},F=(x,...P)=>{let Q=!0,_=O=>Fs(S(O)),R=(O,...$)=>{var N;let ce=p(O);try{if(Zf(x,O)){if(!Vp(O))throw new Error("atom not writable");let pe=ce.n,ke=$[0];w(O,ce,ke),B(O,ce),pe!==ce.n&&(l.set(O,ce),(N=ce.u)==null||N.call(ce),E(ce));return}else return F(O,...$)}finally{Q||(T(),y())}};try{return n(x,_,R,...P)}finally{Q=!1}},C=(x,...P)=>{try{return F(x,...P)}finally{T(),y()}},B=(x,P)=>{var Q;if(P.m&&!Gp(P.v)){for(let[_,R]of P.d)if(!P.m.d.has(_)){let O=p(_);q(_,O).t.add(x),P.m.d.add(_),R!==O.n&&(l.set(_,O),(Q=O.u)==null||Q.call(O),E(O))}for(let _ of P.m.d||[])if(!P.d.has(_)){P.m.d.delete(_);let R=L(_,p(_));R?.t.delete(x)}}},q=(x,P)=>{var Q;if(!P.m){S(x);for(let _ of P.d.keys())q(_,p(_)).t.add(x);if(P.m={l:new Set,d:new Set(P.d.keys()),t:new Set},(Q=P.h)==null||Q.call(P),qp(x)){let _=P.m,R=()=>{let O=!0,$=(...N)=>{try{return F(x,...N)}finally{O||(T(),y())}};try{let N=c(x,$);N&&(_.u=()=>{O=!0;try{N()}finally{O=!1}})}finally{O=!1}};g.add(R)}}return P.m},L=(x,P)=>{var Q;if(P.m&&!P.m.l.size&&!Array.from(P.m.t).some(_=>{var R;return(R=p(_).m)==null?void 0:R.d.has(x)})){let _=P.m.u;_&&f.add(_),delete P.m,(Q=P.h)==null||Q.call(P);for(let R of P.d.keys()){let O=L(R,p(R));O?.t.delete(x)}return}return P.m},v={get:h,set:C,sub:(x,P)=>{let Q=p(x),R=q(x,Q).l;return R.add(P),y(),()=>{R.delete(P),L(x,Q),y()}},unstable_derive:x=>rg(...x(...t))};return v},HT=t=>{let e=new Set,r,o=0,n=t.unstable_derive((...p)=>{let[u,l,,f]=p;return r=u,p[1]=function(y,w){l(y,w);let S=w.h;w.h=()=>{S?.(),w.m?e.add(y):e.delete(y)}},p[3]=function(y,w,S,...h){return o?S(y,...h):f(y,w,S,...h)},p}),i=n.set;return Object.assign(n,{dev4_get_internal_weak_map:()=>({get:p=>{let u=r(p);if(!(!u||u.n===0))return u}}),dev4_get_mounted_atoms:()=>e,dev4_restore_atoms:p=>{i({read:()=>null,write:(l,f)=>{++o;try{for(let[g,y]of p)Vp(g)&&f(g,y)}finally{--o}}})}})},Hp=()=>{let t=new WeakMap,e=rg(r=>t.get(r),(r,o)=>t.set(r,o).get(r),(r,...o)=>r.read(...o),(r,...o)=>r.write(...o),(r,...o)=>{var n;return(n=r.unstable_onInit)==null?void 0:n.call(r,...o)},(r,...o)=>{var n;return(n=r.onMount)==null?void 0:n.call(r,...o)});return(import.meta.env?import.meta.env.MODE:void 0)!=="production"?HT(e):e},ei,og=()=>(ei||(ei=Hp(),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=ei),globalThis.__JOTAI_DEFAULT_STORE__!==ei&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),ei);s();a();var qe=D(U(),1);var ig=(0,qe.createContext)(void 0),Cs=t=>{let e=(0,qe.useContext)(ig);return t?.store||e||og()},sg=({children:t,store:e})=>{let r=(0,qe.useRef)(void 0);return!e&&!r.current&&(r.current=Hp()),(0,qe.createElement)(ig.Provider,{value:e||r.current},t)},zp=t=>typeof t?.then=="function",ag=t=>{t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e})},$T=qe.default.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(ag(t),t)}),$p=new WeakMap,ng=t=>{let e=$p.get(t);return e||(e=new Promise((r,o)=>{let n=t,i=u=>l=>{n===u&&r(l)},c=u=>l=>{n===u&&o(l)},p=u=>{"onCancel"in u&&typeof u.onCancel=="function"&&u.onCancel(l=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&l===u)throw new Error("[Bug] p is not updated even after cancelation");zp(l)?($p.set(l,e),n=l,l.then(i(l),c(l)),p(l)):r(l)})};t.then(i(t),c(t)),p(t)}),$p.set(t,e)),e};function zT(t,e){let r=Cs(e),[[o,n,i],c]=(0,qe.useReducer)(l=>{let f=r.get(t);return Object.is(l[0],f)&&l[1]===r&&l[2]===t?l:[f,r,t]},void 0,()=>[r.get(t),r,t]),p=o;(n!==r||i!==t)&&(c(),p=r.get(t));let u=e?.delay;if((0,qe.useEffect)(()=>{let l=r.sub(t,()=>{if(typeof u=="number"){let f=r.get(t);zp(f)&&ag(ng(f)),setTimeout(c,u);return}c()});return c(),l},[r,t,u]),(0,qe.useDebugValue)(p),zp(p)){let l=ng(p);return $T(l)}return p}function cg(t,e){let r=Cs(e);return(0,qe.useCallback)((...n)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return r.set(t,...n)},[r,t])}function WT(t,e){return[zT(t,e),cg(t,e)]}s();a();var pg=d.enum(["Native","Fungible","SemiFungible","NonFungible","Unknown"]),sr=d.object({id:d.string(),displayName:d.string().optional(),logoURI:d.union([d.string(),d.null()]).optional(),tokenType:pg,decimals:d.number().optional(),symbol:d.string().optional(),isSpam:d.boolean().optional()}),ug=d.object({id:er,displayName:d.string(),logoURI:d.union([d.string(),d.null()]).optional()}),Rs=d.object({token:sr,amount:d.string(),to:er,from:er}),Wp=d.literal("UNCLASSIFIED_APP_INTERACTION"),jp=d.literal("TOKEN_SEND"),Yp=d.literal("TOKEN_BURN"),Xp=d.literal("TOKEN_SWAP"),Jp=d.literal("TOKEN_UNWRAP"),Zp=d.literal("WITHDRAW_STAKE"),eu=d.literal("DEACTIVATE_STAKE"),tu=d.literal("STAKE"),ru=d.literal("COLLECTIBLE_LIST"),ou=d.literal("COLLECTIBLE_BUY_ITEM"),nu=d.literal("COLLECTIBLE_CANCEL_BID"),iu=d.literal("COLLECTIBLE_BID_ITEM"),su=d.literal("COLLECTIBLE_UNLIST"),au=d.literal("COLLECTIBLE_SELL_ITEM"),cu=d.literal("CANCEL_TX"),pu=d.literal("TOKEN_APPROVAL"),uu=d.literal("CANCEL_ORDER"),lu=d.literal("COLLECTION_APPROVAL"),mu=d.literal("BRIDGE_INIT"),jT=d.union([Wp,jp,Yp,Xp,Jp,Zp,eu,tu,ru,ou,nu,iu,su,au,cu,pu,uu,lu,mu]),lg=d.object({transactionType:Wp,balanceChanges:d.array(Rs),dapp:d.union([Mt,d.null()]).optional()}),mg=d.object({transactionType:jp,balanceChanges:d.array(Rs).nonempty(),dapp:d.union([Mt,d.null()]).optional()}),dg=d.object({transactionType:Yp,dapp:d.union([Mt,d.null()]).optional(),token:sr,amount:d.string()}),fg=d.object({transactionType:Xp,dapp:d.union([Mt,d.null()]).optional(),receiveToken:sr,sendToken:sr,receiveAmount:d.string(),sendAmount:d.string()}),gg=d.object({transactionType:Jp,token:sr,amount:d.string()}),yg=d.object({transactionType:Zp,stakeAccount:er,amount:d.string()}),Sg=d.object({transactionType:eu,stakeAccount:er,amount:d.string()}),wg=d.object({transactionType:tu,stakeAccount:er,amount:d.string(),validatorName:d.string().optional(),validatorWebsite:d.string().optional(),keybaseUsername:d.string().optional()}),hg=d.object({transactionType:cu}),nn=d.object({dapp:d.union([Mt,d.null()]),itemAmount:d.string().optional(),item:sr,forAmount:d.string(),forAsset:sr,listingUrl:d.string().optional()}),bg=nn.merge(d.object({transactionType:ru})),Ag=nn.merge(d.object({transactionType:ou})),Tg=nn.merge(d.object({transactionType:nu})),vg=nn.merge(d.object({transactionType:iu})),Eg=nn.merge(d.object({transactionType:su})),xg=nn.merge(d.object({transactionType:au})),Ig=d.object({transactionType:pu,dapp:d.union([Mt,d.null()]).optional(),token:sr,value:d.string().optional(),isApproved:d.boolean()}),Fg=d.object({transactionType:uu,dapp:d.union([Mt,d.null()]).optional(),orderId:d.string()}),Pg=d.object({transactionType:lu,collection:ug,dapp:d.union([Mt,d.null()]).optional(),isApproved:d.boolean()}),Cg=d.object({transactionType:mu,dapp:d.union([Mt,d.null()]).optional(),balanceChanges:d.array(Rs).nonempty(),explorerUrl:d.string().optional()}),Rg=d.enum(["success","failed"]),kg=d.object({networkFee:d.string().optional(),networkFeePayer:d.string().optional(),status:Rg,errorMessage:d.union([d.string(),d.null()]),blockNumber:d.string(),chainId:Nr,transactionId:d.string()}),ks=d.object({timestamp:d.number(),owner:er,id:er,interactionData:d.union([lg,mg,dg,fg,gg,yg,Sg,wg,bg,Ag,Tg,vg,Eg,xg,hg,Ig,Fg,Pg,Cg]),chainMeta:kg}),ze=t=>t.split("/")[1]?.split(":").slice(1).join(":");s();a();var lo=t=>{switch(t){case"SemiFungible":case"NonFungible":return!0;default:return!1}},du=(t,e)=>{let r=ze(t.to),o=ze(t.from),n=e.some(c=>c.address.toLowerCase()===r.toLowerCase()),i=e.some(c=>c.address.toLowerCase()===o.toLowerCase());return n&&!i};s();a();var fu=D(U());s();a();var Dg=({interactionData:t,isError:e,selectedAccountAddresses:r,getKnownAddressLabel:o,start:n,networkID:i})=>{let p=t.balanceChanges[0],{token:{symbol:u,displayName:l,tokenType:f,decimals:g},amount:y}=p,w=du(p,r),S=lo(f),b=YT({isCollectible:S,sign:w?"+":"-",amount:y,decimals:g,tokenSymbol:u,tokenType:f,isError:e});if(w){let F=ze(p.from),C=Sp(F,void 0,o(F,i));return{topLeft:{text:`${k.t("transactionsReceived")} ${S?l||k.t("richTransactionDetailUnknownNFT"):""}`},topRight:{text:`${b}`,color:"accentSuccess"},bottomLeft:{text:k.t("transactionsFromParagraphInterpolated",{from:C,defaultValue:`From ${C}`})},start:n}}let E=ze(p.to),T=Sp(E,void 0,o(E,i));return{topLeft:{text:e?k.t("transactionsSendFailed"):`${k.t("transactionsSent")} ${S?l||k.t("richTransactionDetailUnknownNFT"):""}`},topRight:{text:`${b}`,color:"textPrimary"},bottomLeft:{text:k.t("transactionsToParagraphInterpolated",{to:T,defaultValue:`To ${T}`})},start:n}};function YT({isCollectible:t,sign:e,amount:r,decimals:o,tokenSymbol:n,tokenType:i,isError:c}){return c||o===void 0||i==="NonFungible"?"":t?`${e}${et(r,o)}`:`${e}${et(r,o)}${n?` ${Lt(n,6)}`:""}`}var XT=["So11111111111111111111111111111111111111112","501"],JT=(t,e,r,o,n)=>{let{interactionData:i,chainMeta:c}=t,{transactionType:p}=i,u=c.status==="failed",l=c.chainId,f=I.getTokenSymbol(l),g=I.getTokenDecimals(l),y=e("historyUnknownDappName"),w=fu.default.createElement(r,{activityItem:t,size:"small",isDetailViewOrSvg:!1});switch(p){case"TOKEN_SEND":return Dg({interactionData:i,isError:u,selectedAccountAddresses:n,getKnownAddressLabel:o,start:w,networkID:l});case"TOKEN_BURN":{let{amount:S,token:h}=i,b="";return h.displayName?S==="1"?b=h.displayName:b=`${h.displayName} (${S})`:b=e("richTransactionDetailUnknownNFT"),{topLeft:{text:u?`${e("transactionsFailedBurn")}`:`${e("transactionsBurned")}`},bottomLeft:{text:b},start:w}}case"TOKEN_UNWRAP":{let{amount:S,token:h}=i;return{topLeft:{text:u?`${e("transactionsUnwrappedFailed")}`:`${e("transactionsUnwrapped")}`},topRight:{text:u?"":`${et(S,h.decimals??0)} ${h.symbol}`,color:"textPrimary"},start:w}}case"TOKEN_SWAP":{let{receiveAmount:S,receiveToken:h,sendAmount:b,sendToken:E,dapp:T}=i,F=T?T.displayName:e("historyUnknownDappName"),C=jn(ze(E.id)||""),B=jn(ze(h.id)||""),q="";!u&&h.decimals!==void 0&&(q=`+${et(S,h.decimals)} ${Lt(h.symbol||B,6)}`);let L="";return!u&&E.decimals!==void 0&&(L=`-${et(b,E.decimals)} ${Lt(E.symbol||C,6)}`),{topLeft:{text:e(u?"transactionsFailedSwap":"transactionsSwapped")},topRight:{text:q,color:"accentSuccess"},bottomLeft:{text:F},bottomRight:{text:L,color:"textPrimary"},start:w}}case"BRIDGE_INIT":{let S=i.dapp?i.dapp.displayName:y,b=i.balanceChanges[0],{token:{symbol:E,decimals:T},amount:F}=b,C=E?` ${Lt(E,6)}`:"";if(!u&&T!==void 0){let B=`-${et(F,T)}${C}`;return{topLeft:{text:u?e("transactionBridgeInitiatedFailed"):`${e("transactionBridgeInitiated")}`},bottomLeft:{text:S},topRight:{text:`${B}`,color:"textPrimary"},start:w}}return{topLeft:{text:u?e("transactionBridgeInitiatedFailed"):`${e("transactionBridgeInitiated")}`},bottomLeft:{text:S},start:w}}case"WITHDRAW_STAKE":{let{amount:S,stakeAccount:h}=i,b=ze(h),E=I.getTokenSymbol(l);return{topLeft:{text:e(u?"transactionsWithdrawStakeFailed":"transactionsWithdrawStake")},topRight:{text:u?"":`${et(S,g)} ${Lt(E,6)}`,color:"textPrimary"},bottomLeft:{text:ss(b,4)},start:w}}case"DEACTIVATE_STAKE":{let{stakeAccount:S}=i,h=ze(S);return{topLeft:{text:e(u?"transactionsDeactivateStakeFailed":"transactionsDeactivateStake")},bottomLeft:{text:ss(h,4)},start:w}}case"STAKE":{let{amount:S,stakeAccount:h,validatorName:b}=i,E=ze(h);return{topLeft:{text:e(u?"transactionsStakedFailed":"transactionsStaked")},topRight:{text:u?"":`${et(S,g)} ${Lt(f,6)}`,color:"textPrimary"},bottomLeft:{text:b||ss(E,4)},start:w}}case"COLLECTIBLE_LIST":{let{dapp:S,item:h}=i,b=S?S.displayName:e("historyUnknownDappName"),E=h.displayName||e("richTransactionDetailUnknownNFT");return{topLeft:{text:u?e("transactionsListedFailed"):e("transactionsListedInterpolated",{name:E})},bottomLeft:{text:b},start:w}}case"COLLECTIBLE_BUY_ITEM":{let{dapp:S,itemAmount:h,item:b,forAsset:E,forAmount:T}=i,F=S?S.displayName:e("historyUnknownDappName"),C=Ng(T,E.decimals,Lt(E.symbol||"",6)),B=b.symbol||jn(ze(b.id)),q=h&&b.tokenType==="SemiFungible"?`+${h} ${B}`:`+${B}`;return{topLeft:{text:e(u?"transactionsBuyFailed":"transactionsBoughtCollectible")},topRight:{text:u?"":q,color:"accentSuccess"},bottomRight:{text:u?"":`${C}`,color:"textPrimary"},bottomLeft:{text:F},start:w}}case"COLLECTIBLE_CANCEL_BID":{let{dapp:S,item:h}=i,b=S?S.displayName:e("historyUnknownDappName"),E=h.displayName||e("richTransactionDetailUnknownNFT");return{topLeft:{text:u?e("transactionsCancelBidOnFailed"):e("transactionsCancelBidOnInterpolated",{name:E})},bottomLeft:{text:b},start:w}}case"COLLECTIBLE_BID_ITEM":{let{dapp:S,item:h}=i,b=S?S.displayName:e("historyUnknownDappName"),E=h.displayName||e("richTransactionDetailUnknownNFT");return{topLeft:{text:u?e("transactionsBidFailed"):e("transactionsBidOnInterpolated",{name:E})},bottomLeft:{text:b},start:w}}case"COLLECTIBLE_UNLIST":{let{dapp:S,item:h}=i,b=S?S.displayName:e("historyUnknownDappName"),E=h.displayName||e("richTransactionDetailUnknownNFT");return{topLeft:{text:u?e("transactionsUnlistedFailed"):e("transactionsUnlistedInterpolated",{name:E})},bottomLeft:{text:b},start:w}}case"COLLECTIBLE_SELL_ITEM":{let{dapp:S,itemAmount:h,item:b,forAsset:E,forAmount:T}=i,F=S?S.displayName:e("historyUnknownDappName"),C=E.decimals!==void 0?`+${et(T,E.decimals)} ${Lt(E.symbol||"",6)}`:e("transactionsUnknownAmount"),B=b.symbol||jn(ze(b.id)),q=h&&b.tokenType==="SemiFungible"?`-${h} ${B}`:`-${B}`;return{topLeft:{text:e(u?"transactionsSoldFailed":"transactionsSoldCollectible")},topRight:{text:u?"":`${C}`,color:"accentSuccess"},bottomRight:{text:u?"":q,color:"textPrimary"},bottomLeft:{text:F},start:w}}case"CANCEL_TX":return{topLeft:{text:e(u?"transactionCancelledFailed":"transactionCancelled")},start:w};case"TOKEN_APPROVAL":{let{dapp:S,token:h,isApproved:b}=i,E=lo(h.tokenType)?h.displayName:h.symbol,T;return u?b?lo(h.tokenType)?T=e("transactionApproveTokenFailed",{tokenSymbol:E}):T=e("transactionApprovalFailed"):lo(h.tokenType)?T=e("transactionRevokeApproveTokenFailed",{tokenSymbol:E}):T=e("transactionRevokeFailed"):b?T=e("transactionApproveToken",{tokenSymbol:E}):T=e("transactionRevokeApproveToken",{tokenSymbol:E}),{topLeft:{text:T},bottomLeft:{text:S?S.displayName:y,color:"textTertiary"},start:w}}case"COLLECTION_APPROVAL":{let{collection:S,isApproved:h,dapp:b}=i,E=S.displayName,T;return u?h?T=e("transactionApproveTokenFailed",{tokenSymbol:E}):T=e("transactionRevokeApproveTokenFailed",{tokenSymbol:E}):h?T=e("transactionApproveToken",{tokenSymbol:E}):T=e("transactionRevokeApproveToken",{tokenSymbol:E}),{topLeft:{text:T},bottomLeft:{text:b?b.displayName:y,color:"textTertiary"},start:w}}case"CANCEL_ORDER":{let{dapp:S}=i;return{topLeft:{text:e(u?"transactionCancelOrderFailed":"transactionCancelOrder")},bottomLeft:{text:S?.displayName||e("historyUnknownDappName"),color:"textTertiary"},start:w}}case"UNCLASSIFIED_APP_INTERACTION":{let{dapp:S}=i,h=S?S.displayName:y;return{topLeft:{text:e(u?"transactionsFailedAppInteraction":"transactionsAppInteraction")},bottomLeft:{text:h},start:w}}}},ZT=(t,e)=>{let{display:r,type:o}=t,{topLeft:n,topRight:i,bottomLeft:c,bottomRight:p}=r.summary,u=fu.default.createElement(e,{logoUri:r.summary.logoUri,pendingTransactionType:o,size:"small"});return{topLeft:n,topRight:i,bottomLeft:c,bottomRight:p,start:u}},gu=(t,e,r)=>{let o=(t??[]).map(tf);if(e){let n=o.find(i=>i.chainId===e)?.address;if(n){let i={chainId:e,address:n};r&&(i.filters=[{type:"token",value:r}]),o=[i]}}return o},yu=t=>{if(!t)return;let e=z(t);if(e.resourceType!=="nativeToken")return t.type==="SPL"?t.data.splTokenAccountPubkey:e.address},ev=(t,e)=>{let r=ze(t.id);return XT.includes(r)&&(t.tokenType="Native"),t.tokenType==="Native"?{chainId:e,slip44:I.getSlip44(e),resourceType:"nativeToken"}:{chainId:e,address:r,resourceType:"address"}},Ng=(t,e,r)=>{if(!t||!e)return k.t("transactionsUnknownAmount");let o=ne(t,e),n=o.abs(),i=o.isZero()?"":o.isPositive()?"-":"+",c=yt(n);return`${i}${c} ${r}`};s();a();s();a();s();a();var Ur={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!0};var Bg={...Ur};s();a();var Qg={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};s();a();var Lg={...Ur,showTimeToMineRowInPendingTransactionDetail:!0};s();a();var Ug={...Ur};s();a();var Mg={...Ur};s();a();var _g={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};s();a();var Og={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};var tv=new Yo({solana:_g,ethereum:Lg,polygon:Mg,monad:Ug,base:Bg,bitcoin:Qg,sui:Og}),qg=jo(tv);s();a();s();a();s();a();var zg=D(U());s();a();var Hg=D(U());s();a();var rv=10,ov="/history/v2",sn=class extends Error{message="406: Cache bust!"},ti=class extends Error{message="Server response malformed."},Ds=class extends Error{},Ns=class extends Error{},Su=d.object({next:d.union([d.null(),d.string()]),results:d.array(ks)}),Vg=async t=>{let e=await Y.api().retry(3,2e3).post(`${ov}`,t);if(e.status===406)throw new sn;if(e.status>=400&&e.status<500)throw new Ns(`FetchActivityItem: Status code: ${e.status}`);if(e.status>=500)throw new Ds(`FetchActivityItem: Status code: ${e.status}`);return e.data},Gg=t=>!Array.isArray(t.results)||typeof t.next!="string"&&t.next!==null,Bs=async t=>{let e=await Vg(t);if(Gg(e))throw new ti;for(;e.results?.length<rv&&e.next;){if(Gg(e))throw new ti;let r=await Vg({next:e.next,isSpam:t.isSpam});e.next=r.next,e.results=[...e.results,...r.results]}try{return Su.parse(e)}catch(r){let o=r,n=[],i=o.issues;for(let u=0;u<i.length;++u){let l=i[u].path;if(l[0]!=="results")throw M.captureError(o,"history"),o;let f=l[1];if(typeof f!="number")throw M.captureError(o,"history"),o;n.push(f)}n.sort(function(u,l){return l-u});let c=n.map(u=>e.results[u]).map(u=>u.interactionData?.transactionType||""),p=[];for(let u=0;u<n.length;++u){let l=n[u],f=e.results[l],g={timestamp:f?.timestamp,owner:f?.owner,id:f?.id,chainMeta:f?.chainMeta,interactionData:{transactionType:"UNCLASSIFIED_APP_INTERACTION",balanceChanges:[]}};try{ks.parse(g),e.results[l]=g,p.push(l)}catch{}}for(let u=0;u<n.length;++u){let l=n[u];p.indexOf(l)===-1&&e.results.splice(l,1)}n.length&&console.error(`Removed history items, ${c.join(",")}`);try{return Su.parse(e)}catch(u){let l=u;throw M.captureError(l,"history"),l}}};var nv=3e5,ri="fetch-infinite-activity-items",$g=({accounts:t,isSpam:e})=>[ri,t,e],iv=(t,e)=>{t.removeQueries({queryKey:e})},wu=({accounts:t,isSpam:e})=>{let r=j();(0,Hg.useEffect)(()=>()=>{r.cancelQueries({queryKey:[ri],exact:!1})},[r]);let o=$g({accounts:t,isSpam:e});return Qt({queryKey:o,queryFn:async({pageParam:c})=>{try{let p;c&&c!==""?p=await Bs({next:c,isSpam:e}):p=await Bs({accounts:t||[],isSpam:e});let u=p.results.map(l=>(l.interactionData.transactionType==="TOKEN_SEND"&&l.interactionData.balanceChanges.sort(sv(t)),l));return{...p,results:u}}catch(p){p instanceof sn&&iv(r,o),M.captureError(p,"history")}},getNextPageParam:c=>c?.next,staleTime:nv,retry:!1,enabled:!!t?.length&&t.every(c=>!I.isLocalNetworkID(c.chainId)),initialPageParam:""})};function sv(t){return(e,r)=>{let o=Kg(e,t),n=Kg(r,t);return o?-1:n?1:0}}function Kg(t,e){let r=t.to.split("/address:")[1],o=t.from.split("/address:")[1];return e.some(n=>n.address.toLowerCase()===r.toLowerCase()||n.address.toLowerCase()===o.toLowerCase())}var av=({fungible:t,isSpam:e=!1})=>{let{data:r=Nd,status:o}=Vd(),n=r.isDeveloperMode,i=yu(t),{data:c}=co({address:t?.data.walletAddress,networkID:t?.data.chain.id}),p=(0,zg.useMemo)(()=>gu(c?[c]:[],t?.data.chain.id,i),[c,t?.data.chain.id,i]),u=wu({accounts:p,isSpam:e}),l=u.isPending||o==="pending";return{activityItemsData:u,isLoadingHistory:l,isDeveloperMode:n}};s();a();var Ws=D(U());s();a();var By=D(dT()),Qy=D(Fy());var ZE=d.object({domain:d.string(),url:d.string(),name:d.string(),category:d.string(),imageUrl:d.string()}),Ly=d.object({uuid:d.string(),data:d.array(ZE)}),ex=d.object({chainId:Nr,address:d.string(),name:d.string(),symbol:d.string(),logoUrl:d.string(),marketCap:d.number(),price:d.number(),priceChange:d.number(),volume:d.number(),volumeChange:d.number()}),Uy=d.object({items:d.array(ex)}),tx=d.object({paymentTokenId:d.string(),name:d.string(),symbol:d.string(),decimals:d.number()}),rx=d.object({verified:d.boolean(),collectionUrl:d.string(),marketplaceId:d.string(),marketplaceName:d.string(),marketplaceCollectionId:d.string()}),ox=d.object({marketplaceId:d.string(),paymentToken:tx,value:d.string()}),nx=d.object({id:d.string(),name:d.string(),volume:d.string().optional(),volumePercentChange:d.number(),marketplacePages:d.array(rx),floorPrices:d.array(ox),imageUrl:d.string()}),My=d.object({uuid:d.string(),data:d.array(nx)}),ix=["tokens","sites","collections","learn","suggested-users-to-follow"],So=d.enum(["shortcuts","carousel",...ix]),sx=d.object({type:d.literal(So.enum.shortcuts)}),ax=d.object({type:d.literal(So.enum.carousel)}),cx=d.object({type:d.literal(So.enum["suggested-users-to-follow"]),limit:d.number()}),ai="all_networks",dn=d.union([Nr,d.literal(ai)]),px=["asc","desc"],ux=d.enum(px),lx=["rank","volume","price","price-change","market-cap"],Py=d.enum(lx),mx=["1h","24h","7d","30d"],Cy=d.enum(mx),dx=d.object({type:d.literal(So.enum.tokens),sortBy:d.array(Py).refine(t=>new Set(t).size===t.length),sortByDefault:Py,sortDirectionDefault:ux,network:d.array(dn).refine(t=>new Set(t).size===t.length),networkDefault:dn,timeFrame:d.array(Cy).refine(t=>new Set(t).size===t.length),timeFrameDefault:Cy,rankAlgo:d.string(),limit:d.number(),listLimit:d.number()}),fx=["top","rank"],Ry=d.enum(fx),gx=["24h","7d","30d"],ky=d.enum(gx),yx=d.object({type:d.literal(So.enum.sites),sortBy:d.array(Ry).refine(t=>new Set(t).size===t.length),sortByDefault:Ry,network:d.array(dn).refine(t=>new Set(t).size===t.length),networkDefault:dn,timeFrame:d.array(ky).refine(t=>new Set(t).size===t.length),timeFrameDefault:ky,rankAlgo:d.string(),limit:d.number(),listLimit:d.number()}),Sx=["top","rank"],Dy=d.enum(Sx),wx=["24h","7d","30d"],Ny=d.enum(wx),hx=d.object({type:d.literal(So.enum.collections),sortBy:d.array(Dy).refine(t=>new Set(t).size===t.length),sortByDefault:Dy,network:d.array(dn).refine(t=>new Set(t).size===t.length),networkDefault:dn,timeFrame:d.array(Ny).refine(t=>new Set(t).size===t.length),timeFrameDefault:Ny,rankAlgo:d.string(),limit:d.number(),listLimit:d.number()}),bx=d.object({type:d.literal(So.enum.learn),limit:d.number()}),Ax=d.discriminatedUnion("type",[sx,ax,cx,dx,yx,hx,bx]),Qu=d.object({sections:d.array(Ax).refine(t=>(0,By.default)(t,(0,Qy.default)(t,"type")))}),o0=d.object({uuid:d.string(),data:d.array(dd)});var Tx=Qu.parse({sections:[{type:"shortcuts"},{type:"carousel"},{type:"tokens",sortBy:["rank","volume","price","price-change","market-cap"],sortByDefault:"rank",sortDirectionDefault:"asc",network:["solana:101","eip155:1","eip155:137","eip155:8453","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["1h","24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:100},{type:"suggested-users-to-follow",limit:3,listLimit:100},{type:"sites",sortBy:["rank","top"],sortByDefault:"rank",network:["solana:101","eip155:1","eip155:137","eip155:8453","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:50},{type:"collections",sortBy:["rank","top"],sortByDefault:"rank",network:["solana:101","eip155:1","eip155:137","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:50},{type:"learn",limit:3}]}),Lu=()=>{let t=Ne.getMultivariateAssignment("explore-config"),e=$e;return(0,Ws.useMemo)(()=>{let r;try{r=Qu.parse(JSON.parse(t??""))}catch{r=Tx}return e||(r={...r,sections:r.sections.filter(o=>o.type!=="suggested-users-to-follow")}),r},[t,e])},Uu=()=>{let t=Lu();return(0,Ws.useMemo)(()=>{let e=[];for(let r of t.sections)(r.type==="collections"||r.type==="tokens"||r.type==="sites"||r.type==="learn"||r.type==="suggested-users-to-follow")&&e.push(r);return e},[t.sections])},Mu=t=>{let e=Lu();return(0,Ws.useMemo)(()=>e.sections.find(o=>o.type===t)??null,[e.sections,t])};s();a();s();a();s();a();s();a();s();a();var vx=d.object({type:d.literal("fungible"),data:df}),_y=d.object({results:d.array(d.any()).transform(t=>t.reduce((e,r)=>{let o=vx.safeParse(r);return o.success&&e.push(o.data),e},[])),prevCursor:d.string().nullish().default(null),nextCursor:d.string().nullish().default(null),hasMore:d.boolean()});async function Oy(t){let{query:e,networkIds:r,searchContext:o,supportedNetworkIds:n,pageSize:i=50}=t,c=await Y.api().headers({"Content-Type":"application/json"}).get("/search/v1",{params:{query:e.trim(),chainIds:r.join(","),platform:De,pageSize:i.toString(),searchTypes:"fungible",searchContext:o,...n&&{supportedNetworkIds:n.join(",")}}});if(!se(c))throw new Ee({key:"UnknownError"});let p=_y.safeParse(c.data);if(p.success)return p.data;throw new Ee({key:"UnknownError"})}s();a();var _u=t=>{let e=t.data,r=bp(e)??void 0;return{type:e.type,data:{...e.data,tokenAddress:bp(e)??void 0,key:r}}};s();a();var Ex="search",qy={searchResults:(t,e,r,o)=>[Ex,{query:t,networkIds:e,supportedNetworkIds:o,chainAddresses:r}]};s();a();var Ou=(i=>(i[i.Always=1/0]="Always",i[i.Short=X({minutes:5})]="Short",i[i.Medium=X({minutes:30})]="Medium",i[i.Long=X({hours:1})]="Long",i[i.Never=0]="Never",i))(Ou||{}),qu=(n=>(n[n.Immediate=0]="Immediate",n[n.Short=X({minutes:5})]="Short",n[n.Medium=X({minutes:30})]="Medium",n[n.Long=X({hours:1})]="Long",n))(qu||{});var xx=async t=>(await Oy(t)).results.map(r=>_u(r)),wo=({query:t,networkIds:e,enableQuery:r=!0,keepPreviousData:o=!1,searchContext:n,supportedNetworkIds:i,chainAddresses:c,pageSize:p})=>{let u=qy.searchResults(t,e,c,i);return W({queryKey:u,gcTime:Ou.Short,staleTime:qu.Short,enabled:r,placeholderData:o?yd:void 0,queryFn:()=>xx({query:t,networkIds:e,searchContext:n,supportedNetworkIds:i,pageSize:p})})};s();a();s();a();s();a();var wt=X({days:1}),Et=X({seconds:5});s();a();s();a();var Be=({name:t,response:e,current:r,target:o})=>{let n=`Failed to ${t}: 
`,i=[r!==void 0?`Current: ${r}`:null,o!==void 0?`Target: ${o}`:null].filter(Boolean);return i.length>0&&(n+=`${i.join(" | ")} 
`),n+=`${e.status} ${e.statusText} 
`,n+=`${JSON.stringify(e.data)}`,n},lr=({name:t,error:e,current:r,target:o})=>{let n=`Failed to parse ${t}: 
`,i=[r!==void 0?`Current: ${r}`:null,o!==void 0?`Target: ${o}`:null].filter(Boolean);return i.length>0&&(n+=`${i.join(" | ")} 
`),n+=`${JSON.stringify(e)}`,n};async function Vy(t){let e=await Y.api().bearer(!0).headers({Accept:"application/activity+json"}).get(`/v1/actors/${t}`);if(!se(e)){let o=new Error(Be({name:"getActor",response:e,target:t}));throw M.captureError(o,"profiles"),o}let r=Br.safeParse(e.data);if(r.success)return r.data;{let o=new Error(lr({name:"getActor",error:r.error,target:t}));throw M.captureError(o,"profiles"),o}}s();a();var ot="social",nt="@phantom/social",ge={actor(t){return[ot,`${nt}:actor`,{profileId:t}]},actorAndFollowers(t){return[ot,`${nt}:actor-and-followers`,{profileId:t}]},actorAndFollowing(t){return[ot,`${nt}:actor-and-following`,{profileId:t}]},userProfileByUsernameOrUserProfileId(t){return[ot,`${nt}:user-profile-by-username-or-user-profile-id`,{usernameOrUserProfileId:t}]},followUser(t,e){return[ot,`${nt}:follow-user`,{currentId:t,targetId:e}]},inbox(t,e){return[ot,`${nt}:inbox`,{profileId:t,viewFeedAsUsername:e}]},searchForActorBase(){return[ot,`${nt}:search`]},searchForActor(t){return[ot,`${nt}:search`,{query:t}]},followRequests(t){return[ot,`${nt}:follow-requests`,{profileId:t}]},suggestedActors(t,e){return[ot,`${nt}:suggested-follows`,{profileId:e,source:t}]},blocking(t){return[ot,`${nt}:blocking`,{profileId:t}]},pendingFollowRequests(t,e){return[ot,`${nt}:pending-follow-requests`,{profileId:t,targetId:e}]},reaction(t){return t?[ot,`${nt}:reaction`,{targetId:t}]:[ot,`${nt}:reaction`]}};function Vu(t){let e=async()=>{if(!t)throw new Error("No profile ID or access token");return Vy(t)};return Qd({queryKey:ge.actor(t),queryFn:e,enabled:!!t,gcTime:wt,staleTime:Et})}s();a();s();a();s();a();function Or(t){let e=t.match(/\/v1\/actors\/([^/]+)/)?.[1];return e?Me.parse(e):void 0}s();a();function he(t){return Or(t)??Me.parse(t)}var ho=(t,e)=>{let r=he(e.id);r&&t.setQueryData(ge.actor(r),e)};function Ix({usernameOrUserProfileId:t}){let e=t?.startsWith("@")?t.slice(1):t,r=as(),o=ge.userProfileByUsernameOrUserProfileId(t);return W({enabled:!!e,queryKey:o,queryFn:async()=>{if(!e)throw new Error("No sanitized username or user profile id");let i=await r.getUserProfileByUsernameOrUserProfileId(e);if(!i)throw new Error("No user profile");return i},gcTime:wt,staleTime:Et})}function Gu({query:t}){let e=j(),{data:r}=Xo(),{data:o}=je(),n=r?.accessToken,i=t?.startsWith("@")?t.slice(1).trim():t.trim(),c=as(),p=ge.searchForActor(i),u=async()=>{if(!i||!n||!o?.id)return{actors:[]};let{actors:g}=await c.searchForActor(i,n,o.id);for(let y of g)ho(e,y);return g.sort((y,w)=>y.isFollowing?-1:w.isFollowing?1:0),{actors:g}},l=!!n;return{...W({enabled:l,queryKey:p,queryFn:u,gcTime:wt,staleTime:Et}),enabled:l}}s();a();s();a();s();a();s();a();function Ky(t){let{attachment:e,...r}=t,o,n;if(e){let i=Array.isArray(e)?e:[e];for(let c of i)!c.name||!c.value||(c.name==="usd_value"&&(o=c.value),c.name==="amount"&&(n=c.value))}return{...r,usdValue:o,amount:n}}function ci(t){return{...t,published:typeof t.published=="string"?new Date(t.published):t.published}}var Gy=d.object({type:d.string(),value:d.string().optional(),name:d.string().optional()}),pi=d.object({type:d.string(),id:d.string(),summary:d.string().optional(),published:d.union([d.date(),d.string()]).optional(),actor:d.string(),object:d.string(),attachment:d.union([Gy,d.array(Gy)]).optional()}),Fx=pi.extend({type:d.literal("EmojiReact"),actor:d.string(),to:d.string(),content:d.string(),object:d.string()}),Px=Fx.transform((t,e)=>{let r=t.content;return li.includes(r)?{...t,content:r}:(e.addIssue({code:d.ZodIssueCode.custom,message:"Not a supported reaction"}),d.NEVER)}).transform(ci),Cx=pi.extend({type:d.literal("Buy")}),js=Cx.transform(Ky).transform(ci),Rx=pi.extend({type:d.literal("Sell")}),Ys=Rx.transform(Ky).transform(ci),kx=pi.extend({type:d.literal("TrendingToken")}),ui=kx.transform(ci),Dx=pi.extend({type:d.literal("Follow")}),Xs=Dx.transform(ci),Nx=d.union([Px,js,Ys,ui,Xs]);var Bx=d.object({orderedItems:Br.array().default([]),next:d.string().optional()}),Qx=d.object({orderedItems:Br.array().default([]),next:d.string().optional()}),Lx=d.object({orderedItems:Br.array().default([]),next:d.string().optional()});var Hy=d.object({orderedItems:Br.array().default([]),next:d.string().optional()}),Ux=d.object({orderedItems:Br.array().default([]),next:d.string().optional()}),Mx=d.object({targetId:d.string(),actorId:d.string(),type:d.string(),content:d.string()}),_x=d.object({targetId:d.string(),content:d.string(),type:d.string(),count:d.number({coerce:!0})});function Ox(t,e){return t==="emoji"&&li.includes(e)}var $y=d.object({reaction:Mx.transform(t=>({...t,content:li.includes(t.content)?t.content:"\u{1F440}"})).optional(),counts:d.array(_x).transform(t=>t.filter(e=>Ox(e.type,e.content))).optional()});var li=["\u{1F680}","\u{1F49C}","\u{1F402}","\u{1F440}","\u{1F43B}","\u{1F4A9}","\u{1F480}","\u{1F602}","\u{1F438}"];var Ku={"@context":["https://www.w3.org/ns/activitystreams"],type:"Buy",id:"https://api.phantom.app/v1/actors/b4019d7d-b0fd-4573-a724-20e01de8f439/activities/3",published:new Date(Date.now()-1e3*60),actor:"https://api.phantom.app/v1/actors/e6d46df9-4ae7-4291-a25c-706eda5adb57",object:"https://api.phantom.app/v1/tokens/solana-101/So11111111111111111111111111111111111111112",summary:"Bought 100 SOL",attachment:[{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"usd_value",type:"PropertyValue",value:"1040.23"},{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"amount",type:"PropertyValue",value:"6"}]},qx=js.parse(Ku),Hu={"@context":["https://www.w3.org/ns/activitystreams"],type:"Sell",id:"https://api.phantom.app/v1/actors/b4019d7d-b0fd-4573-a724-20e01de8f439/activities/4",published:new Date(Date.now()-1e3*60),actor:"https://api.phantom.app/v1/actors/312f11a1-3ea4-4152-b002-ab095b65f34f",object:"https://api.phantom.app/v1/tokens/solana-101/6AJcP7wuLwmRYLBNbi825wgguaPsWzPBEHcHndpRpump",summary:"Sold 100 SOL",attachment:[{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"usd_value",type:"PropertyValue",value:"10.23"},{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"amount",type:"PropertyValue",value:"30.53"}]},Vx=Ys.parse(Hu),Gx={...Ku,id:`https://api.phantom.app/v1/buys/${Ku.id.split("/").pop()}`,actor:"https://api.phantom.app/v1/services/whale-alert",attachment:[{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"usd_value",type:"PropertyValue",value:"142412142214"},{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"amount",type:"PropertyValue",value:"5424121422"}]},Kx=js.parse(Gx),Hx={...Hu,id:`https://api.phantom.app/v1/sells/${Hu.id.split("/").pop()}`,actor:"https://api.phantom.app/v1/services/whale-alert",attachment:[{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"usd_value",type:"PropertyValue",value:"4466612142214"},{"@context":["https://www.w3.org/ns/activitystreams",{schema:"http://schema.org#",PropertyValue:"schema:PropertyValue",value:"schema:value"}],name:"amount",type:"PropertyValue",value:"2166612142200"}]},$x=Ys.parse(Hx),$u=t=>({type:"TrendingToken",id:`https://api.phantom.app/v1/trending-token/${t}/`,published:new Date(Date.now()-1e3*60),actor:"https://api.phantom.app/v1/services/trending-token-alert",object:`${t}`,summary:"Trending Token"}),zx=ui.parse($u(0)),Wx=ui.parse($u(1)),jx=ui.parse($u(2)),zy=t=>({type:"Follow",id:`https://api.phantom.app/v1/follow/${t}`,published:new Date(Date.now()-1e3*60),actor:"https://api.phantom.app/v1/actors/e6d46df9-4ae7-4291-a25c-706eda5adb57",object:"https://api.phantom.app/v1/actors/312f11a1-3ea4-4152-b002-ab095b65f34f"}),Yx=Xs.parse(zy(0)),Xx=Xs.parse(zy(1));var f_=X({minutes:10}),g_=X({seconds:60});s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();var XO=X({minutes:5});s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();var bo=zo(te,t=>new zu(t)),zu=class{#e;constructor(e){this.#e=e}profileFollowRequestAcceptedByUser({targetId:e,actorId:r}){let o=he(e),n=he(r);this.#e.capture("profileFollowRequestAcceptedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"followRequestAccepted"}})}profileFollowRequestDeniedByUser({targetId:e,actorId:r}){let o=he(e),n=he(r);this.#e.capture("profileFollowRequestDeniedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"followRequestDenied"}})}profileUnfollowedByUser({targetId:e,actorId:r}){let o=he(e),n=he(r);this.#e.capture("profileUnfollowedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"unfollow"}})}profileFollowedByUser({targetId:e,actorId:r,isRequest:o}){let n=he(e),i=he(r);this.#e.capture("profileFollowedByUser",{data:{targetId:e,targetProfileId:n,actorId:r,actorProfileId:i,type:o?"followRequest":"follow"}})}profileReportedByUser({targetId:e,actorId:r,additionalData:o}){let n=he(e),i=he(r);this.#e.capture("profileReportedByUser",{data:{targetId:e,targetProfileId:n,actorId:r,actorProfileId:i,type:"report",...o}})}profileUnblockedByUser({targetId:e,actorId:r}){let o=he(e),n=he(r);this.#e.capture("profileUnblockedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"unblock"}})}profileBlockedByUser({targetId:e,actorId:r}){let o=he(e),n=he(r);this.#e.capture("profileBlockedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"block"}})}profileViewedByUser({targetId:e,actorId:r,isFollowing:o}){let n=he(e),i=he(r);this.#e.capture("profileViewedByUser",{data:{targetId:e,targetProfileId:n,actorId:r,actorProfileId:i,isFollowing:o,type:"view"}})}profileFollowersViewedByUser({targetId:e,actorId:r}){let o=he(e),n=he(r);this.#e.capture("profileFollowersViewedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"viewFollowers"}})}profileFollowingViewedByUser({targetId:e,actorId:r}){let o=he(e),n=he(r);this.#e.capture("profileFollowingViewedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"viewFollowing"}})}profileSharedByUser({targetId:e,actorId:r}){let o=he(e),n=he(r);this.#e.capture("profileSharedByUser",{data:{targetId:e,targetProfileId:o,actorId:r,actorProfileId:n,type:"share"}})}};s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();s();a();var b2=new Set([ge.inbox(Me.parse(""))[1]]);s();a();s();a();s();a();s();a();var oS=D(rS(),1),nS=oS.default;var cI=nS.bind({concatArrays:!0,ignoreUndefined:!0});function pI(t,e){let r=self.localStorage.getItem(t);if(r){let o=JSON.parse(r),n=JSON.parse(e),i=JSON.stringify(cI(o,n));self.localStorage.setItem(t,i)}else self.localStorage.setItem(t,e)}function yn(t,e){return new Promise((r,o)=>{try{let n=t();e?.(null,n),r(n)}catch(n){e?.(n),o(n)}})}function ea(t,e,r){return Promise.all(t).then(o=>{let n=r?.(o)??null;return e?.(null,n),Promise.resolve(n)},o=>(e?.(o),Promise.reject(o)))}var di={getItem:(t,e)=>yn(()=>self.localStorage.getItem(t),e),setItem:(t,e,r)=>yn(()=>self.localStorage.setItem(t,e),r),removeItem:(t,e)=>yn(()=>self.localStorage.removeItem(t),e),mergeItem:(t,e,r)=>yn(()=>pI(t,e),r),clear:t=>yn(()=>self.localStorage.clear(),t),getAllKeys:t=>yn(()=>{let e=self.localStorage.length,r=[];for(let o=0;o<e;o+=1){let n=self.localStorage.key(o)||"";r.push(n)}return r},t),flushGetRequests:()=>{},multiGet:(t,e)=>{let r=t.map(n=>di.getItem(n));return ea(r,e,n=>n.map((i,c)=>[t[c],i]))},multiSet:(t,e)=>{let r=t.map(o=>di.setItem(o[0],o[1]));return ea(r,e)},multiRemove:(t,e)=>{let r=t.map(o=>di.removeItem(o));return ea(r,e)},multiMerge:(t,e)=>{let r=t.map(o=>di.mergeItem(o[0],o[1]));return ea(r,e)}},ju=di;s();a();var iS=ju;s();a();var uI=Object.defineProperty,sS=Object.getOwnPropertySymbols,lI=Object.prototype.hasOwnProperty,mI=Object.prototype.propertyIsEnumerable,aS=(t,e,r)=>e in t?uI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Sn=(t,e)=>{for(var r in e||(e={}))lI.call(e,r)&&aS(t,r,e[r]);if(sS)for(var r of sS(e))mI.call(e,r)&&aS(t,r,e[r]);return t},ta=t=>e=>{try{let r=t(e);return r instanceof Promise?r:{then(o){return ta(o)(r)},catch(o){return this}}}catch(r){return{then(o){return this},catch(o){return ta(o)(r)}}}},cS=(t,e)=>(r,o,n)=>{let i=Sn({getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:b=>b,version:0,merge:(b,E)=>Sn(Sn({},E),b)},e);(i.blacklist||i.whitelist)&&console.warn(`The ${i.blacklist?"blacklist":"whitelist"} option is deprecated and will be removed in the next version. Please use the 'partialize' option instead.`);let c=!1,p=new Set,u=new Set,l;try{l=i.getStorage()}catch{}if(l)l.removeItem||console.warn(`[zustand persist middleware] The given storage for item '${i.name}' does not contain a 'removeItem' method, which will be required in v4.`);else return t((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...b)},o,n);let f=ta(i.serialize),g=()=>{let b=i.partialize(Sn({},o()));i.whitelist&&Object.keys(b).forEach(F=>{var C;!((C=i.whitelist)!=null&&C.includes(F))&&delete b[F]}),i.blacklist&&i.blacklist.forEach(F=>delete b[F]);let E,T=f({state:b,version:i.version}).then(F=>l.setItem(i.name,F)).catch(F=>{E=F});if(E)throw E;return T},y=n.setState;n.setState=(b,E)=>{y(b,E),g()};let w=t((...b)=>{r(...b),g()},o,n),S,h=()=>{var b;if(!l)return;c=!1,p.forEach(T=>T(o()));let E=((b=i.onRehydrateStorage)==null?void 0:b.call(i,o()))||void 0;return ta(l.getItem.bind(l))(i.name).then(T=>{if(T)return i.deserialize(T)}).then(T=>{if(T)if(typeof T.version=="number"&&T.version!==i.version){if(i.migrate)return i.migrate(T.state,T.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return T.state}).then(T=>{var F;return S=i.merge(T,(F=o())!=null?F:w),r(S,!0),g()}).then(()=>{E?.(S,void 0),c=!0,u.forEach(T=>T(S))}).catch(T=>{E?.(void 0,T)})};return n.persist={setOptions:b=>{i=Sn(Sn({},i),b),b.getStorage&&(l=b.getStorage())},clearStorage:()=>{var b;(b=l?.removeItem)==null||b.call(l,i.name)},rehydrate:()=>h(),hasHydrated:()=>c,onHydrate:b=>(p.add(b),()=>{p.delete(b)}),onFinishHydration:b=>(u.add(b),()=>{u.delete(b)})},h(),S||w};var dI=Fe(cS((t,e)=>({username:void 0,setUsername:r=>t({username:r})}),{name:"view-feed-as",getStorage:()=>iS}));s();a();s();a();var ra="en-US",fI=new Intl.NumberFormat(ra,{maximumFractionDigits:0}),gI=new Intl.NumberFormat(ra,{notation:"compact",compactDisplay:"short",maximumFractionDigits:1,minimumFractionDigits:1}),yI=new Intl.NumberFormat(ra,{notation:"compact",compactDisplay:"short",maximumFractionDigits:0,minimumFractionDigits:0}),SI=new Intl.NumberFormat(ra,{notation:"compact",compactDisplay:"short",maximumFractionDigits:1,minimumFractionDigits:1}),oa=t=>{if(t<1e3)return fI.format(t);if(t<1e5){let r=Math.floor(t/100)*100;return gI.format(r).replace(".0K","K")}if(t<1e6){let r=Math.floor(t/1e3)*1e3;return yI.format(r)}let e=Math.floor(t/1e5)*1e5;return SI.format(e).replace(".0M","M")};s();a();s();a();s();a();var wI=t=>{let{data:e}=Vu(t);return pS(e)},pS=t=>{let e={followers:t?.followers&&typeof t.followers=="object"&&t?.followers?.totalItems||0,following:t?.following&&typeof t.following=="object"&&t?.following?.totalItems||0};return{...e,formattedFollowers:oa(e.followers||0),formattedFollowing:oa(e.following||0)}};s();a();s();a();var Sl=D(VS()),Qe=D(U());s();a();s();a();s();a();var GS={tokenSearchEnabled:()=>!0,trendingTokensEnabled:()=>!0};s();a();var KS={tokenSearchEnabled:()=>!0,trendingTokensEnabled:()=>!1};s();a();var HS={tokenSearchEnabled:()=>!0,trendingTokensEnabled:()=>!0};s();a();var $S={tokenSearchEnabled:()=>Ne.isFeatureEnabled("enable-monad-explore-search"),trendingTokensEnabled:()=>!1};s();a();var zS={tokenSearchEnabled:()=>!0,trendingTokensEnabled:()=>!0};s();a();var WS={tokenSearchEnabled:()=>!0,trendingTokensEnabled:()=>!0};s();a();var jS={tokenSearchEnabled:()=>Ne.isFeatureEnabled("enable-sui-explore-search"),trendingTokensEnabled:()=>!1};var mP=new Yo({solana:WS,ethereum:HS,polygon:zS,base:GS,bitcoin:KS,monad:$S,sui:jS}),ll=jo(mP);s();a();var YS={fields:["domain","name","category","tags"],storeFields:["domain","name","category","tags","imageUrl"],searchOptions:{boost:{name:2},prefix:!0,fuzzy:t=>t.length>3?.2:!1}};s();a();var ha=t=>["explore-dapp",t];var ml=t=>t.addresses.map(e=>I.getMainnetNetworkID(e.networkID))??[];function XS(t){try{return rr.get(t).nonNativeFungibleTokenType}catch{return"SolanaNative"}}s();a();s();a();var Vt="@phantom/explore",Ve={RecentlyViewedSearchItems:[Vt,"RecentlyViewedSearchItems"],sitesV2({sortBy:t,timeFrame:e,networkIDs:r,limit:o,locale:n,rankAlgo:i}){return[Vt,"sitesV2",Se,n,{sortBy:t,timeFrame:e,networkIDs:r,rankAlgo:i,limit:o}]},recommendedSites(t,e){return[Vt,"sites","recommended",Se,e,t]},tokensV2({sortBy:t,sortDirection:e,timeFrame:r,networkIDs:o,limit:n,rankAlgo:i}){return[Vt,"tokensV2",{sortBy:t,sortDirection:e,timeFrame:r,networkIDs:o,rankAlgo:i,limit:n}]},collectionsV2({sortBy:t,timeFrame:e,networkIDs:r,limit:o,locale:n,rankAlgo:i}){return[Vt,"collectionsV2",Se,n,{sortBy:t,timeFrame:e,networkIDs:r,rankAlgo:i,limit:o}]},featuredTransactions(t,e){return[Vt,"transactions","featured",Se,e,t]},learn(t,e){return[Vt,"learn",Se,e,t]}};var dP=10,ZS="RecentlyViewedSearchItems";async function fP(t){return await t.get(ZS)??[]}async function ew(t,e){await t.set(ZS,e)}function dl(t){return W({queryKey:Ve.RecentlyViewedSearchItems,queryFn:async()=>fP(t),staleTime:0,enabled:!0})}function gP(t){let e=j();return de({mutationFn:async o=>{let n=JS(o),c=(e.getQueryData(Ve.RecentlyViewedSearchItems)??[]).filter(p=>JS(p)!==n);c.unshift(o),c=c.slice(0,dP),await ew(t,c),e.setQueryData(Ve.RecentlyViewedSearchItems,c),await e.refetchQueries({queryKey:Ve.RecentlyViewedSearchItems})}})}function yP(t){let e=j();return de({mutationFn:async()=>{await ew(t,[]),e.setQueryData(Ve.RecentlyViewedSearchItems,[]),await e.refetchQueries({queryKey:Ve.RecentlyViewedSearchItems})}})}function JS(t){return t.type==="token"?J(z(t.data)):t.data.id}s();a();var SP=t=>{let e={isRecommended:"true"};return t.networkIds&&(e.chainIds=t.networkIds.join(",")),`/dapps/v1?${new URLSearchParams(e).toString()}`},wP=async t=>{let e=await Y.api().get(SP(t));if(e.status===500)throw new Error("Error fetching recommended dapps from registry");return(await e.data).data},fl=t=>{let e=j();return W({queryKey:["dapps","recommended",t],queryFn:async()=>{try{let o=await wP(t);return Ho.batch(()=>{for(let n of o??[]){let i=ha(n.domain),c=e.getQueryState(i);e.setQueryData(i,()=>n??c?.data??null)}}),o}catch(o){throw M.captureError(o,"dappRegistry"),o}},gcTime:X({days:1}),staleTime:X({days:1})})};s();a();s();a();var tw=async({sortBy:t,sortDirection:e,timeFrame:r,networkIDs:o,limit:n,rankAlgo:i})=>{let c=new URLSearchParams({timeFrame:r,sortBy:t,sortDirection:e,limit:n.toString(),rankAlgo:i});o.forEach(l=>{c.append("chainIds[]",l)});let p=await Y.api().get("/explore/v2/trending-tokens",{params:c});if(!se(p))throw new Error("Failed to fetch tokens");let u=Uy.safeParse(p.data);if(!u.success)throw new Error("Failed to parse tokens");return u.data};s();a();var vn=(t,e)=>{let r=ps(),n=Uu().find(c=>c.type===e),i=[];return n&&"network"in n?n.network.forEach(c=>{c!==ai&&r.includes(c)&&i.push(c)}):i=r,t!==ai&&!i.includes(t)?[]:t===ai?i:[t]};var hP=X({minutes:1}),bP=X({minutes:1}),AP=100,gl=({sortBy:t,sortDirection:e,timeFrame:r,network:o,limit:n,rankAlgo:i,enableQuery:c=!0})=>{let{data:p}=ue(),u=vn(o,"tokens"),l=AP,f=Ie(k.language)??"en";return W({queryKey:Ve.tokensV2({sortBy:t,sortDirection:e,timeFrame:r,networkIDs:u,limit:l,rankAlgo:i}),enabled:!!p&&c,async queryFn(){if(!p)throw new Error("No account found");return tw({sortBy:t,sortDirection:e,timeFrame:r,networkIDs:u,locale:f,limit:l,rankAlgo:i})},gcTime:bP,staleTime:hP,retry:3,select:g=>n>=l?g:{...g,items:g.items.slice(0,n)}})};var Si=3,vP=15,yl=50,rw={VERIFIED:1,NOT_VERIFIED:2,POSSIBLE_SPAM:3,SPAM:4},EP=(t,e=100)=>{let[r,o]=(0,Qe.useState)(!1);return(0,Qe.useEffect)(()=>{let n;return t?n=setTimeout(()=>o(!0),e):o(!1),()=>clearTimeout(n)},[t,e]),r},xP=t=>{let e=XS(t.chainId),r=I.getChainDefinition(t.chainId),o={name:t.name,symbol:t.symbol,logoUri:t.logoUrl,chain:{id:t.chainId,symbol:r.tokenSymbol,name:r.name,imageUrl:r.iconUrl}};switch(e){case"SPL":return{type:e,data:{...o,mintAddress:t.address}};case"ERC20":return{type:e,data:{...o,contractAddress:t.address}};case"BRC20":return{type:e,data:{...o,firstCreatedInscriptionId:t.address}};default:return null}},IP=t=>t.reduce((e,r)=>{let o=xP(r);return o&&e.push(o),e},[]),FP=({searchQuery:t,networkIds:e,minSearchResults:r,excludePlaceholderTokens:o=!1,extraDapps:n=[]})=>{let[i,c]=(0,Qe.useState)(!1),[p,u]=(0,Qe.useState)(!1),[l,f]=(0,Qe.useState)(!1),g=(0,Qe.useMemo)(()=>e.filter(Je=>ll.get(Je).tokenSearchEnabled()),[e]);(0,Qe.useEffect)(()=>{c(!1),u(!1),f(!1)},[t]);let{data:y=[],isPending:w}=wo({query:t,networkIds:g,searchContext:"explore",enableQuery:!!t}),S=Mu("tokens"),{data:h}=gl({sortBy:S?.sortByDefault??"rank",sortDirection:S?.sortDirectionDefault??"asc",timeFrame:S?.timeFrameDefault??"24h",network:S?.networkDefault??"solana:101",limit:10,rankAlgo:S?.rankAlgo??"default",enableQuery:!t&&!o}),b=(0,Qe.useMemo)(()=>y.sort((Je,zn)=>rw[Je.data.spamStatus??"NOT_VERIFIED"]-rw[zn.data.spamStatus??"NOT_VERIFIED"]),[y]),E=(0,Qe.useMemo)(()=>h?.items?IP(h.items):[],[h?.items]),T=r??(t.length===0?vP:Si),F=(0,Qe.useMemo)(()=>b.slice(0,p?yl:T),[p,b,T]),C=(0,Qe.useMemo)(()=>[...b.map(Je=>J(z(Je))),...E.map(Je=>J(z(Je)))],[b,E]),{data:B={},isPending:q}=_t({query:{data:C},enabled:C.length>0}),{data:L=[],isPending:K}=fl({networkIds:g}),G=(0,Qe.useMemo)(()=>{let Je=[...L,...n],zn=(0,Sl.default)(Je,pT=>rs(pT.domain));return Object.values(zn)},[L,n]),v=rs(t),x=vd(G,v,YS),P=(0,Sl.default)(x,Je=>rs(Je.domain)),Q=Object.values(P),_=Q.slice(0,i?yl:Si),{data:R,isPending:O,enabled:$}=Gu({query:t}),N=$&&O,ce=!!t,pe=K||w||N,ke=ce&&!pe,Ae=re(),{data:Vo}=dl(Ae),{actorsAll:Ue,actors:ie}=(0,Qe.useMemo)(()=>{let Je=R?.actors??[],zn=Je.slice(0,l?yl:Si);return{actorsAll:Je,actors:zn}},[l,R?.actors]),We=(0,Qe.useMemo)(()=>({actors:ie,dapps:L,searchedDapps:_,renderShowMoreDappsButton:ce&&Q.length>Si,isLoading:pe,tokens:F,trendingTokens:E,renderShowMoreTokensButton:ce&&b.length>T,renderShowMoreUsersButton:ce&&Ue.length>Si,priceMap:B,isPriceMapLoading:q,showSearchResults:ke,showMoreTokens:p,setShowMoreTokens:u,showMoreDapps:i,setShowMoreDapps:c,showMoreUsers:l,setShowMoreUsers:f,recentlyViewedSearchItems:Vo}),[ie,L,_,ce,Q.length,pe,F,E,b.length,T,Ue.length,B,q,ke,p,i,l,Vo]),[Bt,io]=(0,Qe.useState)(null),cT=EP(pe);return(0,Qe.useEffect)(()=>{We.isLoading||io(t?We:null)},[We.isLoading,t]),{...We.isLoading&&Bt?Bt:We,showSpinner:cT&&ce}};s();a();s();a();var PP=t=>`/dapps/v1?domains=${t.join(",")}`,CP=async t=>{let e=await Y.api().get(PP(t));if(e.status===500)throw new Error("Error fetching recommended dapps from registry");return e.data.data},RP=t=>{let e=j(),r=t!=null&&Array.isArray(t)&&t.length>0&&t.filter(n=>n!=null&&n!="").length>0;return W({queryKey:["dapps",t],enabled:r,queryFn:async()=>{try{let n=await CP(t);return Ho.batch(()=>{for(let i of n??[]){let c=ha(i.domain),p=e.getQueryState(c);e.setQueryData(c,()=>i??p?.data??null)}}),n}catch(n){throw M.captureError(n,"dappRegistry"),n}},gcTime:X({days:1}),staleTime:X({days:1})})};s();a();var nw=D(U());s();a();var ow=async(t,e)=>{let r=new URLSearchParams({appVersion:Se,limit:"6",locale:e,platform:De,timeframe:"24h"});t.forEach(i=>{r.append("chainIds[]",i)});let o=await Y.api().get("/explore/v1/featured-dapps",{params:r});if(!se(o))throw new Error("Failed to fetch sites");return await o.data};var kP=X({minutes:10}),DP=X({minutes:10}),NP=()=>{let{data:t}=ue(),e=(0,nw.useMemo)(()=>t?ml(t):[],[t]),r=Ie(k.language)??"en",o=async()=>{if(!t)throw new Error("No account found");return ow(e,r)};return W({queryKey:Ve.recommendedSites(e,r),enabled:!!t,queryFn:o,gcTime:kP,staleTime:DP})};s();a();var BP=D(U());s();a();var F3=X({minutes:10}),P3=X({minutes:10});s();a();s();a();var QP={rank:"trending",top:"top"},iw=async({sortBy:t,timeFrame:e,networkIDs:r,limit:o,locale:n,rankAlgo:i})=>{let c=new URLSearchParams({appVersion:Se,limit:o.toString(),locale:n,platform:De,rankAlgo:i,rankBy:QP[t],timeframe:e});r.forEach(l=>{c.append("chainIds[]",l)});let p=await Y.api().get("/explore/v1/trending-dapps",{params:c});if(!se(p))throw new Error("Failed to fetch sites");let u=Ly.safeParse(p.data);if(!u.success)throw new Error("Failed to parse sites");return u.data};var LP=X({minutes:10}),UP=X({minutes:10}),MP=({sortBy:t,timeFrame:e,network:r,limit:o,rankAlgo:n})=>{let{data:i}=ue(),c=vn(r,"sites"),p=Ie(k.language)??"en";return W({queryKey:Ve.sitesV2({sortBy:t,timeFrame:e,networkIDs:c,locale:p,limit:o,rankAlgo:n}),enabled:!!i,async queryFn(){if(!i)throw new Error("No account found");return iw({sortBy:t,timeFrame:e,networkIDs:c,locale:p,limit:o,rankAlgo:n})},gcTime:UP,staleTime:LP,retry:3})};s();a();s();a();var _P={rank:"trending",top:"volume"},OP=t=>t.floorPrices.length>0&&t.marketplacePages.length>0,sw=async({sortBy:t,timeFrame:e,networkIDs:r,limit:o,locale:n,rankAlgo:i})=>{let c=new URLSearchParams({appVersion:Se,limit:o.toString(),locale:n,platform:De,rankAlgo:i,rankBy:_P[t],timeframe:e});r.forEach(l=>{c.append("chainIds[]",l.toString())});let p=await Y.api().get("/explore/v1/trending-collections",{params:c});if(!se(p))throw new Error("Failed to fetch collections");let u=My.safeParse(p.data);if(!u.success)throw new Error("Failed to parse collections");return{...u.data,data:u.data.data.filter(OP)}};var qP=X({minutes:10}),VP=X({minutes:10}),GP=({sortBy:t,timeFrame:e,network:r,limit:o,rankAlgo:n})=>{let{data:i}=ue(),c=vn(r,"collections"),p=Ie(k.language)??"en";return W({queryKey:Ve.collectionsV2({sortBy:t,timeFrame:e,networkIDs:c,locale:p,limit:o,rankAlgo:n}),enabled:!!i,async queryFn(){if(!i)throw new Error("No account found");return sw({sortBy:t,timeFrame:e,networkIDs:c,locale:p,limit:o,rankAlgo:n})},gcTime:VP,staleTime:qP,retry:3})};s();a();s();a();var aw=async(t,e)=>{let r=new URLSearchParams({appVersion:Se,locale:e,platform:De});t.forEach(i=>{r.append("chainIds[]",i)});let o=await Y.api().get("/explore/v1/learn-grid",{params:r});if(!se(o))throw new Error("Failed to fetch learn grid");return o.data};var KP=X({minutes:10}),HP=X({minutes:10}),$P=()=>{let t=ps(),e=Ie(k.language)??"en";return W({queryKey:Ve.learn(t,e),enabled:t.length>0,async queryFn(){return aw(t,e)},gcTime:HP,staleTime:KP})};s();a();s();a();s();a();s();a();var Ge=D(U());var WP=Ge.default.lazy(()=>import("./FiatRampFlow-HNTMJIFF.js").then(t=>({default:t.FiatRampFlow}))),jP=Ge.default.lazy(()=>import("./FiatRampPaymentMethodsPage-ZYKXOMJJ.js").then(t=>({default:t.FiatRampPaymentMethodsPage}))),cw=Ge.default.lazy(()=>import("./FiatRampProvidersPage-QZLXWPZS.js").then(t=>({default:t.FiatRampProvidersPage}))),YP=Ge.default.lazy(()=>import("./FiatRampFlowPreselectedToken-4QBSPX35.js").then(t=>({default:t.FiatRampFlowPreselectedToken}))),XP=Ge.default.lazy(()=>import("./FiatRampFlowPreselectedToken-4QBSPX35.js").then(t=>({default:t.WrappedFiatRampFormPage}))),JP=Ge.default.lazy(()=>import("./FiatRampWaitingOnRamp-L3COCPEO.js").then(t=>({default:t.FiatRampWaitingOnRamp}))),ZP=Ge.default.lazy(()=>import("./FiatRampRedirectToProvider-T7PNPN7B.js").then(t=>({default:t.FiatRampRedirectToProvider}))),pw=As({id:"fiat-ramp-detail",initialViewId:"fiat-ramp-detail-providers",views:[{id:"fiat-ramp-detail-providers",element:Ge.default.createElement(cw,null)},{id:"fiat-ramp-detail-payment-methods",element:Ge.default.createElement(jP,null)}],display:"modal",stacks:[]}),eC=As({id:"fiat-ramp-redirect-to-provider",initialViewId:"main",views:[{id:"main",element:Ge.default.createElement(Ge.default.Fragment,null)},{id:"fiat-ramp-redirect-to-provider",element:Ge.default.createElement(ZP,null),params:{url:d.string().url(),provider:Ap.extend({tag:d.string().optional()}),sessionId:d.string(),caip19:d.string()}},{id:"fiat-ramp-waiting-on-ramp",element:Ge.default.createElement(JP,null),params:{sessionId:d.string(),caip19:d.string()}}],display:"modal",stacks:[]}),tC=As({id:"fiat-ramp",initialViewId:"fiat-ramp-fungible-selection",views:[{id:"fiat-ramp-fungible-selection",element:Ge.default.createElement(WP,null)},{id:"fiat-ramp-fungible-selected",element:Ge.default.createElement(YP,null),params:{buy:d.string(),amount:d.number().optional(),redirectURL:d.string().url().optional()}},{id:"fiat-ramp-form",element:Ge.default.createElement(XP,null)},{id:"fiat-ramp-providers",element:Ge.default.createElement(cw,null)}],display:"modal",stacks:[pw,eC]});s();a();s();a();s();a();s();a();var Aa=t=>{let e=[];for(let r in t.errors)Array.isArray(t.errors[r])&&e.push(t.errors[r].join(", "));return e.join(", ")};var lw=async({locale:t})=>{let e;try{let r=JSON.stringify({platform:De,appVersion:Se,locale:t}),o=await Y.api().headers({"Content-Type":"application/json"}).post(({apiEnv:i})=>`/banners/force_upgrade/${i}/v1`,r);if(o.status===400){let i=await o.data,c=Aa(i);throw new Error(c)}else if(o.status<200||o.status>299)throw new Error(`status code: ${o.status}, body: ${o.statusText}`);let n=o.data;return n?{...n}:uw}catch(r){return e===400&&r instanceof Error&&M.captureError(r,"actionBanner"),uw}},uw={forceUpgradeStatus:"noop"};var mw=async({locale:t})=>({...await lw({locale:t})});s();a();var En="@phantom/interstitials",Kr=`${En}:action-banners`,dw=`${En}:force-upgrade`,Ke={actionBanners:(t,e)=>[Kr,{accountIdentifier:t,accessToken:e}],hasSeenInterstitial:t=>[`${En}:has-seen-interstitial`,{feature:t}],interstitialViewHistory:t=>[`${En}:interstitial-view-history`,{feature:t}],appLaunchTimes:()=>[`${En}:app-launch-times`],lastOnboardedAt:()=>[`${En}:last-onboarded-at`]};var rC=()=>W({queryKey:[dw],queryFn:async()=>{let e=Ie(k.language)??"en";return mw({locale:e})},enabled:!!Se,staleTime:X({minutes:5})});s();a();s();a();s();a();s();a();var Ta=(h=>(h.Buy="Buy",h.Collectibles="Collectibles",h.ConnectHardwareWallet="Connect Hardware Wallet",h.ConvertToJito="Convert to Jito",h.Explore="Explore",h.MintCollectible="Mint Collectible",h.SocialLogin="Social Login",h.SettingsClaimUsername="Settings: Claim Username",h.SettingsCurrency="Settings: Currency",h.SettingsImportSeedPhrase="Settings: Import Seed Phrase",h.SettingsNotificationPreferences="Settings: Notification Preferences",h.SettingsSecurityAndPrivacy="Settings: Security & Privacy",h.Swapper="Swapper",h.ExternalLink="External Link",h.Token="Token",h))(Ta||{}),wi=class extends Error{message="Failed to set dismissed action banners to storage"};var oC={Multichain:2,MultichainSwapper:1,InvalidChecksum:1,SuiWelcome:1,MonadWelcome:1,ClaimUsernameNudge:1,QuickClaimUsername:1,SeedlessPinVerification:1,AdditionalPermissions:1},nC={Multichain:3,MultichainSwapper:1,InvalidChecksum:1,SuiWelcome:1,MonadWelcome:1,ClaimUsernameNudge:1,QuickClaimUsername:1,AdditionalPermissions:1,SeedlessPinVerification:1},wl=t=>$e?oC[t]:fd?nC[t]:-1;var hl=1,Sr=".phantom-labs.settings.interstitials",wr=class{static async getViewHistory(e,r){let o=await r.get(Sr);return o?o.interstitialsViewHistory[e]??[]:[]}static async hasSeen(e,r){let o=await r.get(Sr);if(!o)return!1;let n=wl(e);return(o.interstitialsSeen[e]??0)>=n}static async setHasSeen(e,r){let o=await r.get(Sr),n=wl(e);await r.set(Sr,{version:hl,interstitialsSeen:{...!!o&&o.interstitialsSeen,[e]:n},interstitialsViewHistory:{...!!o&&o.interstitialsViewHistory,[e]:[...o?.interstitialsViewHistory?.[e]??[],Date.now()]}})}static async resetHasSeen(e,r){let o=await r.get(Sr);if(o)return r.set(Sr,{version:hl,interstitialsSeen:{...o.interstitialsSeen,[e]:void 0},interstitialsViewHistory:{...o.interstitialsViewHistory,[e]:void 0}})}static async resetAllHasSeen(e){if(await e.get(Sr))return e.set(Sr,{version:hl,interstitialsSeen:{},interstitialsViewHistory:{}})}};var bl=t=>{let e=re(),r=Ke.hasSeenInterstitial(t);return W({queryKey:r,queryFn:async()=>await wr.hasSeen(t,e)})};s();a();s();a();var fw=async t=>{await t.invalidateQueries({queryKey:[Kr]})};Dd(fw);var gw=async(t,e,r)=>{await t.setQueryData(Ke.hasSeenInterstitial(e),r)};var hi=t=>{let e=re(),r=j();return de({mutationFn:async()=>{await wr.setHasSeen(t,e),await gw(r,t,!0)},onSuccess:()=>r.invalidateQueries({queryKey:Ke.interstitialViewHistory(t)})})};s();a();var Gt=D(U());s();a();var Ea=D(U());s();a();s();a();s();a();var Al=async t=>await t.get("dismissedActionBanners")??[],yw=async(t,e)=>{try{let r=await Al(t);return r.includes(e)?void 0:t.set("dismissedActionBanners",[...r,e])}catch{throw new wi}};var vl=()=>{let t=re(),{data:e}=W({queryKey:Ke.appLaunchTimes(),queryFn:async()=>await t.get("appLaunchTimes")??[]});return e??[]};s();a();var El=()=>{let t=re(),{data:e}=W({queryKey:Ke.lastOnboardedAt(),queryFn:async()=>await t.get("lastOnboardedAt")??-1});return e};var Sw=()=>{let t=El(),e=vl();if(e.length<2)return!0;if(t!==void 0){let[r,o]=e;if(t<r&&t<o)return!1}return!0};function bi(t,e,r){let{data:o,isSuccess:n}=bl(t),{data:i}=me(e?[e]:[]),c=i?.length===1?i[0]:!0,p=Sw(),u=(0,Ea.useCallback)(()=>r(),[r]);return(0,Ea.useMemo)(()=>c&&n&&!o&&!p&&u(),[c,o,p,u,n])}var xl={data:{feature:"sui"}},iC=({onPrimaryAction:t,onSecondaryAction:e,image:r,condition:o=()=>!0})=>{let{t:n}=tt(),{mutateAsync:i}=cs(),[c]=us(["sui"]),{mutate:p}=hi("SuiWelcome"),u=bi("SuiWelcome",void 0,()=>o()&&!c&&!Ko()),l=(0,Gt.useCallback)(async()=>{await i({chainIDs:["sui"]}),t(),p()},[i,t,p]),f=(0,Gt.useCallback)(()=>{e(),p()},[e,p]),g=(0,Gt.useMemo)(()=>({title:n("interstitialSuiWelcomeTitle"),items:[{key:"suiValueProp1",title:n("interstitialSuiWelcomeItemTitle_1"),icon:Gt.default.createElement(Lr,{icon:"Send",color:"bgWallet",backgroundColor:"accentPrimary",shape:"square"}),description:n("interstitialSuiWelcomeItemDescription_1")},{key:"suiValueProp2",title:n("interstitialSuiWelcomeItemTitle_2"),icon:Gt.default.createElement(Lr,{icon:"Compass",color:"bgWallet",backgroundColor:"accentPrimary",shape:"square"}),description:n("interstitialSuiWelcomeItemDescription_2")},{key:"suiValueProp3",title:n("interstitialSuiWelcomeItemTitle_3"),icon:Gt.default.createElement(Lr,{icon:"Smile",color:"bgWallet",backgroundColor:"accentPrimary",shape:"square"}),description:n("interstitialSuiWelcomeItemDescription_3")}],primaryButton:{children:n("interstitialSuiWelcomePrimaryButtonText"),onAction:l,analyticsEvent:{event:"welcomeInterstitialPrimaryButtonClickedByUser",payload:xl}},secondaryButton:{children:n("commandNotNow"),onAction:f,analyticsEvent:{event:"welcomeInterstitialSecondaryButtonClickedByUser",payload:xl}},onDismiss:p,image:r,displayEvent:{event:"welcomeInterstitialSeen",payload:xl}}),[n,l,f,r,p]);return(0,Gt.useMemo)(()=>({interstitial:g,shouldShow:u}),[g,u])};s();a();var Kt=D(U());var Il={data:{feature:"monad"}},sC=({onPrimaryAction:t,onSecondaryAction:e,image:r,condition:o=()=>!0})=>{let{t:n}=tt(),{mutateAsync:i}=cs(),[c]=us(["monad"]),{mutate:p}=hi("MonadWelcome"),u=bi("MonadWelcome","enable-monad",()=>o()&&!c&&!Ko()),l=(0,Kt.useCallback)(async()=>{await i({chainIDs:["monad"]}),t(),p()},[i,t,p]),f=(0,Kt.useCallback)(()=>{e(),p()},[e,p]),g=(0,Kt.useMemo)(()=>({title:n("interstitialMonadWelcomeTitle"),items:[{key:"monadValueProp1",title:n("interstitialMonadWelcomeItemTitle_1"),icon:Kt.default.createElement(Lr,{icon:"InfoCircle",color:"accentPrimary",backgroundColor:"brandMidnight",shape:"square"}),description:n("interstitialMonadWelcomeItemDescription_1")},{key:"monadValueProp2",title:n("interstitialMonadWelcomeItemTitle_2"),icon:Kt.default.createElement(Lr,{icon:"InfoCircle",color:"accentPrimary",backgroundColor:"brandMidnight",shape:"square"}),description:n("interstitialMonadWelcomeItemDescription_2")},{key:"monadValueProp3",title:n("interstitialMonadWelcomeItemTitle_3"),icon:Kt.default.createElement(Lr,{icon:"InfoCircle",color:"accentPrimary",backgroundColor:"brandMidnight",shape:"square"}),description:n("interstitialMonadWelcomeItemDescription_3")}],primaryButton:{children:n("interstitialMonadWelcomePrimaryButtonText"),onAction:l,analyticsEvent:{event:"welcomeInterstitialPrimaryButtonClickedByUser",payload:Il}},secondaryButton:{children:n("commandNotNow"),onAction:f,analyticsEvent:{event:"welcomeInterstitialSecondaryButtonClickedByUser",payload:Il}},onDismiss:p,image:r,displayEvent:{event:"welcomeInterstitialSeen",payload:Il}}),[n,l,f,r,p]);return(0,Kt.useMemo)(()=>({interstitial:g,shouldShow:u}),[g,u])};s();a();s();a();s();a();s();a();var hw=async({accountID:t,deviceId:e,locale:r,rootId:o,selectedAccountAddresses:n,accessToken:i})=>{let c;try{let p={accountID:t,deviceId:e,locale:r,platform:De,rootId:o,selectedAccountAddresses:n,version:Se},u=await Y.api().headers({"Content-Type":"application/json"}).bearer(i).post(({apiEnv:f})=>`/banners/get_banners/${f}/v2`,p);if(u.status===400){let f=await u.data,g=Aa(f);throw new Error(g)}else if(u.status<200||u.status>299)throw new Error(`status code: ${u.status}, body: ${await u.statusText}`);let l=u.data;return l?{...l,banners:l.banners??[]}:ww}catch(p){return c===400&&p instanceof Error&&M.captureError(p,"actionBanner"),ww}},ww={id:void 0,banners:[]};s();a();s();a();var Fl=t=>t?Object.values(Ta).includes(t):!1;s();a();var bw=t=>{switch(t){case"Bottom Sheet":return $e;case"Modal":return!0;default:return!1}};var Aw=t=>{let{bannerType:e,destinationType:r}=t;switch(e){case"Deep Link":return Fl(r);case"Bottom Sheet":case"Modal":return bw(e)&&Fl(r);default:return!1}};var Tw=async({accountID:t,deviceId:e,dismissedBanners:r,locale:o,rootId:n,selectedAccountAddresses:i,accessToken:c})=>{let p=await hw({accountID:t,deviceId:e,locale:o,rootId:n,selectedAccountAddresses:i,accessToken:c});return{...p,banners:p.banners.filter(u=>Aw(u)&&!r.includes(u.id))}};var aC=X({minutes:1}),cC=()=>{let t=te(),e=re(),{data:r,isLoading:o}=Xo(),{data:n}=ue(),i=async()=>{let c=n?.type!=="readOnly"?n?.addresses.map(kd)??[]:[],p=n?.type==="seed"?n.seedIdentifier:null,u=await Al(e),l=Ie(k.language)??"en",f=await t.getDeviceId();return Tw({accountID:n?.identifier??"",deviceId:f,dismissedBanners:u,locale:l,rootId:p,selectedAccountAddresses:c,accessToken:r?.accessToken})};return W({queryKey:Ke.actionBanners(n?.identifier,r?.accessToken),queryFn:i,enabled:!o&&!!n?.identifier,staleTime:aC})};s();a();var pC=()=>{let t=re(),e=j();return de({mutationFn:async({actionBannerId:o})=>{yw(t,o),e.setQueriesData({queryKey:[Kr]},n=>{if(!n)return;let i=n.banners.filter(c=>c.id!==o);return{...n,banners:i}})}})};s();a();var Cl=t=>{let e=re(),r=Ke.interstitialViewHistory(t);return W({queryKey:r,queryFn:async()=>await wr.getViewHistory(t,e)})};s();a();var uC=()=>{let t=re(),e=j();return de({mutationFn:async()=>{let r=Date.now(),n=[...(await t.get("appLaunchTimes")||[]).slice(-1),r];return t.set("appLaunchTimes",n)},onSuccess:()=>{e.invalidateQueries({queryKey:Ke.appLaunchTimes()})}})};s();a();var lC=()=>{let t=re(),e=j();return de({mutationFn:()=>{let r=Date.now();return t.set("lastOnboardedAt",r)},onSuccess:()=>{e.invalidateQueries({queryKey:Ke.lastOnboardedAt()})}})};s();a();s();a();s();a();var ht="Auto";var ye={buyFungible:void 0,buyUsdValue:void 0,sellFungible:void 0,sellUsdValue:void 0,sellAmount:"",uiSellAmountCryptoInput:"",amountType:"sell",quoteResponse:void 0,selectedProviderIndex:0,selectedBaseProvider:ht,gasEstimation:{isFetching:!1,estimate:void 0,estimateWithBuffer:void 0},hasNoRoutes:!1,isFetchingQuote:!1,error:null,searchQuery:"",numSearchResults:0,primaryCurrency:"crypto",uiSellAmountLocalFiatInput:"",uiBuyAmountCryptoInput:"",uiBuyAmountLocalFiatInput:"",canInputFiatSellAmount:!1,swapFilter:void 0},A=Fe(t=>({...ye,resetQuote:()=>t({quoteResponse:ye.quoteResponse,isFetchingQuote:ye.isFetchingQuote,hasNoRoutes:ye.hasNoRoutes,selectedProviderIndex:ye.selectedProviderIndex,error:ye.error,uiSellAmountLocalFiatInput:ye.uiSellAmountLocalFiatInput,selectedBaseProvider:ye.selectedBaseProvider}),resetSwapper:()=>t({quoteResponse:ye.quoteResponse,gasEstimation:ye.gasEstimation,error:ye.error,sellAmount:"",uiSellAmountCryptoInput:"",uiBuyAmountCryptoInput:ye.uiBuyAmountCryptoInput,swapFilter:ye.swapFilter,selectedBaseProvider:ye.selectedBaseProvider,selectedProviderIndex:ye.selectedProviderIndex}),setBuyFungible:e=>t({buyFungible:e}),setBuyUsdValue:e=>t({buyUsdValue:e}),setHasNoRoutes:e=>t({hasNoRoutes:e}),setIsFetchingQuote:e=>t({isFetchingQuote:e}),setQuoteResponse:e=>t({quoteResponse:e,hasNoRoutes:!1}),setSelectedProviderIndex:e=>t({selectedProviderIndex:e}),setSelectedBaseProvider:e=>t({selectedBaseProvider:e}),setGasEstimation:({estimate:e,estimateWithBuffer:r,isFetching:o})=>t(n=>({gasEstimation:{...n.gasEstimation,...e!==void 0&&{estimate:e},...r!==void 0&&{estimateWithBuffer:r},...o!==void 0&&{isFetching:o}}})),setSellAmount:e=>t({sellAmount:e}),setAmountType:e=>t({amountType:e}),setSellUsdValue:e=>t({sellUsdValue:e}),setSellFungible:e=>t({sellFungible:e}),setUiSellAmountCryptoInput:e=>t({uiSellAmountCryptoInput:e}),setError:e=>t({error:e}),setSearchQuery:e=>t({searchQuery:e}),setNumSearchResults:e=>t({numSearchResults:e}),setPrimaryCurrency:e=>t({primaryCurrency:e}),setUiSellAmountLocalFiatInput:e=>t({uiSellAmountLocalFiatInput:e}),setUiBuyAmountCryptoInput:e=>t({uiBuyAmountCryptoInput:e}),setUiBuyAmountLocalFiatInput:e=>t({uiBuyAmountLocalFiatInput:e}),setCanInputFiatSellAmount:e=>t({canInputFiatSellAmount:e}),setSwapFilter:e=>t({swapFilter:e}),switchTokensForSell:()=>{t(e=>{let r=e.sellFungible??e.buyFungible,o=e.buyFungible??e.sellFungible,n=e.uiBuyAmountCryptoInput,i=e.uiBuyAmountLocalFiatInput;return{sellFungible:o,buyFungible:r,uiSellAmountCryptoInput:n,uiSellAmountLocalFiatInput:i,uiBuyAmountCryptoInput:ye.uiBuyAmountCryptoInput,uiBuyAmountLocalFiatInput:ye.uiBuyAmountLocalFiatInput,sellAmount:n,swapFilter:void 0,selectedBaseProvider:e.selectedBaseProvider}})},switchTokensForBuy:()=>{t(e=>{let r=e.sellFungible??e.buyFungible,o=e.buyFungible??e.sellFungible,n=e.uiSellAmountCryptoInput,i=e.uiSellAmountLocalFiatInput;return{sellFungible:o,buyFungible:r,uiSellAmountCryptoInput:ye.uiSellAmountCryptoInput,uiSellAmountLocalFiatInput:ye.uiSellAmountLocalFiatInput,uiBuyAmountCryptoInput:n,uiBuyAmountLocalFiatInput:i,sellAmount:n,swapFilter:void 0,selectedBaseProvider:e.selectedBaseProvider}})},resetUiAmounts:()=>t({uiSellAmountCryptoInput:ye.uiSellAmountCryptoInput,uiSellAmountLocalFiatInput:ye.uiSellAmountLocalFiatInput,uiBuyAmountCryptoInput:ye.uiBuyAmountCryptoInput,uiBuyAmountLocalFiatInput:ye.uiBuyAmountLocalFiatInput,sellAmount:ye.sellAmount,selectedBaseProvider:ye.selectedBaseProvider}),setPairAndAmount:({sell:e,buy:r,swapAmount:o})=>t(n=>{let i="uiSellAmountCryptoInput";return o.perspective==="sell"?n.primaryCurrency==="crypto"?i="uiSellAmountCryptoInput":i="uiSellAmountLocalFiatInput":n.primaryCurrency==="crypto"?i="uiBuyAmountCryptoInput":i="uiBuyAmountLocalFiatInput",{...n,sellFungible:e,buyFungible:r,[i]:o.amount,sellAmount:o.amount}})}));s();a();var Ew=D(U());s();a();var Ai=D(U());var vw=()=>{let[t,e]=(0,Ai.useState)(!1),{data:[r]}=me(["enable-quote-streaming"]),o=A(l=>l.selectedProviderIndex),n=A(l=>l.selectedBaseProvider),i=A(l=>l.quoteResponse),c=(0,Ai.useMemo)(()=>i?i.quotes:[],[i]),p=(0,Ai.useMemo)(()=>{if(r){if(!i||i.quotes.length===0)return 0;let l=mC(i,n);return l===-1?(e(n!==ht),0):(e(!1),l)}return o},[r,i,n,o]),u=c.length>0?c[p]:void 0;return{selectedQuoteIndex:p,selectedBaseProvider:r?n:"",currentQuote:u,hasDefaultedToBestQuote:t}},mC=(t,e)=>t.quotes.findIndex(r=>r.baseProvider.id===e);function Z(){let t=A(l=>l.quoteResponse),e=A(l=>l.hasNoRoutes),r=A(l=>l.isFetchingQuote),o=(0,Ew.useMemo)(()=>t?t.quotes:[],[t]),n=o[0]?.buyAmount??"",{selectedQuoteIndex:i,selectedBaseProvider:c,currentQuote:p,hasDefaultedToBestQuote:u}=vw();return{bestBuyAmount:n,currentQuote:p,hasNoRoutes:e,quoteResponse:t,quotes:o,selectedProviderIndex:i,selectedBaseProvider:c,isFetchingQuote:r,hasDefaultedToBestQuote:u}}s();a();var Vw=D(U());s();a();var qw=D(U());s();a();var Ow=D(U());s();a();s();a();s();a();s();a();var Rl=5,kl=5,xw={id:I.solana.mainnetID,imageUrl:I.solana.iconUrl,name:I.solana.name,symbol:I.solana.tokenSymbol},Ia={type:"SolanaNative",data:{amount:"0",balance:new H(0),chain:xw,decimals:9,key:"SolanaNative",logoUri:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",name:"Solana",symbol:"SOL",tokenAddress:void 0,walletAddress:"",spamStatus:"VERIFIED"}},Dl={type:"SPL",data:{amount:"0",balance:new H(0),chain:xw,decimals:6,key:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png",mintAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",name:"USD Coin",splTokenAccountPubkey:"EAF7dH8Jy43Xgp68PhyybKhfKxk46NFRkWN4PMCLqMfS",symbol:"USDC",tokenAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",walletAddress:"",programId:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",spamStatus:"VERIFIED"}},Iw={type:"SuiNative",data:{chain:{id:I.sui.mainnetID,name:I.sui.name,symbol:I.sui.tokenSymbol,imageUrl:I.sui.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/sui/info/logo.png",name:"Sui",symbol:"SUI",balance:new H(0),key:"SuiNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:"VERIFIED"}},Fw={type:"SuiCoin",data:{chain:{id:I.sui.mainnetID,name:I.sui.name,symbol:I.sui.tokenSymbol,imageUrl:I.sui.iconUrl},walletAddress:"",contractAddress:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",decimals:6,amount:"0",logoUri:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png?1547042389",name:"USD Coin",symbol:"USDC",balance:new H(0),key:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",tokenAddress:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",usd:1.8807026139560001,price:.999793,usd_24h_change:-.0005475429199477411,spamStatus:"VERIFIED"}},Pw={type:"PolygonNative",data:{chain:{id:I.polygon.mainnetID,name:I.polygon.name,symbol:I.polygon.tokenSymbol,imageUrl:I.polygon.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://wallet-asset.matic.network/img/tokens/matic.svg",name:"Polygon",symbol:I.polygon.tokenSymbol,balance:new H(0),key:"PolygonNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:"VERIFIED"}},Cw={type:"BaseNative",data:{chain:{id:I.base.mainnetID,name:I.base.name,symbol:I.base.tokenSymbol,imageUrl:I.base.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Base",symbol:I.base.tokenSymbol,balance:new H(0),key:"BaseNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:"VERIFIED"}},Rw={type:"ERC20",data:{amount:"0",balance:new H(0),decimals:6,key:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",walletAddress:"",chain:{id:I.polygon.mainnetID,imageUrl:I.polygon.iconUrl,name:I.polygon.name,symbol:I.polygon.tokenSymbol},contractAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",spamStatus:"VERIFIED"}},kw={type:"ERC20",data:{amount:"0",balance:new H(0),decimals:6,key:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",walletAddress:"",chain:{id:I.base.mainnetID,imageUrl:I.base.iconUrl,name:I.base.name,symbol:I.base.tokenSymbol},contractAddress:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",spamStatus:"VERIFIED"}},Dw={type:"EthereumNative",data:{chain:{id:I.ethereum.mainnetID,name:I.ethereum.name,symbol:I.ethereum.tokenSymbol,imageUrl:I.ethereum.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Ethereum",symbol:"ETH",balance:new H(0),key:"EthereumNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:"VERIFIED"}},Nw={type:"ERC20",data:{chain:{id:I.ethereum.mainnetID,name:I.ethereum.name,symbol:I.ethereum.tokenSymbol,imageUrl:I.ethereum.iconUrl},walletAddress:"",contractAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",decimals:6,amount:"1881092",logoUri:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png?1547042389",name:"USD Coin",symbol:"USDC",balance:new H(0),key:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",tokenAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",usd:1.8807026139560001,price:.999793,usd_24h_change:-.0005475429199477411,spamStatus:"VERIFIED"}},Ti=Dl,Nl=Ia;var Fa="https://help.phantom.com/hc/en-us/articles/5985106844435",Bw="https://help.phantom.com/hc/en-us/articles/29763090277139";var vo=18;var xn=500,Hr={amount:new H(0),amountUsd:null,pct:0};s();a();var In={};var Qw={...In,bridgeMinimumUsdAmounts:0,swapDefaultFee:new H(15e-5*10**18),bridgeDefaultFee:new H(.025*10**18),averageNetworkFee:new H(15e-5*10**18),nativeFungible:Cw,usdcFungible:kw};s();a();var Lw={...In,bridgeMinimumUsdAmounts:20,swapDefaultFee:new H(2.5*10**16),bridgeDefaultFee:new H(3.75*10**16),averageNetworkFee:new H(0),nativeFungible:Dw,usdcFungible:Nw};s();a();var Uw={...In,bridgeMinimumUsdAmounts:2,swapDefaultFee:new H(6*10**16),bridgeDefaultFee:new H(6*10**16),averageNetworkFee:new H(.0015*10**18),nativeFungible:Pw,usdcFungible:Rw};s();a();var Mw={bridgeMinimumUsdAmounts:1,swapDefaultFee:new H(3*10**6),bridgeDefaultFee:new H(30*10**6),averageNetworkFee:new H(15e3),nativeFungible:Ia,usdcFungible:Dl};s();a();var _w={bridgeMinimumUsdAmounts:1,swapDefaultFee:new H(50*10**6),bridgeDefaultFee:new H(50*10**6),averageNetworkFee:new H(50*10**6),nativeFungible:Iw,usdcFungible:Fw};var O6=["solana","ethereum","polygon","base","sui"],dC=new Yo({solana:Mw,ethereum:Lw,polygon:Uw,base:Qw,sui:_w}),xe=jo(dC);function $r(){let t=Ne.isFeatureEnabled("enable-sui-swapper");return(0,Ow.useMemo)(()=>xe.supportedChains.filter(e=>e==="sui"?t:!0),[t])}var Eo=()=>{let{data:t}=ue(),e=$r().map(r=>I.getMainnetNetworkID(r));return(0,qw.useMemo)(()=>fC(t,e),[t,e])},fC=(t,e)=>[...new Set((t?.addresses??[]).map(r=>r.networkID).filter(r=>e.includes(r)))];var Bl=()=>{let t=Eo();return(0,Vw.useCallback)(e=>!!e&&t.includes(e),[t])};s();a();var Kw=D(U());s();a();s();a();var Ql=(n=>(n[n.Always=1/0]="Always",n[n.Short=X({days:1})]="Short",n[n.Medium=X({days:3})]="Medium",n[n.Long=X({days:7})]="Long",n))(Ql||{}),Gw=(i=>(i[i.Immediate=0]="Immediate",i[i.Short=X({minutes:1})]="Short",i[i.Medium=X({minutes:2.5})]="Medium",i[i.Long=X({minutes:60})]="Long",i[i.Never=1/0]="Never",i))(Gw||{}),vi=(o=>(o[o.Short=X({seconds:20})]="Short",o[o.Medium=X({minutes:2.5})]="Medium",o[o.Long=X({minutes:5})]="Long",o))(vi||{});var gC=d.object({swapper:d.number(),review:d.number().nullish().default(null)}),Pa={swapper:vi.Short,review:null},zr=()=>{let t=Ne.getMultivariateAssignment("swapper-poll-interval-json");if(!t)return Pa;try{let e=JSON.parse(t);return gC.parse(e)}catch{return Pa}};var xt=()=>{let t=Ei(n=>n.intervalMs),e=Ei(n=>n.state),r=Ei(n=>n.setState),o=(0,Kw.useCallback)(n=>{r("resumed",n??Hw())},[r]);return{state:e,pause:()=>r("paused"),resume:o,intervalMs:t}},hr=t=>{Ei.getState().setState("resumed",t??Hw())},xo=()=>{Ei.getState().setState("paused")},Hw=()=>zr().swapper,Ei=Fe(t=>({state:"resumed",intervalMs:Pa.swapper,setState(e,r){t(r?{state:e,intervalMs:r}:{state:e})}}));s();a();var ph=D(U());s();a();s();a();s();a();s();a();var yC=t=>{let e=re(),r=te(),{data:o,isPending:n}=W({gcTime:0,queryKey:["originIsBlocklisted",t],queryFn:async()=>{let{result:i}=await _p(e,r,t);return i}});return t===void 0?{isLoading:!1,originIsBlocklisted:!1}:{isLoading:n,originIsBlocklisted:o??!1}};s();a();var Ll=D(U());s();a();var Io=class{#e;constructor(e){this.#e=e}onScannedMessageByUser=e=>{this.#e.capture("simulation",{data:{simulation:{...e,type:"message",status:"success"}}})};onFailedScannedMessageByUser=e=>{this.#e.capture("simulation",{data:{simulation:{...e,type:"message",status:"error"}}})};onScannedTransactionByUser=e=>{this.#e.capture("simulation",{data:{simulation:{...e,type:"transaction",status:"success"}}})};onFailedScannedTransactionByUser=e=>{this.#e.capture("simulation",{data:{simulation:{...e,type:"transaction",status:"error"}}})}};function SC(t,e){let{data:r}=ue(),{params:o,networkID:n}=t,[i,c]=(0,Ll.useState)(null),p=["scan-message",{url:t.url,message:o.message}],u=r?.addresses.find(S=>S.networkID===n)?.address,l=Ie(k.language)??"en",f=te(),g=new Io(f),y=zw(),w=W({queryKey:p,queryFn:async()=>{try{let S=await Op(l,await f.getDeviceId(),{...t,userAccount:u});return c(null),g.onScannedMessageByUser({networkId:n,warnings:S.warnings.map(h=>h.severity),shouldBlock:!!S.block,errorCode:S.error??""}),S}catch(S){c(S),g.onFailedScannedMessageByUser({networkId:n,url:t.url}),M.addBreadcrumb("simulation",`networkID: ${n}, url: ${t.url}, type: message`,"info"),M.captureError(w.error,"simulation")}},enabled:!!u&&!!t.url&&!!o.message&&!e?.disabled,refetchInterval:e?.disableRefetch?!1:y,staleTime:1e3*10,...Dp()});return{isFetched:w.isFetched,isFetching:w.isFetching,data:w.data,isLoading:w.isPending&&!e?.disabled,isError:w.isError||!!i,error:w.error||i}}function xi(t,e){let{params:r}=t,[o,n]=(0,Ll.useState)(null),i=te(),c=["scan-transaction",t.networkID,t.url,r?r.transactions??r.transaction:""],p=zw(),u=!1;I.isEVMNetworkID(t.networkID)||I.isSolanaNetworkID(t.networkID)?u=!!r&&r.transactions.length>0&&!!t.userAccount:I.isBitcoinNetworkID(t.networkID)?u=!!r&&!!r.transaction&&!!r.userAddresses&&r.userAddresses.length>0:I.isSuiNetworkID(t.networkID)&&(u=!!r&&!!t.userAccount);let l=Ie(k.language)??"en",f=new Io(i),g=W({queryKey:c,queryFn:async()=>{try{let y=await Zn(l,await i.getDeviceId(),t);return f.onScannedTransactionByUser({networkId:t.networkID,warnings:y.warnings.map(w=>w.severity),shouldBlock:!!y.block,errorCode:y.error??""}),n(null),e?.onSettled?.(y,void 0),y}catch(y){f.onFailedScannedTransactionByUser({networkId:t.networkID,url:t.url}),M.addBreadcrumb("simulation",`networkID: ${t.networkID}, url: ${t.url}, type: transaction`,"info"),n(y),e?.onSettled?.(void 0,y),M.captureError(y,"simulation")}},enabled:u&&!e?.disabled,refetchInterval:e?.disableRefetch?!1:p,staleTime:1e3*10,...Dp()});return{isFetched:g.isFetched,isFetching:g.isFetching,data:g.data,isLoading:g.isPending&&!e?.disabled,isError:g.isError||!!o,error:g.error||o}}var $w=5e3;function zw(){let t=Ne.getMultivariateAssignment("transactions-simulation-interval-ms");if(!t)return $w;let e=parseInt(t,10);return Number.isNaN(e)?$w:e}var ki=D(U());s();a();s();a();s();a();var Ca=d.object({name:d.string(),message:d.string()}),Yw=d.object({chainId:Nr,name:d.string(),symbol:d.string(),decimals:d.number(),logoURI:d.optional(d.string()),includesBridge:d.optional(d.boolean())}),wC=Yw.extend({address:d.string(),resourceType:d.literal("address")}),hC=Yw.extend({slip44:d.string(),resourceType:d.literal("nativeToken")}),bC=d.union([wC,hC]),Xw=d.object({id:d.string(),name:d.string(),logoUri:d.string()}),AC=d.enum(["network","phantom"]),TC=d.object({name:d.string(),percentage:d.number(),amount:d.number(),type:AC}),vC=d.object({name:d.string(),proportion:d.string()}),Jw=d.object({sellAmount:d.string(),buyAmount:d.string(),analyticsContext:d.optional(d.string())}),Ul=Jw.extend({priceImpact:d.number(),sources:d.array(vC),fees:d.array(TC),slippageTolerance:d.optional(d.number()),baseProvider:Xw}),Ml=Ul.extend({transactionData:d.array(d.string())}),_l=Ul.extend({allowanceTarget:d.string(),exchangeAddress:d.string(),gas:d.number(),value:d.string(),transactionData:d.string()}),Ol=Ul.extend({transactionData:d.array(d.string())}),Ww=d.object({name:d.string(),amount:d.string(),token:tr,percentage:d.string(),included:d.boolean(),amountUSD:d.optional(d.string())}),EC=d.object({name:d.string(),key:d.string(),logoURI:d.string()}),Zw=d.object({name:d.string(),symbol:d.string()}),xC=d.object({transactionData:d.string(),buyToken:tr,sellToken:tr,nonIncludedNonGasFees:d.string(),feeCosts:d.array(Ww),chainId:Nr,tool:EC,value:d.optional(d.string()),allowanceTarget:d.optional(d.string()),approvalMetadata:d.optional(Zw),approvalExactAmount:d.optional(d.string()),exchangeAddress:d.optional(d.string()),gasCosts:d.optional(d.array(d.number())),includedFeeCosts:d.optional(d.array(Ww))}),ql=Jw.extend({baseProvider:Xw,executionDuration:d.number(),tags:d.array(d.string()),steps:d.array(xC)}),IC=d.union([Ml,_l,Ol,ql]),Vl=d.enum(["solana","eip155","sui","xchain"]),Gl=d.object({type:Vl,taker:tr,buyToken:tr,sellToken:tr,slippageTolerance:d.number(),simulationTolerance:d.optional(d.number()),gasBuffer:d.optional(d.number()),quotes:d.array(IC),tradeFee:d.optional(d.array(d.number())),estimateGasFee:d.optional(d.array(d.number()))}),FC=d.enum(["swap-approval","swap","bridge-approval","bridge"]),PC=d.enum(["swap","bridge"]),CC=d.enum(["swap","bridge"]),Kl=d.object({sellToken:tr,buyToken:tr,approvalMetadata:d.optional(Zw)}),RC=d.object({type:d.literal("solana"),transactions:d.array(d.string()),transactionTypes:d.array(PC),transactionPairs:d.optional(d.array(Kl))}),kC=d.object({type:d.literal("evm"),transactions:d.array(Go),transactionTypes:d.array(FC),transactionPairs:d.optional(d.array(Kl))}),DC=d.object({type:d.literal("sui"),transactions:d.array(d.string()),transactionTypes:d.array(CC),transactionPairs:d.optional(d.array(Kl))}),aY=d.union([RC,kC,DC]);var Hl=d.object({name:d.string(),amount:d.string()}).strict(),Ra=d.object({name:d.string(),feeUsd:d.number().nullish(),amount:d.string(),time:d.object({text:d.string(),isFast:d.boolean()}),logoURI:d.string()}),cY=d.union([Hl,Ra]);var jw=d.object({token:bC,owner:d.string()}),eh=d.object({sell:jw,buy:jw});function ae(t){return ql.safeParse(t).success}function br(t){return Ml.safeParse(t).success}function mt(t){return _l.safeParse(t).success}function Ar(t){return Ol.safeParse(t).success}function Ht(t){return br(t)||mt(t)||Ar(t)}s();a();var It="swapper";var th=[It,"quotes"],le={quotesScope:()=>th,quotes:({sellTokenCaip19:t,buyTokenCaip19:e,taker:r,amountValue:o,amountType:n,slippageTolerance:i,priorityFee:c,takerDestination:p,enableAutoSlippage:u})=>[...th,{sellToken:t,buyToken:e,taker:r,takerDestination:p,amountValue:o,amountType:n,slippageTolerance:i,priorityFee:c,enableAutoSlippage:u}],transactions:t=>[It,"transactions",t],slippageTolerance:()=>[It,"slippageTolerance"],priorityFee:()=>[It,"priorityFee"],lastSubmittedPairs:()=>[It,"lastSubmittedPairs"],lastSelectedTokens:()=>[It,"lastSelectedTokens"],slippageSettings:()=>[It,"slippageSettings"],priorityFeeSettings:()=>[It,"priorityFeeSettings"],hasViewedAutoSlippageOptIn:()=>[It,"hasViewedAutoSlippageOptIn"],optimisticUpdates:()=>[It,"optimisticUpdates"],autoSlippageMigrationVersion:()=>[It,"autoSlippageMigrationVersion"]};var rh=async({callerAddress:t,contractAddress:e,networkId:r,sellAmount:o,allowanceTarget:n,approvalExactAmount:i,exchangeAddress:c,value:p,transactionData:u,type:l})=>{let f=[],g=[];if(e&&(await rf({callerAddress:t,spender:n,networkId:r,contractAddress:e})).lt(i??o.toString())){let S=await of({callerAddress:t,spender:n,networkId:r,contractAddress:e,exactAmount:i});f.push(S),g.push(`${l}-approval`)}let y=Go.parse({type:"0x2",from:t,data:u,chainId:I.getEVMNetworkIDValue(r),to:c,...p==="0"?{}:{value:`0x${new H(p).toString(16)}`}});return f.push(y),g.push(l),{transactions:f,transactionTypes:g}},$l=async({networkId:t,callerAddress:e,quote:r})=>{let{sellAmount:o,steps:n}=r,i=[],c=[],p=[];for(let u of n){let{allowanceTarget:l,exchangeAddress:f,value:g,transactionData:y,sellToken:w,buyToken:S,approvalMetadata:h}=u,b=w.resourceType==="address"?w.address:null,E=I.compareNetworkID(w.chainId,S.chainId)===0?"swap":"bridge";if(!l||!f||!y||!g)throw new Error("Missing bridge step data for EVM bridge quote.");let T=await rh({callerAddress:e,contractAddress:b,networkId:t,sellAmount:o,allowanceTarget:l,approvalExactAmount:u.approvalExactAmount,exchangeAddress:f,value:g,transactionData:y,type:E});i.push(...T.transactions),c.push(...T.transactionTypes),p.push({sellToken:w,buyToken:S,approvalMetadata:h}),T.transactionTypes.length==2&&T.transactionTypes.find(F=>F.includes("approval"))&&p.push({sellToken:w,buyToken:S,approvalMetadata:h})}return{type:"evm",transactions:i,transactionTypes:c,transactionPairs:p}},zl=async({quote:t,connection:e})=>{let r=[],o=[],n=[];for(let i of t.steps){let{transactionData:c,sellToken:p,buyToken:u}=i,l=I.compareNetworkID(p.chainId,u.chainId)===0?"swap":"bridge",f=await oh(c,e);r.push(hp.serialize(f).transaction),o.push(l),n.push({sellToken:p,buyToken:u})}return{type:"solana",transactions:r,transactionTypes:o,transactionPairs:n}},Ii=async({networkId:t,callerAddress:e,quote:r,sellFungible:o})=>{let n=o.type==="ERC20"&&o?.data.tokenAddress?o.data.tokenAddress:null,{allowanceTarget:i,exchangeAddress:c,sellAmount:p,value:u}=r;return{type:"evm",...await rh({callerAddress:e,contractAddress:n,networkId:t,sellAmount:p,allowanceTarget:i,exchangeAddress:c,value:u,transactionData:r.transactionData,type:"swap"})}},oh=async(t,e)=>{let r=Cr(t,"bs58");return await ef(r,{connection:e,transactionType:"Swap"})},Fi=async({quote:t,connection:e})=>{let r=t.transactionData.map(c=>oh(c,e)),n=(await Promise.all(r)).map(c=>hp.serialize(c).transaction);return{type:"solana",transactionTypes:n.map(()=>"swap"),transactions:n}},Pi=async({quote:t})=>({type:"sui",transactionTypes:Array(t.transactionData.length).fill("swap"),transactions:t.transactionData}),$t=({callerAddress:t,sellFungible:e,quote:r})=>{let{connection:o}=Ot(),n=le.transactions(r);return W({queryKey:n,enabled:!!r&&!!e,gcTime:0,staleTime:0,refetchInterval:vi.Short,async queryFn(){try{if(!r)throw new Error("Missing quote");if(!e)throw new Error("Missing sell token");let i=e.data.chain.id;if(Ht(r)){if(I.isEVMNetworkID(i)&&mt(r))return await Ii({networkId:i,callerAddress:t,quote:r,sellFungible:e});if(I.isSolanaNetworkID(i)&&br(r))return Fi({quote:r,connection:o});if(I.isSuiNetworkID(i)&&Ar(r))return Pi({quote:r});throw new Error(`Single network swap quote not supported for network ID ${i}`)}if(ae(r)){if(I.isEVMNetworkID(i))return await $l({networkId:i,callerAddress:t,quote:r});if(I.isSolanaNetworkID(i))return await zl({quote:r,connection:o});throw new Error(`Bridge quote not supported for network ID ${i}`)}throw new Error("Swap quote type not supported")}catch(i){throw i instanceof Error&&M.captureError(i,"swapper"),i}}})};s();a();s();a();s();a();s();a();s();a();s();a();s();a();var Fn=t=>t.steps.map(e=>e.tool);var Ce=t=>t?ae(t)?Fn(t):t?.sources??[]:[];s();a();function Te(t){let e=t.reduce((r,o)=>r.add(o.name),new Set);return Array.from(e).join(" + ")}var BC=10,QC=Fe(t=>({transitions:[],addTransition:(e,r)=>t(o=>{let n=LC(r,e);return n?{transitions:[n,...o.transitions].slice(0,BC)}:o})}));function Da(t,e){QC.getState().addTransition(t,e)}function LC(t,e){switch(e.type){case"idle":return;case"fetchingQuote":return;case"quote":return{sell:zt(e.response,e.sell,"sell"),buy:zt(e.response,e.buy,"buy"),sellAmount:e.quote.sellAmount,buyAmount:e.quote.buyAmount,provider:Ci(e.quote),slippage:e.response.slippageTolerance,stateType:e.type,eventType:t.type,timestamp:Date.now()};case"simulationRequestErrored":return{sell:zt(e.response,e.sell,"sell"),buy:zt(e.response,e.buy,"buy"),sellAmount:e.quote.sellAmount,buyAmount:e.quote.buyAmount,provider:Ci(e.quote),slippage:e.response.slippageTolerance,stateType:e.type,eventType:t.type,error:e.error,quoteTransactionData:ka(e.quote),timestamp:Date.now()};case"simulated":return;case"simulationFailed":return{sell:zt(e.response,e.sell,"sell"),buy:zt(e.response,e.buy,"buy"),sellAmount:e.quote.sellAmount,buyAmount:e.quote.buyAmount,provider:Ci(e.quote),slippage:e.response.slippageTolerance,simulationError:e.simulationError,stateType:e.type,eventType:t.type,simulationWarning:e.scannedTransactionResult?.warnings,quoteTransactionData:ka(e.quote),simulationHumanReadableError:e.scannedTransactionResult?.simulationError?.humanReadableError,simulationRequestId:e.scannedTransactionResult?.advancedDetails?.requestId,timestamp:Date.now()};case"transactionSubmissionFailed":return{sell:zt(e.response,e.sell,"sell"),buy:zt(e.response,e.buy,"buy"),sellAmount:e.quote.sellAmount,buyAmount:e.quote.buyAmount,provider:Ci(e.quote),slippage:e.response.slippageTolerance,error:e.error,stateType:e.type,eventType:t.type,quoteTransactionData:ka(e.quote),timestamp:Date.now()};case"transactionNotConfirmed":return{sell:zt(e.response,e.sell,"sell"),buy:zt(e.response,e.buy,"buy"),sellAmount:e.quote.sellAmount,buyAmount:e.quote.buyAmount,provider:Ci(e.quote),slippage:e.response.slippageTolerance,stateType:e.type,eventType:t.type,quoteTransactionData:ka(e.quote),timestamp:Date.now(),error:e.error};default:return}}var Ci=t=>{let e=Ce(t);return Te(e)},zt=(t,e,r)=>{switch(r){case"sell":return{caip19:t.sellToken,symbol:e.data.symbol??void 0};case"buy":return{caip19:t.buyToken,symbol:e.data.symbol??void 0}}},ka=t=>{if(!ae(t))return t.transactionData};var Na=class{onStateChange(e,r,o){Da(o,e)}};s();a();var Ba=class{constructor(e){this.listeners=e}transition(e,r){try{let o=this.detectNextState(e,r);return this.listeners.forEach(n=>n.onStateChange(r,e,o)),o}catch{return e}}detectNextState(e,r){switch(r.type){case"quoteRequestStarted":return{type:"fetchingQuote",buy:r.buy,sell:r.sell,amount:r.amount};case"quoteResponseReceived":switch(e.type){case"fetchingQuote":case"quote":case"simulated":case"simulationRequestErrored":case"transactionSubmissionFailed":case"transactionNotConfirmed":let o=r.response.quotes[r.quoteIndex];if(!o)throw new Error("Quote index out of bounds");return{type:"quote",response:r.response,buy:e.buy,sell:e.sell,quote:o};default:throw new Error("Can't transition from this state")}case"quoteSelected":switch(e.type){case"quote":let o=e.response.quotes[r.quoteIndex];if(!o)throw new Error("Quote index out of bounds");return{type:"quote",quote:o,buy:e.buy,sell:e.sell,response:e.response};default:throw new Error("Can only transition to QuoteChanged from Quote")}case"simulationResponseReceived":switch(e.type){case"quote":return r.scannedTransactionResult.error?{type:"simulationFailed",quote:e.quote,buy:e.buy,sell:e.sell,response:e.response,scannedTransactionResult:r.scannedTransactionResult,simulationError:r.scannedTransactionResult.error}:{type:"simulated",quote:e.quote,buy:e.buy,sell:e.sell,response:e.response,scannedTransactionResult:r.scannedTransactionResult};default:throw new Error("Can only transition to Simulated from Simulating")}case"simulationRequestError":switch(e.type){case"quote":return{type:"simulationRequestErrored",buy:e.buy,sell:e.sell,quote:e.quote,response:e.response,error:r.error};default:throw new Error("Can only transition to SimulationRequestErrored from Simulating")}case"transactionSubmissionFailed":switch(e.type){case"simulated":case"simulationFailed":return{type:"transactionSubmissionFailed",quote:e.quote,buy:e.buy,sell:e.sell,response:e.response,scannedTransactionResult:e.scannedTransactionResult,error:r.error};default:throw new Error("Can only transition to SwapSubmitFailed from SubmittingSwap")}case"transactionConfirmationFailed":switch(e.type){case"simulated":return{type:"transactionNotConfirmed",quote:e.quote,buy:e.buy,sell:e.sell,txReceipt:r.txReceipt,response:e.response,scannedTransactionResult:e.scannedTransactionResult,error:r.error};default:throw new Error("Can only transition to TransactionNotConfirmed from ConfirmingTransaction")}}}};var UC=new Ba(new Set([new Na])),nh=Fe(t=>({state:{type:"idle"},transition:e=>{t(r=>{let o=r.state;return{state:UC.transition(o,e)}})}}));var Tr=()=>{let t=nh(r=>r.state),e=nh(r=>r.transition);return{state:t,transition:e}};s();a();var MC="swap-priority-fee",_C=async(t,e,r)=>{let o=Cr(t,"bs58");return await Ji(o,r),{networkFeeEstimation:await ys(e,[o.message])}};function ih({swapTransactions:t,chainId:e,solanaConnection:r,enabled:o=!0}){return W({queryKey:[MC],queryFn:async()=>{if(!t)throw new Error("No swap transactions");if(t.type!=="solana")throw new Error("Trying to estimate network fee for non-solana txs");if(!e)throw new Error("Trying to execute swap with no chain id.");try{let n=t.transactions.map(p=>_C(p,e,r));return(await Promise.all(n)).map(p=>p.networkFeeEstimation.value)}catch{return[0]}},staleTime:0,enabled:o&&!!t&&t.transactions.length>0&&t.type==="solana"&&!!e})}s();a();var OC="swap-priority-fee";function sh({swapTransactions:t,chainId:e,estimatedFee:r,enabled:o=!0}){return W({queryKey:[OC,t],queryFn:async()=>{if(!t)throw new Error("No swap transactions");if(t.type!=="sui")throw new Error("Trying to estimate network fee for non-sui txs");if(!e)throw new Error("Trying to execute swap with no chain id.");if(r&&r.length===t.transactions.length)return r;try{return(await Promise.all(t.transactions.map(i=>fs({networkID:e,transaction:Zo.deserializeTransactionString(i)})))).map(i=>i.gasBudget.toNumber())}catch{return[0]}},enabled:o&&!!t&&t.transactions.length>0&&t.type==="sui"&&!!e})}s();a();var qC=1.3,VC=t=>{switch(t){case ee.Ethereum.Mainnet:case ee.Ethereum.Sepolia:return 8e5;case ee.Polygon.Mainnet:case ee.Polygon.Amoy:return 5e5;case ee.Base.Mainnet:case ee.Base.Sepolia:return 5e5;default:return 0}},GC=t=>{switch(t){case ee.Ethereum.Mainnet:case ee.Ethereum.Sepolia:return 6e4;case ee.Polygon.Mainnet:case ee.Polygon.Amoy:return 6e4;case ee.Base.Mainnet:case ee.Base.Sepolia:return 6e4;default:return 0}},KC=(t,e)=>t.steps.flatMap(o=>o.gasCosts??[VC(e)]),HC=(t,e,r)=>{let o=mt(e)?[e.gas]:KC(e,r);return t?t.transactionTypes.map(n=>n.includes("approval")?GC(r):o.shift()??0):o},Cn={estimateGas:({swapTransactions:t,evmGasEstimation:e,currentQuote:r,scanResult:o,networkID:n,includeGasBuffer:i,gasBuffer:c})=>{let{maxFeePerGas:p,maxPriorityFeePerGas:u}=e,l=HC(t,r,n),f=o?.advancedDetails?.gas;return o?.advancedDetails?.gasLimit>0&&(l=f),l.map(y=>({maxFeePerGas:p,maxPriorityFeePerGas:u,networkID:n,gasLimit:new V(y).multipliedBy(i?c??qC:1).integerValue(V.ROUND_CEIL)}))}};s();a();var ah={estimateGas:({solanaNetworkFees:t,networkID:e})=>t.map(r=>({networkID:e,value:r}))};s();a();var ch={estimateGas:({suiGasBudget:t,networkID:e})=>t.map(r=>({networkID:e,gasBudget:new V(r)}))};var $C=2e4,jl=({includeGasBuffer:t=!1}={})=>{let{currentQuote:e,quoteResponse:r}=Z(),o=A(v=>v.sellFungible),n=o?.data.chain.id??ee.Solana.Mainnet,{data:i}=co(o?{address:o.data.walletAddress,networkID:o.data.chain.id}:void 0),c=i?.address??"",p=I.isEVMNetworkID(n),u=I.isSolanaNetworkID(n),l=I.isSuiNetworkID(n),f=A(v=>v.isFetchingQuote),{data:g,isFetching:y}=$t({callerAddress:c,sellFungible:o,quote:e}),w={type:"transaction",userAccount:c,params:void 0,url:"https://phantom.com",networkID:n};g?.type==="evm"&&p&&(w.params={transactions:g.transactions});let{transition:S}=Tr(),h=(0,ki.useCallback)((v,x)=>{x&&S({type:"simulationRequestError",error:x}),v&&S({type:"simulationResponseReceived",scannedTransactionResult:v})},[S]),{data:b,isFetching:E}=xi(w,{disabled:u,onSettled:h}),{connection:T}=Ot(),{data:F}=gf({networkID:p?n:ee.Ethereum.Mainnet,transactionSpeed:"standard",gasLimit:new H(1),refetchInterval:$C,enabled:p}),{data:C,isLoading:B}=ih({swapTransactions:g,chainId:u?n:ee.Solana.Mainnet,solanaConnection:T,enabled:u}),{data:q,isFetching:L}=sh({swapTransactions:g,chainId:l?n:ee.Sui.Mainnet,estimatedFee:r?.estimateGasFee,enabled:l}),K=(0,ki.useMemo)(()=>{if(!(f||!e)){if(p&&(mt(e)||ae(e))&&F&&g)return Cn.estimateGas({swapTransactions:g,evmGasEstimation:F,currentQuote:e,scanResult:b,includeGasBuffer:t,networkID:n,gasBuffer:r?.gasBuffer});if(u&&C!==void 0)return ah.estimateGas({solanaNetworkFees:C,networkID:n});if(l&&q!==void 0)return ch.estimateGas({suiGasBudget:q,networkID:n})}},[f,e,F,n,C,b,t,r?.gasBuffer,p,u,l,q,g]),G=!1;return u?G=B:l?G=y||E||L:p&&(G=y||E),(0,ki.useMemo)(()=>({gasEstimation:K,isFetching:G,isError:F===void 0}),[K,G,F])};function zC(){let t=A(i=>i.setGasEstimation),{state:e}=xt(),{gasEstimation:r}=jl(),{gasEstimation:o,isFetching:n}=jl({includeGasBuffer:!0});(0,ph.useEffect)(()=>{if(e==="paused"){t({isFetching:!1});return}t({isFetching:n,estimate:r,estimateWithBuffer:o})},[e,t,r,o,n])}s();a();var fh=D(U());s();a();var WC="swap",uh=t=>new lf(t,WC),Fo=zo(te,t=>uh(t));s();a();s();a();var lh=D(U());s();a();function Xe({key:t,queryKey:e,defaultValue:r=null}){let o=re();return W({enabled:!0,queryKey:e,gcTime:Ql.Long,staleTime:1/0,async queryFn(){try{return await o.get(t)}catch(n){return n instanceof Error&&M.captureError(n,"swapper"),r}}})}function st({key:t,queryKey:e}){let r=re(),o=j();return de({async mutationFn(n){try{return await r.set(t,n)}catch(i){i instanceof Error&&M.captureError(i,"swapper");return}},async onMutate(n){await o.cancelQueries({queryKey:e});let i=o.getQueryData(e);return o.setQueryData(e,n),{previousValue:i}},onError(n,i,c){o.setQueryData(e,c?.previousValue)}})}var jC={type:"fixed"},YC={type:"auto"},ve=()=>{let{data:[t]}=me(["enable-swapper-default-auto"]),{slippageSetting:e,isFetched:r,save:o}=XC();return{isFetched:r,selectedSetting:e??(t?YC:jC),setSlippageSetting:o}},XC=()=>{let{data:t,isFetched:e}=Xe({key:"slippageSettings",queryKey:le.slippageSettings()}),{mutateAsync:r}=st({key:"slippageSettings",queryKey:le.slippageSettings()}),o=(0,lh.useCallback)(async n=>{await r(n)},[r]);return{isFetched:e,slippageSetting:t,save:o}};function Wr(t,e,r){if(!r)return;if(e==="fixed")return r.slippageTolerance;let o=r.quotes[t];if(o)return ae(o)?r.slippageTolerance:Ht(o)?o.slippageTolerance:r.slippageTolerance}s();a();var Qa=(t,e,r)=>{if(r)return ne(t,e).times(V(r)).toNumber()},mh=(t,e)=>e&&t?e>t?e:t:e??t;function dh({buyAssetUsdValue:t,buyToken:e,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:i,phantomFeeUiAmount:c,priceImpact:p,provider:u,baseProvider:l,slippageTolerance:f,slippageType:g,sellSwapFilter:y,isRetry:w,analyticsContext:S}){if(e&&o){let h=Qa(n,e.data.decimals,t),b=Qa(i,o.data.decimals,r),E=mh(h,b);return{networkId:o.data.chain.id,chainId:I.getChainID(o.data.chain.id),toNetworkId:e.data.chain.id,toChainId:I.getChainID(e.data.chain.id),isBridge:o.data.chain.id!==e.data.chain.id,marketName:`${o.data.symbol}/${e.data.symbol}`,tradeDirection:"sell",swapSource:u,baseProvider:l,priceImpact:p,fromAssetSymbol:o.data.symbol??"",fromAssetAddress:o.data.tokenAddress,fromAssetAmount:ne(i,o.data.decimals),fromAssetUsdPrice:r,fromAssetUsdVolume:b,toAssetSymbol:e.data.symbol??"",toAssetAddress:e.data.tokenAddress,toAssetAmount:ne(n,e.data.decimals),toAssetUsdPrice:t,toAssetUsdVolume:h,totalUsdVolume:E,feeUsd:c,slippageTolerance:f,slippageType:g,sellSwapFilter:y,isRetry:w,analyticsContext:S}}return null}function Di({buyAssetUsdValue:t,buyToken:e,sellAssetUsdValue:r,sellToken:o,quote:n,slippageTolerance:i,slippageType:c,sellSwapFilter:p,isRetry:u,analyticsContext:l,baseProvider:f}){if(e&&o){let{buyAmount:g,sellAmount:y}=n,w="priceImpact"in n?n.priceImpact:0,S="sources"in n?Te(n.sources):"",h=("fees"in n?n.fees.find(F=>F.type==="phantom")?.amount.toString():"")??"",b=Qa(g,e.data.decimals,t),E=Qa(y,o.data.decimals,r),T=mh(b,E);return{chainId:o.data.chain.id??e.data.chain.id,swap:{marketName:`${o.data.symbol}/${e.data.symbol}`,tradeDirection:"sell",swapSource:S,priceImpact:w,fromAssetSymbol:o.data.symbol??"",fromAssetAddress:o.data.tokenAddress??"",fromAssetAmount:ne(y,o.data.decimals),fromAssetUsdPrice:r??0,fromAssetUsdVolume:E??0,toAssetSymbol:e.data.symbol??"",toAssetAddress:e.data.tokenAddress??"",toAssetAmount:ne(g,e.data.decimals),toAssetUsdPrice:t,toAssetUsdVolume:b,totalUsdVolume:T??0,feeUsd:Number(h),slippageTolerance:i,slippageType:c,sellSwapFilter:p,isRetry:u,analyticsContext:l,baseProvider:f}}}return null}s();a();var La=D(U());s();a();var Yl=t=>{let r={chainId:t.data.chain.id,name:t.data.name??"",symbol:t.data.symbol??"",decimals:t.data.decimals,logoURI:t.data.logoUri??""};return Oe(t.type)?{resourceType:"nativeToken",slip44:t.data.key,...r}:{resourceType:"address",address:t.data.key,...r}};s();a();function JC(t){let{mainnetID:e,iconUrl:r,name:o,tokenSymbol:n}=I[t];return{id:e,imageUrl:r,name:o,symbol:n}}var Xl=t=>t.resourceType==="address"?t.address:t.slip44,Jl=(t,e)=>{let r={amount:"0",balance:new H(0),decimals:t.decimals,key:Xl(t),logoUri:t.logoURI,mintAddress:Xl(t),name:t.name,splTokenAccountPubkey:"",symbol:t.symbol,tokenAddress:Xl(t),walletAddress:e,spamStatus:"NOT_VERIFIED"},o=JC(I.getChainID(t.chainId)),{nativeFungibleTokenType:n,nonNativeFungibleTokenType:i}=rr.get(t.chainId),c=t.resourceType==="nativeToken"?n:i,p=ZC(t);return{type:c,data:{chain:o,...r,...p}}};function ZC(t){if(t.resourceType==="address"){if(I.isEVMNetworkID(t.chainId)||I.isSuiNetworkID(t.chainId))return{contractAddress:t.address};if(I.isSolanaNetworkID(t.chainId))return{mintAddress:t.address}}return{}}function eR(t){let e=eh.safeParse(JSON.parse(t));if(!e.success)return null;let{sell:r,buy:o}=e.data,n=Jl(r.token,r.owner),i=Jl(o.token,o.owner);return!n||!i?null:{sellFungible:n,buyFungible:i}}function tR(t,e){let r=Yl(t),o=Yl(e);return!r||!o?"":JSON.stringify({sell:{token:r,owner:t.data.walletAddress},buy:{token:o,owner:e.data.walletAddress}})}var Wt=()=>{let{data:t,isFetching:e}=Xe({key:"lastSubmittedPairs",queryKey:le.lastSubmittedPairs()}),r=(0,La.useMemo)(()=>t?eR(t):null,[t]),{mutateAsync:o}=st({key:"lastSubmittedPairs",queryKey:le.lastSubmittedPairs()}),n=(0,La.useCallback)(async(i,c)=>{await o(tR(i,c))},[o]);return{pairs:r,isLoading:e,storePairs:n}};var Ni=({goToConfirmation:t})=>{let e=A(b=>b.sellUsdValue),r=A(b=>b.buyUsdValue),{currentQuote:o,quoteResponse:n,selectedProviderIndex:i,selectedBaseProvider:c}=Z(),p=A(b=>b.sellFungible),u=A(b=>b.buyFungible),l=A(b=>b.swapFilter),{selectedSetting:f}=ve(),{storePairs:g}=Wt(),y=te(),w=Fo(),{pause:S}=xt();return(0,fh.useCallback)(()=>{if(!o||!p||!u)return;let b=Wr(i,f.type,n);y.capture("swapperSwap");let E=Di({buyToken:u,sellToken:p,sellAssetUsdValue:e,buyAssetUsdValue:r,quote:o,slippageTolerance:b,slippageType:f.type,sellSwapFilter:l,baseProvider:c});E&&(M.addBreadcrumb("swapper","approved","info",Dr(E.swap)),w.approved(E)),S(),t(),I.compareNetworkID(p.data.chain.id,u.data.chain.id)===0&&g(p,u)},[o,p,u,i,f.type,n,y,e,r,S,t,w,g,l,c])};s();a();var Zl=D(U());s();a();var Ua=(t,e)=>{if(e===void 0)return;let r=z(t),o=J(r);return e[o]};s();a();var gh=D(mT()),Ma=(t,e)=>{let r=(0,gh.default)(t),o=r.value();return Math.abs(o)>0&&Math.abs(o)<1e-5?`< ${o<0?"-":""}0.00001`:e>=12?r.format("0,0.[0]"):e>=9?r.format("0,0.[000]"):r.format("0,0.[00000]")};var _a={network:{id:I.solana.mainnetID,name:I.solana.name,symbol:I.solana.tokenSymbol,imageUrl:I.solana.iconUrl},tokenType:"SolanaNative",symbol:"",logoUri:"",tokenAddress:"",amount:"",amountUsd:0};function rR({goToConfirmation:t}){let e=A(f=>f.buyFungible),r=A(f=>f.sellFungible),o=A(f=>f.setBuyUsdValue),n=A(f=>f.setSellUsdValue),i=(0,Zl.useMemo)(()=>{let f=[];return e&&r&&(f.push(z(e)),f.push(z(r))),{query:{data:f}}},[e,r]),{data:c}=_t(i),{currentQuote:p,quoteResponse:u}=Z(),l=Ni({goToConfirmation:t});return(0,Zl.useMemo)(()=>{if(!u||!p||!e||!r)return{buyToken:_a,sellToken:_a,onSwap:l};let f=e?.data,g=r?.data;if(!f||!g)return{buyToken:_a,sellToken:_a,onSwap:l};let y="",w=null,S="",h=null,{sellAmount:b,buyAmount:E}=p,T=ne(E,f.decimals),F=ne(b,g.decimals),C=H(F),B=String(T).split(".")[0].length,q=F.toString().split(".")[0].length,L=f.symbol?.length,K=g.symbol?.length,G=B&&L?B+L:0,v=q&&K?q+K:0;S=`${Ma(C,v)} ${g.symbol}`,y=`${Ma(T,G)} ${f.symbol}`;let x=Ua(e,c),P=Ua(r,c);return x?.usd&&(w=T.multipliedBy(x.usd).toNumber(),o(x.usd)),P?.usd&&(h=C.multipliedBy(P.usd).toNumber(),n(P.usd)),{buyToken:{network:f.chain,tokenType:e.type,symbol:f.symbol,logoUri:f.logoUri,tokenAddress:f.tokenAddress,amount:y,amountUsd:w},sellToken:{network:g.chain,tokenType:r.type,symbol:g.symbol,logoUri:g.logoUri,tokenAddress:g.tokenAddress,amount:S,amountUsd:h},onSwap:l}},[u,p,e,r,c,l,o,n])}s();a();var bt=D(U());s();a();s();a();function yh(t,e){if(!t||e.length===0)return null;let r=new Set(e),o=1/0,n=null;for(let i of t){let c=new V(i.data.amount??0).gt(0);if(!r.has(i.data.chain.id)||!c)continue;let p=e.indexOf(i.data.chain.id);if(p<o&&(o=p,n=i.data.chain.id,p===0))break}return n}var Sh=(t,e,r)=>{let o=e.length?yh(t,e):null;return!o||!r.includes(o)?Nl:xe.get(o).nativeFungible},wh=t=>t?xe.get(t).usdcFungible:Ti,Bi=(t,e)=>{let r=po(e);return t.find(o=>{if(Oe(r)&&r===o.type)return!0;if(e.resourceType==="address"){let n=hf(o);return ao(e)?gp(e.address,n):e.address===n}})},Oa=(t,e,r)=>{let o=Bi(r,t);if(!o){if(Oe(po(t)))o=xe.get(t.chainId).nativeFungible;else if(e&&e.chainId===t.chainId){let n=Oe(po(e)),{usdcFungible:i,nativeFungible:c}=xe.get(e.chainId);o=n?i:c}}return o},em=(t,e=!1)=>{let{usdcFungible:r,nativeFungible:o}=xe.get(t.chainId),n=J(t),i=J(z(r));return Oe(po(t))?r:gp(n,i)?o:e?r:o};s();a();var hh=D(U());s();a();var tm=D(U());s();a();function Co(t,e){return t.data.key===e.data.key}function Ro({enablePrices:t,enableSorting:e}){let{fungibles:r,isLoadingTokens:o,tokensError:n,refetch:i}=vt({enablePrices:t,enableSorting:e}),c=Bl(),p=A(f=>f.sellFungible),u=r.filter(f=>c(f.data.chain.id)&&f.type!=="CompressedSPL"),l=(0,tm.useMemo)(()=>{if(p){let f=u.findIndex(y=>Co(y,p)),g=u[f];g&&g.data.amount!==p.data.amount&&(u[f]=p)}return u.filter(f=>f.data.amount!=="0")},[u,p]);return(0,tm.useMemo)(()=>({assets:l,isLoading:o,error:n,refetchTokens:i}),[l,o,n,i])}var qa=()=>{let t=ls(),e=A(n=>n.sellFungible),{pairs:r}=Wt(),{assets:o}=Ro({enablePrices:!1,enableSorting:!1});return(0,hh.useMemo)(()=>{let n=wh(e?.data.chain.id),p=((r?t.includes(r.buyFungible.data.chain.id):!1)?r?.buyFungible:void 0)??n;return p?Bi(o,z(p))??p:void 0},[e,r,t,o])};s();a();var bh=D(U());var jr=()=>{let t=ls(),e=Eo(),{pairs:r}=Wt(),{assets:o}=Ro({enablePrices:!1,enableSorting:!1}),{fungibles:n}=vt();return(0,bh.useMemo)(()=>{let i=Sh(n,t,e),c=r?z(r?.sellFungible):void 0,p=r?z(r?.buyFungible):void 0;return((c?t.includes(c.chainId):!1)&&c&&p?Oa(c,p,o):void 0)??i},[t,r,o,e,n])};var Ah=t=>{if(t)try{return Wo(t)}catch{return}},Th=t=>uo(t)??[];function oR({paramsSellFungible:t,paramsSellAmount:e,paramsBuyFungible:r,navRef:o}){let{data:[n]}=me(["enable-swapper-default-usdc"]),{isLoading:i}=Wt(),c=(0,bt.useMemo)(()=>Ah(t),[t]),p=(0,bt.useMemo)(()=>Ah(r),[r]),u=e,[l,f]=(0,bt.useState)(!1),[g,y]=(0,bt.useState)(!1),{data:w}=ue(),{assets:S,isLoading:h}=Ro({enablePrices:!1,enableSorting:!1}),{data:b,isPending:E}=wo({query:p?.resourceType==="address"?p.address:p?.slip44??"",enableQuery:!!p,networkIds:[p?.chainId??I.solana.mainnetID],searchContext:"swapper"}),T=(0,bt.useMemo)(()=>{let R=[];return c&&R.push(...Th(c)),p&&R.push(...Th(p)),R},[c,p]),{fungibles:F,isLoadingTokens:C,isRefetchingTokens:B,tokensError:q}=vt({keys:T,enablePrices:!1,enableSorting:!1}),L=jr(),K=qa(),G=A(R=>R.setBuyFungible),v=A(R=>R.setSellFungible),x=A(R=>R.setUiSellAmountCryptoInput),P=A(R=>R.setSellAmount),Q=A(R=>R.setSwapFilter);return(0,bt.useEffect)(()=>{v(void 0),f(!1),G(void 0),y(!1)},[c,p,v,G,w?.identifier,i,o]),(0,bt.useEffect)(()=>{if(l)return;let R;if(c){if(h)return;R=Oa(c,p,S)}else!c&&p?R=em(p):R=L;f(!0),v(R)},[c,p,L,S,v,h,l]),(0,bt.useEffect)(()=>{if(g)return;let R;if(p){if(E)return;if(R=Bi(b??[],p),!R){let{usdcFungible:O,nativeFungible:$}=xe.get(p.chainId);R=Oe(po(p))?$:O}}else!p&&c?R=em(c,n):R=K;if(!C&&!B&&!q&&F&&R){let O=J(z(R)),$=F.find(N=>J(z(N))===O);$&&(R=$)}y(!0),G(R)},[p,c,b,E,G,g,K,F,C,B,q,n]),(0,bt.useEffect)(()=>{u?(P(u),x(u)):(P(""),x("")),Q(void 0)},[u,o,x,P,Q]),{isLoading:(!!c||!!p)&&(!g||!l)||i}}s();a();var jt=D(U()),Ph=D(Qi());s();a();var Eh=({sellToken:t,buyToken:e,taker:r,takerDestination:o,amount:n,slippageTolerance:i,pollInterval:c,pollerState:p,enableAutoSlippage:u,priorityFee:l,getSwapQuotesStrategy:f})=>{let g=te(),y=t?z(t):void 0,w=e?z(e):void 0,S=t?bf(t,n.value).toString():n.value,h=!!n.value&&!!e&&!!t&&!!r&&p==="resumed";h||f.stopFetching();let b=le.quotes({sellTokenCaip19:y,buyTokenCaip19:w,taker:r,amountValue:S,amountType:n.type,takerDestination:o,slippageTolerance:i,enableAutoSlippage:u,priorityFee:l}),E=f.getFetchInterval(c);return W({queryKey:b,enabled:h,gcTime:0,staleTime:0,refetchInterval:E,async queryFn({signal:T}){if(!n||!w||!y||!e||!t||!r)throw new Error("missing necessary args");let F=await f.fetch({sellTokenCaip19:y,buyTokenCaip19:w,taker:r,takerDestination:o,sellAmount:S,exactOut:n.type==="buy",slippageTolerance:i,signal:T,enableAutoSlippage:u,priorityFee:l,sell:t,buy:e,amount:{value:S,type:n.type}},b);return g.capture("swapperQuotesResult",{data:{numQuotes:F.quotes.length,sellToken:t,fromNetworkId:y.chainId,toNetworkId:w.chainId}}),F}})};s();a();var xh=D(U());var Ih=()=>{let t=A(n=>n.sellAmount),e=A(n=>n.sellFungible),r=A(n=>n.buyFungible),o=A(n=>n.setSelectedBaseProvider);(0,xh.useEffect)(()=>{o(ht)},[t,e,r,o])};s();a();var Re=(t,e)=>!!t&&!!e&&I.compareNetworkID(t,e)!==0;s();a();var Rn=()=>{let t=A(g=>g.sellFungible),e=A(g=>g.buyFungible),r=A(g=>g.sellAmount),o=t?z(t):null,{data:n}=rt({query:o?{data:o}:void 0}),i=t?.data.chain.id,c=e?.data.chain.id,p=n?.usd;if(!i||!c||!r||!p||I.compareNetworkID(i,c)===0)return!0;let u=_e(Number(r),p),l=xe.get(i).bridgeMinimumUsdAmounts,f=xe.get(c).bridgeMinimumUsdAmounts;return l<=u&&f<=u};s();a();var vr=()=>Xe({key:"priorityFee",queryKey:le.priorityFee()}),Fh=()=>st({key:"priorityFee",queryKey:le.priorityFee()});s();a();var Yr=()=>Xe({key:"slippageTolerance",queryKey:le.slippageTolerance()}),Va=()=>st({key:"slippageTolerance",queryKey:le.slippageTolerance()});function iR({skipInitialBuyFungible:t,getSwapQuotesStrategy:e}){let r=A(N=>N.sellAmount),o=A(N=>N.amountType),i=A(N=>N.buyFungible)??(t?void 0:Ti),c=A(N=>N.sellFungible),{data:p}=vr(),{state:u,intervalMs:l}=xt(),f=A(N=>N.resetQuote),g=A(N=>N.setHasNoRoutes),y=A(N=>N.setError),w=A(N=>N.setIsFetchingQuote),S=A(N=>N.setQuoteResponse),h=A(N=>N.setSelectedProviderIndex),{data:[b]}=me(["enable-auto-slippage"]),{data:E}=Yr(),{mutateAsync:T}=Va(),{selectedSetting:F}=ve(),C=b&&F.type==="auto",B=Rn(),q=(0,Ph.default)(B),L=(0,jt.useMemo)(()=>{let N=o==="sell"?{amount:r,fungible:c}:{amount:r,fungible:i};return new H(N.amount).isGreaterThan(0)&&N.fungible?xd(N.amount,N.fungible.data.decimals).toString():(f(),"")},[o,i,f,r,c]),K=Re(c?.data?.chain.id,i?.data.chain.id),{data:G}=co(c?.data?.chain.id),{data:v}=co(i?.data.chain.id),x=(0,jt.useMemo)(()=>{if(G)return{chainId:G.networkID,address:G.address,resourceType:"address"}},[G]),P=(0,jt.useMemo)(()=>{if(K)return{chainId:v?.networkID,address:v?.address,resourceType:"address"}},[K,v?.address,v?.networkID]),{data:Q,error:_,isLoading:R}=Eh({sellToken:c,buyToken:i,taker:x,takerDestination:P,amount:{value:B?L:"",type:o},slippageTolerance:C?void 0:E??void 0,enableAutoSlippage:C,priorityFee:p??void 0,pollInterval:l,pollerState:u,getSwapQuotesStrategy:e}),O=(0,jt.useCallback)(N=>{y(null),h(0),w(!1),g(!1),S(N);let ce=Wr(0,F.type,N);ce&&E!==ce&&T(ce)},[y,g,w,S,h,T,E,F.type]),$=(0,jt.useCallback)(N=>{f(),w(!1),g(!0),y(N)},[f,y,g,w]);(0,jt.useEffect)(()=>{u!=="paused"&&(R?w(!0):Q?O(Q):_&&$(_))},[_,Q,R,O,$,w,u,B]),(0,jt.useEffect)(()=>{B?q===!1&&B&&(y(null),g(!1)):(y(new Ee({key:"InsufficientSellAmount"})),g(!0))},[B,q,y,g]),Ih()}s();a();var Ha=D(U());s();a();s();a();var Ft=t=>{let e=Math.floor(t/3600),r=Math.floor((t-e*3600)/60),o=t%60;if(e>0)return k.t("swapProviderEstimatedTimeHM",{hours:e,minutes:r});if(r>0){let n=o>0?r+1:r;return k.t("swapProviderEstimatedTimeM",{minutes:n})}return k.t("swapProviderEstimatedTimeS",{seconds:o})};s();a();var Ga=t=>t.steps.reduce((e,r)=>e.plus(new H(r.nonIncludedNonGasFees)),new H(0)),Ka=t=>t.steps.flatMap(o=>o.feeCosts).reduce((o,n)=>o.plus(n.amountUSD??0),new H(0));s();a();function Pt(t,e,r){if(e.lte(0))return null;let o=J({chainId:t,resourceType:"nativeToken",slip44:I.getSlip44(t)}),n=I.getTokenDecimals(t),i=I.getTokenSymbol(t);if(!o||!n||!i)return null;let c=e.div(yp(n)),p=r[o];return p?.usd?c.times(p.usd).toNumber():null}var sR=5*60,Ch=t=>{if(ae(t))return Te(Fn(t));let{sources:e}=t;return Te(e)},Rh=({quotes:t,buyTokenNetworkId:e,buyTokenDecimals:r,buyTokenSymbol:o})=>t.map(n=>{let{buyAmount:i}=n,c=rr.get(e).formDisplayPrecision;return{name:Ch(n),amount:`${yt(ne(i,r),c)} ${o}`}}),kh=({quotes:t,buyTokenNetworkId:e,buyTokenDecimals:r,buyTokenSymbol:o,networkIDForFees:n,networkFee:i,priceMap:c})=>t.filter(ae).map(p=>{let{buyAmount:u,executionDuration:l,steps:f}=p,y=Ga(p).plus(i),w=f.find(h=>!!h.tool.logoURI),S=rr.get(e).formDisplayPrecision;return{name:Ch(p),feeUsd:n&&c?Pt(n,y,c):null,amount:`${yt(ne(u,r),S)} ${o}`,time:{text:Ft(l),isFast:l<=sR},logoURI:w?.tool.logoURI??""}});s();a();var aR={aggregate(t){return t.reduce((e,r)=>({...e,gasLimit:e.gasLimit.plus(r.gasLimit)}),{networkID:I.ethereum.mainnetID,gasLimit:new H(0),maxFeePerGas:t[0].maxFeePerGas,maxPriorityFeePerGas:t[0].maxPriorityFeePerGas})}},cR={aggregate(t){return t.reduce((e,r)=>({...e,value:e.value+r.value}),{networkID:I.solana.mainnetID,value:0})}},pR={aggregate(t){return t.reduce((e,r)=>({...e,gasBudget:e.gasBudget.plus(r.gasBudget)}),{networkID:I.sui.mainnetID,gasBudget:new H(0)})}},Li=t=>{if(!(!t||t.length===0)){if(ds(t[0]))return aR.aggregate(t);if(jd(t[0]))return cR.aggregate(t);if(Yd(t[0]))return pR.aggregate(t)}};function uR({selectQuote:t}){let{quoteResponse:e,isFetchingQuote:r,quotes:o,selectedProviderIndex:n}=Z(),i=A(F=>F.setSelectedProviderIndex),c=A(F=>F.gasEstimation.estimateWithBuffer),p=A(F=>F.sellFungible),u=A(F=>F.buyFungible),l=p?.data.chain.id,{data:f}=Yn(l,Li(c)),y=$r().map(F=>gt(F)),{data:w={}}=_t({query:{data:y}}),S=e?.type==="xchain",h=(0,Ha.useMemo)(()=>u?S?kh({quotes:o,buyTokenNetworkId:u.data.chain.id,buyTokenDecimals:u.data.decimals,buyTokenSymbol:u.data.symbol,networkIDForFees:l,networkFee:f?.gasEstimationAmount??new H(0),priceMap:w}):Rh({quotes:o,buyTokenNetworkId:u.data.chain.id,buyTokenDecimals:u.data.decimals,buyTokenSymbol:u.data.symbol}):[],[u,S,o,l,f?.gasEstimationAmount,w]),b=te(),{transition:E}=Tr(),T=(0,Ha.useCallback)(F=>{let C=h[F];b.capture("swapperProviderSelected",{data:{provider:C.name}}),i(F),t(o,F),E({type:"quoteSelected",quoteIndex:F})},[i,h,b,E,o,t]);return{rows:h,selectedProviderIndex:n,isLoadingProviders:r,setSelectedProviderIndex:T}}s();a();var Dh=D(U());var Er=()=>{let{resume:t}=xt(),e=A(r=>r.resetSwapper);return(0,Dh.useCallback)(()=>{t(),e()},[e,t])};s();a();var Wa=D(U());s();a();var Bh=D(U());s();a();var Nh=D(U());var $a=()=>{let t=j();return{cancelQuotes:(0,Nh.useCallback)(async()=>{await t.cancelQueries({queryKey:le.quotesScope()}),await bd(1)},[t])}};s();a();function za(t){return{chain:"solana",type:"fungible",address:t.type==="SPL"?t.data.mintAddress:void 0,symbol:t.data.symbol??""}}function om(){let t=te(),e=A(n=>n.setBuyFungible),r=A(n=>n.buyFungible),{cancelQuotes:o}=$a();return(0,Bh.useCallback)(async n=>{if(r&&Co(n,r))return;await o();let i=za(n);t.capture("swapperUpdateToAsset",{data:i}),e(n)},[t,r,o,e])}s();a();s();a();var lR=d.enum(["pumpFun","moonshot"]),mR=d.object({type:lR,programId:d.string(),name:d.string(),iconUrl:d.string()}),dR=d.object({programs:d.array(mR)}),Qh=t=>{try{return dR.parse(t)}catch{return}};var fR={type:"pumpFun",programId:"6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P",name:"Pump.fun",iconUrl:"https://dhc7eusqrdwa0.cloudfront.net/assets/pumpfun.svg"},nm=[],xr=()=>{try{let t=Ne.getMultivariateAssignment("enabled-ugc-programs");if(!t)return Ne.isFeatureEnabled("enabled-ugc-programs")?[fR]:nm;let e=JSON.parse(t);return Qh(e)?.programs??nm}catch{return nm}};s();a();var Lh=t=>{im.getState().setAsset(t)},im=Fe(t=>({asset:void 0,setAsset(e){t({asset:e})}}));var gR=({onClose:t})=>{let e=om(),r=im(i=>i.asset),o=(0,Wa.useMemo)(()=>xr().find(c=>c.programId===r?.data?.ugcTokenMeta?.programId),[r]),n=(0,Wa.useCallback)(async()=>{r&&(await e(r),t())},[e,r,t]);return{asset:r,program:o,handleConfirmPress:n}};s();a();var yR=()=>{let{review:t}=zr();t?hr(t):xo()};s();a();s();a();var sm=()=>{let t=j(),e=A();return{clearQuotes:async()=>{e.resetQuote(),await t.invalidateQueries({queryKey:le.quotesScope()})}}};s();a();s();a();var SR=({networkID:t,unsignedTransaction:e,pendingActivityRows:r,accountIdentifier:o,accountSigner:n,storage:i,includeCallPayload:c})=>({accountSigner:n,accountIdentifier:o,networkID:t,unsignedTransaction:e,...c&&{callPayload:{from:e.from,to:e.to,data:e.data,value:e.value}},pendingTransactionInput:{ownerAddress:e.from,networkID:t,data:{nonce:"",unsignedTransaction:e,hash:""},type:"swap",display:{summary:r}},storage:i}),ja=async({transactions:t,transactionTypes:e,networkID:r,gasEstimation:o,pendingApprovalActivityRows:n,pendingSwapActivityRows:i,accountIdentifier:c,accountSigner:p,storage:u})=>{let l=!0,f="";for(let[g,y]of t.entries()){let w=o[g],S={gas:`0x${w.gasLimit.toString(16)}`,maxFeePerGas:`0x${w.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${w.maxPriorityFeePerGas.toString(16)}`},h=Go.parse({...y,...S}),E=e[g].includes("approval")?n:i,T=SR({networkID:r,accountIdentifier:c,pendingActivityRows:E.shift(),accountSigner:p,storage:u,unsignedTransaction:h,includeCallPayload:l});try{f="",f=await nf(T)}catch(F){return{signature:f,error:F instanceof Error?F:new Error("Failed to process EVM swap transaction")}}l&&(l=!1)}return{signature:f}};s();a();var wR=({networkID:t,transaction:e,feePayer:r,connection:o,pendingActivityRows:n,accountIdentifier:i,accountSigner:c,storage:p})=>({accountSigner:c,accountIdentifier:i,transaction:e,feePayer:r,connection:o,opts:{skipPreflight:!0},pendingTransactionInput:{ownerAddress:r.toBase58(),networkID:t,data:{signature:""},type:"swap",display:{summary:n}},storage:p}),Ya=async({callerAddress:t,connection:e,networkID:r,transactions:o,pendingSwapActivityRows:n,accountIdentifier:i,accountSigner:c,storage:p})=>{let u=new Rr.PublicKey(t),l="";for(let[f,g]of o.entries()){let y=Cr(g,"bs58"),w=wR({networkID:r,transaction:y,feePayer:u,connection:e,pendingActivityRows:n[f],accountIdentifier:i,accountSigner:c,storage:p});try{l="",l=await af(w),f!==o.length-1&&await Ss({connection:e,signature:l})}catch(S){return{signature:l??"",error:S instanceof Error?S:new Error("Failed to process solana swap transaction")}}}return{signature:l??""}};s();a();var hR=({networkID:t,transaction:e,feePayer:r,pendingActivityRows:o,accountIdentifier:n,accountSigner:i,storage:c})=>({accountSigner:i,accountIdentifier:n,transaction:e,pendingTransactionInput:{ownerAddress:r,networkID:t,data:{digest:""},type:"swap",display:{summary:o}},storage:c}),Xa=async({callerAddress:t,networkID:e,transactions:r,pendingSwapActivityRows:o,accountIdentifier:n,accountSigner:i,storage:c})=>{let p="";for(let[u,l]of r.entries()){let f=hR({networkID:e,transaction:Zo.deserializeTransactionString(l),feePayer:t,pendingActivityRows:o[u],accountIdentifier:n,accountSigner:i,storage:c});try{p=(await sf(f)).digest,u!==r.length-1&&await gs(e,p)}catch(g){return{signature:p??"",error:g instanceof Error?g:new Error("Failed to process sui swap transaction")}}}return{signature:p??""}};var am=({accountIdentifier:t,networkID:e})=>{let r=re(),o=Jo();return de({mutationFn:async i=>{let{swapTransactions:c,type:p}=i;if(c.type==="evm"&&p==="eip155"){let{gasEstimation:u,pendingApprovalActivityRows:l,pendingSwapActivityRows:f}=i,{signature:g,error:y}=await M.startSpan({name:"Process EVM Swap Txns"},()=>ja({transactions:c.transactions,transactionTypes:c.transactionTypes,networkID:e,gasEstimation:u,pendingSwapActivityRows:f,pendingApprovalActivityRows:l,accountIdentifier:t,accountSigner:o,storage:r}));return{networkID:e,chainType:p,id:g,error:y}}else if(c.type==="solana"&&p==="solana"){let{callerAddress:u,connection:l,pendingSwapActivityRows:f}=i;if(!l)throw new Error("missing connection");let{signature:g,error:y}=await M.startSpan({name:"Process Solana Swap Txns"},()=>Ya({callerAddress:u,connection:l,networkID:e,transactions:c.transactions,pendingSwapActivityRows:f,accountIdentifier:t,accountSigner:o,storage:r}));return{networkID:e,chainType:p,id:g,error:y}}else if(c.type==="sui"&&p==="sui"){let{callerAddress:u,pendingSwapActivityRows:l}=i,{signature:f,error:g}=await M.startSpan({name:"Process Sui Swap Txns"},()=>Xa({callerAddress:u,networkID:e,transactions:c.transactions,pendingSwapActivityRows:l,accountIdentifier:t,accountSigner:o,storage:r}));return{networkID:e,chainType:p,id:f,error:g}}throw new Error("unsupported")}})};s();a();s();a();var kn=D(U());s();a();var Mh=D(U());function _h(){let t=A(n=>n.setUiBuyAmountCryptoInput),e=A(n=>n.setUiBuyAmountLocalFiatInput),r=A(n=>n.primaryCurrency),{fromUsd:o}=Pe();return(0,Mh.useCallback)(({amount:n,decimals:i,usdPrice:c})=>{if(r==="crypto")if(n===void 0)t("");else{let p=ne(n,i).toString(),u=ft(p);t(u)}else if(r==="fiat"&&c)if(n===void 0)e("");else{let p=ne(n,i).toString(),u=_e(Number(p),c),l=o(u);e(l.toString())}},[o,r,e,t])}s();a();var Oh=D(U());function qh(){let t=A(p=>p.setAmountType),e=A(p=>p.setSellAmount),r=A(p=>p.sellAmount),o=A(p=>p.setUiBuyAmountCryptoInput),n=te(),[i,c]=$o(r,e,xn);return(0,Oh.useCallback)(async({fungibleValue:p,shouldUpdateQuote:u,decimals:l})=>{let f=Ut(p.substring(0,vo)),g=ft(f,l);t("buy"),o(g),await n.capture("swapperChangeReceiveCryptoAmount",{data:{amount:g}}),u&&c(g)},[n,t,o,c])}s();a();var Vh=D(U());function Za(t){return(0,Vh.useMemo)(()=>t===void 0?void 0:z(t),[t])}s();a();var ko=D(U());var Gh=()=>{let t=te(),e=A(T=>T.primaryCurrency),r=A(T=>T.sellFungible),o=A(T=>T.buyFungible),n=A(T=>T.uiSellAmountLocalFiatInput),i=A(T=>T.uiBuyAmountLocalFiatInput),c=A(T=>T.amountType),p=A(T=>T.setUiSellAmountCryptoInput),u=A(T=>T.setUiBuyAmountCryptoInput),l=A(T=>T.switchTokensForBuy),f=A(T=>T.switchTokensForSell),{data:g}=rt({query:r?{data:z(r)}:void 0}),{data:y}=rt({query:o?{data:z(o)}:void 0}),{toUsd:w}=Pe(),S=(0,ko.useMemo)(()=>({localFiatValue:n,decimals:r?.data.decimals??0,usdPrice:g?.usd}),[r?.data.decimals,n,g?.usd]),h=(0,ko.useMemo)(()=>({localFiatValue:i,decimals:o?.data.decimals??0,usdPrice:y?.usd}),[o?.data.decimals,y?.usd,i]),b=(0,ko.useCallback)(({localFiatValue:T,decimals:F,usdPrice:C})=>{let B=T?"":yt(0,F);if(C&&T){let q=w(T);B=Tt(Number(q),C,F).toString()}return B},[w]),E=(0,ko.useCallback)(()=>{t.capture("swapperSwitchTokensClicked",{data:{sell:r?J(z(r)):"",buy:o?J(z(o)):""}})},[t,r,o]);return(0,ko.useCallback)(()=>{if(e==="fiat"){let T=b(S);p(T);let F=b(h);u(F)}c==="sell"?f():l(),E()},[c,h,e,S,u,p,l,f,b,E])};var AR={chainId:ee.Solana.Mainnet,slip44:"501",resourceType:"nativeToken"};function cm(){let t=A(B=>B.buyFungible),e=Za(t),r=A(B=>B.sellFungible),o=A(B=>B.primaryCurrency),n=A(B=>B.uiBuyAmountCryptoInput),i=A(B=>B.uiBuyAmountLocalFiatInput),c=A(B=>B.amountType),p=A(B=>B.setAmountType),u=A(B=>B.setSellAmount),l=A(B=>B.uiSellAmountCryptoInput),f=A(B=>B.uiSellAmountLocalFiatInput),g=t?.data.decimals??0,{currentQuote:y}=Z(),w=t?z(t):AR,{data:S}=rt({query:{data:w}}),h=Gh(),b=_h(),E=qh(),{toUsd:T}=Pe();(0,kn.useEffect)(()=>{c==="sell"&&e&&b({amount:y?.buyAmount,decimals:g,usdPrice:S?.usd})},[c,e,y?.buyAmount,g,S?.usd,b]),(0,kn.useEffect)(()=>{if(Re(r?.data.chain.id,t?.data.chain.id)&&c==="buy"){if(p("sell"),o==="crypto")u(l);else if(S?.usd){let B=T(f),q=Tt(B,S.usd,g);u(q.toString())}}},[c,t,g,S,o,r,p,u,T,l,f]);let F=(0,kn.useCallback)(B=>{E({fungibleValue:B,decimals:g,shouldUpdateQuote:!0})},[g,E]),C=(0,kn.useCallback)(()=>{h()},[h]);return{cryptoAmountInputValue:n,handleCryptoAmountInputChange:F,localFiatAmountInputValue:i,handleSwitchTokensClick:C}}s();a();var Rt=D(U());s();a();var TR=3,vR=new H(356190),ER=t=>xe.get(t).averageNetworkFee.times(TR);function ec({sellFungible:t,totalFees:e,transactionSpeedsToUnitCost:r,minRequiredBalance:o,customPriorityFee:n,isBridge:i=!1}){let{decimals:c,amount:p,chain:u}=t.data,l=new H(p),f=Oe(t.type),{source:g,destination:y}=o,S=xR({isNativeToken:f,network:u,totalFees:e,isBridge:i,transactionSpeedsToUnitCost:r,customPriorityFee:n}).plus(y),h=f?IR(l,S,g):l.toString();return Id(h,c)}function xR({isNativeToken:t,network:e,totalFees:r,isBridge:o,transactionSpeedsToUnitCost:n,customPriorityFee:i}){if(!t)return r;let c=xe.get(e.id),p=o?c.bridgeDefaultFee:c.swapDefaultFee,u=n?.standard;return Xd(u)&&(p=vR.multipliedBy(u.maxFeePerGas.plus(u.maxPriorityFeePerGas))),I.isSolanaNetworkID(e.id)&&i&&(p=p.plus(i)),p.plus(ER(e.id))}function IR(t,e,r){let o=r.plus(e);return t.gt(o)?t.minus(o).toString():t.toString()}s();a();var Kh=D(U());function Hh(){let t=A(l=>l.primaryCurrency),e=A(l=>l.setUiSellAmountLocalFiatInput),r=A(l=>l.setUiBuyAmountLocalFiatInput),o=A(l=>l.setAmountType),n=A(l=>l.setPrimaryCurrency),i=A(l=>l.setUiSellAmountCryptoInput),c=A(l=>l.setSellAmount),p=A(l=>l.setUiBuyAmountCryptoInput),{fromUsd:u}=Pe();return(0,Kh.useCallback)(({buyAmountFromQuote:l,buyFungibleDecimals:f,buyFungibleUsdPrice:g,sellAmountFromQuote:y,sellFungibleUsdPrice:w})=>{if(t==="crypto"){if(o("sell"),w&&y){let S=_e(Number(y),w),h=u(S);e(h.toString()),c(y.toString())}if(g&&l){let S=ne(l,f).toString(),h=_e(Number(S),g),b=u(h);r(b.toString())}n("fiat")}if(t==="fiat"){if(y&&i(y),g&&l){let S=ne(l,f).toString();p(S)}n("crypto")}},[u,t,c,o,p,r,n,i,e])}s();a();var $h=D(U());function zh(){let t=A(n=>n.primaryCurrency),e=A(n=>n.setUiSellAmountCryptoInput),r=A(n=>n.setUiSellAmountLocalFiatInput),{fromUsd:o}=Pe();return(0,$h.useCallback)(({amount:n,decimals:i,usdPrice:c})=>{if(t==="crypto")if(n===void 0)e("0");else{let p=ne(n,i).toString();e(p)}else if(t==="fiat"&&c)if(n===void 0)r("0");else{let p=ne(n,i).toString(),u=_e(Number(p),c),l=o(u);r(l.toString())}},[o,t,e,r])}s();a();var Wh=D(U());function jh(){let t=A(c=>c.setAmountType),e=A(c=>c.setUiSellAmountCryptoInput),r=A(c=>c.setSellAmount),o=A(c=>c.sellAmount),[n,i]=$o(o,r,xn);return(0,Wh.useCallback)(({fungibleValue:c,decimals:p,shouldUpdateQuote:u,shouldTrimLength:l=!0})=>{let f=Ut(l?c.substring(0,vo):c),g=ft(f,p);t("sell"),e(g),u&&i(g)},[t,e,i])}s();a();var Yh=D(U());function Xh(){let t=A(p=>p.setAmountType),e=A(p=>p.setSellAmount),r=A(p=>p.sellAmount),o=A(p=>p.setUiSellAmountLocalFiatInput),{toUsd:n}=Pe(),[i,c]=$o(r,e,xn);return(0,Yh.useCallback)(({localFiatValue:p,shouldUpdateQuote:u,decimals:l,priceData:f})=>{let g=Ut(p.substring(0,vo)),y=ft(g,2);if(t("sell"),o(y),u&&f?.usd){let w=n(p),S=Tt(w,f.usd,l);c(S.toString())}},[t,o,c,n])}s();a();var lb=D(U());s();a();var Jh=D(U());var FR={"Allbridge's fee":"destinationNetwork","Allbridge Liquidity Fee":"liquidityProvider"},Zh=()=>{let{currentQuote:t}=Z(),{destinationNetworkFee:e,liquidityFee:r}=(0,Jh.useMemo)(()=>{function o(i){return i?{amount:new V(i.amount??0),amountUsd:i.amountUSD?parseFloat(i.amountUSD):null,pct:parseFloat(i.percentage??"0")}:Hr}let n=new Map([]);return t&&ae(t)&&(n=t.steps.flatMap(i=>i.includedFeeCosts).reduce((i,c)=>{if(!c)return i;let p=FR[c.name];return p&&i.set(p,c),i},n)),{destinationNetworkFee:o(n.get("destinationNetwork")),liquidityFee:o(n.get("liquidityProvider"))}},[t]);return{destinationNetworkFee:e,liquidityFee:r}};s();a();var eb=D(U());var PR={calculate({currentQuote:t,gasEstimationPriceData:e}){return{amount:(t&&e?.gasEstimationAmount)??new V(0),amountUsd:(t&&e?.gasEstimationPriceUSDNumber)??null,pct:0}}},CR={calculate({currentQuote:t,gasEstimationPriceData:e,priceMap:r,networkID:o}){let n=(t?.fees??[]).find(p=>p.type==="network"&&p.name!=="Token account deposits"),i=(t&&e?.gasEstimationAmount)??new V(0),c=(t&&e?.gasEstimationPriceUSDNumber)??null;if(n&&n.amount&&(i=i.plus(new V(n.amount)),c)){let p=Pt(o,new V(n.amount),r);p&&(c+=p)}return{amount:i,amountUsd:c,pct:0}}},RR={calculate({currentQuote:t,gasEstimationPriceData:e,maxGasEstimationPriceData:r}){return{amount:(t&&e?.gasEstimationAmount)??new V(0),amountUsd:(t&&e?.gasEstimationPriceUSDNumber)??null,maxAmount:(t&&r?.gasEstimationAmount)??new V(0),maxAmountUsd:(t&&r?.gasEstimationPriceUSDNumber)??null,pct:0}}},tb=({priceMap:t})=>{let{currentQuote:e}=Z(),r=A(l=>l.sellFungible),o=A(l=>l.gasEstimation),n=r?.data.chain.id??ee.Solana.Mainnet,{data:i,isLoading:c}=Yn(n,Li(o.estimate)),{data:p}=Yn(n,Li(o.estimateWithBuffer));return{networkFee:(0,eb.useMemo)(()=>I.isEVMNetworkID(n)?RR.calculate({currentQuote:e,gasEstimationPriceData:i,maxGasEstimationPriceData:p}):I.isSolanaNetworkID(n)?CR.calculate({currentQuote:e,gasEstimationPriceData:i,networkID:n,priceMap:t}):PR.calculate({currentQuote:e,gasEstimationPriceData:i}),[e,i,p,n,t]),isFetchingGasEstimationPrice:c}};s();a();var rb=D(U());var kR={calculate(){return Hr}},DR={calculate({currentQuote:t,networkID:e,priceMap:r}){let o=Ga(t);return{amount:o,amountUsd:Pt(e,o,r),pct:0}}},ob=({priceMap:t})=>{let{currentQuote:e}=Z(),o=A(i=>i.sellFungible)?.data.chain.id??ee.Solana.Mainnet;return{nonIncludedFees:(0,rb.useMemo)(()=>e&&ae(e)?DR.calculate({currentQuote:e,networkID:o,priceMap:t}):kR.calculate(),[o,e,t])}};s();a();var nb=D(U());var NR={calculate(t){let e=(t?.fees??[]).find(r=>r.type==="phantom");return{amount:new V(e?.amount??0),amountUsd:null,pct:e?.percentage??0}}},BR={calculate(t){let e=t.steps.flatMap(r=>r.feeCosts).find(r=>r.name==="phantom");return{amount:new V(e?.amount??0),amountUsd:null,pct:parseFloat(e?.percentage??"0")}}},ib=()=>{let{currentQuote:t}=Z();return{phantomFee:(0,nb.useMemo)(()=>pm(t),[t])}};function pm(t){return Ht(t)?NR.calculate(t):ae(t)?BR.calculate(t):Hr}s();a();var sb=D(U());var QR={calculate({currentQuote:t,networkID:e,priceMap:r}){let o=(t?.fees??[]).find(n=>n.name==="Token account deposits");return{amount:new V(o?.amount??0),amountUsd:o?.amount?Pt(e,new V(o.amount),r):null,pct:o?.percentage??0}}},LR={calculate(){return Hr}},ab=({priceMap:t})=>{let{currentQuote:e}=Z(),o=A(i=>i.sellFungible)?.data.chain.id??ee.Solana.Mainnet;return{tokenAccountFee:(0,sb.useMemo)(()=>Ht(e)?QR.calculate({currentQuote:e,networkID:o,priceMap:t}):LR.calculate(),[e,o,t])}};s();a();var cb=D(U());var pb={calculate:({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,networkID:o,priceMap:n})=>{let i=t.amount.plus(e.amount).plus(r.amount);return{amount:i,amountUsd:Pt(o,i,n),pct:0}}},UR={calculate:({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,networkID:o,priceMap:n})=>{let i=pb.calculate({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,networkID:o,priceMap:n}),c=t.amount.plus(e.maxAmount??0).plus(r.amount);return{...i,maxAmount:c,maxAmountUsd:Pt(o,c,n)}}},ub=({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,priceMap:o})=>{let i=A(p=>p.sellFungible)?.data.chain.id??ee.Solana.Mainnet;return{totalFees:(0,cb.useMemo)(()=>I.isEVMNetworkID(i)?UR.calculate({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,networkID:i,priceMap:o}):pb.calculate({tokenAccountFee:t,networkFee:e,nonIncludedFees:r,networkID:i,priceMap:o}),[e,i,r,o,t])}};var Ct=()=>{let t=A(y=>y.gasEstimation.isFetching),e=$r(),{data:r={}}=_t({query:{data:e.map(y=>gt(y))}}),{networkFee:o,isFetchingGasEstimationPrice:n}=tb({priceMap:r}),i=t||n,{phantomFee:c}=ib(),{tokenAccountFee:p}=ab({priceMap:r}),{nonIncludedFees:u}=ob({priceMap:r}),{totalFees:l}=ub({tokenAccountFee:p,networkFee:o,nonIncludedFees:u,priceMap:r}),{destinationNetworkFee:f,liquidityFee:g}=Zh();return(0,lb.useMemo)(()=>({phantomFee:c,networkFee:o,tokenAccountFee:p,totalFees:l,nonIncludedFees:u,destinationNetworkFee:f,liquidityFee:g,isFetchingFees:i}),[c,o,p,l,u,f,g,i])};s();a();var MR=20;function tc(t,e){let r=le.optimisticUpdates(),o=t.getQueryData(r)??[];t.setQueryData(r,[...o.filter(n=>n.id!==e.id),e])}function mb(t,e){let r=le.optimisticUpdates(),o=t.getQueryState(r);if(o){let n=e??Date.now(),i=o.dataUpdatedAt,c=X({seconds:MR});return n-i>c?(t.removeQueries({queryKey:r}),[]):o?.data??[]}else return[]}function Dn(t){return`${t.type}-${t.data.key}`}s();a();var um=D(U());var _R=.05,OR=({sellNetworkId:t,buyNetworkId:e,destinationMinRequiredBalance:r,priceMap:o})=>{if(!t||!e||!o)return new V(0);let n=J(gt(I.getChainID(t))),i=J(gt(I.getChainID(e))),c=o[n]?.usd,p=o[i]?.usd;if(!c||!p)return new V(0);let u=ne(r.toNumber(),I.getTokenDecimals(e)),l=_e(u.toNumber(),p),f=Tt(l,c,I.getTokenDecimals(t));return new V(f).times(1+_R)},Nn=()=>{let t=qa(),e=jr(),r=A(h=>h.sellFungible)??e,o=A(h=>h.buyFungible)??t,n=r.data.chain.id,i=o?.data.chain.id,c=i??n,p=Re(n,i),{fungible:u}=or({key:o?.data.key}),{data:l}=ue(),f=(0,um.useMemo)(()=>l?.addresses.find(h=>h.networkID===c),[l,c]),y=$r().map(h=>gt(h)),{data:w}=_t({query:{data:y},queryOptions:{refetchInterval:!1}}),{data:S=0}=bs(f);return(0,um.useMemo)(()=>{if(u)return new V(0);let h=new V(S);return p?OR({sellNetworkId:n,buyNetworkId:i,destinationMinRequiredBalance:h,priceMap:w}):h},[u,S,p,n,i,w])};s();a();var lm=D(U());var Bn=()=>{let t=jr(),r=(A(c=>c.sellFungible)??t).data.chain.id,{data:o}=ue(),n=(0,lm.useMemo)(()=>o?.addresses.find(c=>c.networkID===r),[o,r]),{data:i=0}=bs(n);return(0,lm.useMemo)(()=>new V(i),[i])};function mm(){let t=j(),e=jr(),r=A(ie=>ie.sellFungible)??e,o=A(ie=>ie.buyFungible),n=A(ie=>ie.primaryCurrency),i=A(ie=>ie.isFetchingQuote),c=A(ie=>ie.sellAmount),p=A(ie=>ie.uiSellAmountCryptoInput),u=A(ie=>ie.setSellFungible),l=A(ie=>ie.uiSellAmountLocalFiatInput),f=A(ie=>ie.amountType),g=A(ie=>ie.setSwapFilter),{data:y}=vr(),w=Za(r),S=r?.data.key,{fungible:h}=or({key:S}),b=r?.data.chain.id,E=o?.data.chain.id,{totalFees:T}=Ct(),{data:F}=ws({networkID:b}),C=Re(b,E),B=Bn(),q=Nn(),L=r?.data.amount,K=r?r.data.decimals:0,G=(0,Rt.useMemo)(()=>ec({sellFungible:r,totalFees:T.amount,transactionSpeedsToUnitCost:I.isEVMNetworkID(r.data.chain.id)?F:void 0,isBridge:C,minRequiredBalance:{source:B,destination:q},customPriorityFee:new V(y??0).multipliedBy(10**Rd.tokenDecimals)}),[r,T.amount,F,C,q,B,y]),v=(0,Rt.useMemo)(()=>f==="buy"?new V(p).isLessThanOrEqualTo(new V(G)):c===""?!0:new V(c).isLessThanOrEqualTo(new V(G)),[f,G,c,p]),{currentQuote:x}=Z(),{data:P}=rt({query:{data:z(r)}}),Q=P?.usd,{data:_}=rt({query:o?{data:z(o)}:void 0}),R=Hh(),O=jh(),$=Xh(),N=zh(),ce=(0,Rt.useCallback)(()=>{let ie=x?.sellAmount?ne(x?.sellAmount,K).toString():c,We=x?.buyAmount,Bt=o?.data.decimals??0,io=_?.usd;R({buyAmountFromQuote:We,buyFungibleDecimals:Bt,buyFungibleUsdPrice:io,sellAmountFromQuote:ie,sellFungibleUsdPrice:Q})},[x?.sellAmount,x?.buyAmount,K,c,o?.data.decimals,_?.usd,R,Q]),pe=(0,Rt.useCallback)(ie=>{O({fungibleValue:ie,decimals:K,shouldUpdateQuote:!0})},[K,O]),ke=(0,Rt.useCallback)(ie=>{$({priceData:P,localFiatValue:ie,decimals:K,shouldUpdateQuote:!0})},[K,P,$]),{fromUsd:Ae}=Pe(),Vo=(0,Rt.useCallback)(ie=>{g(ie);let We=V(G).multipliedBy(ie);if(n==="crypto")O({fungibleValue:We.toString(),decimals:K,shouldUpdateQuote:!0,shouldTrimLength:!1});else if(Q){let Bt=_e(Number(We),Q),io=Ae(Bt).toString();$({priceData:P,localFiatValue:io,decimals:K,shouldUpdateQuote:!0})}},[g,G,n,Q,O,K,$,P,Ae]);(0,Rt.useEffect)(()=>{let ie=mb(t);if(h){let We={...h},Bt=ie.find(io=>io.id===Dn(h));Bt&&h.data.amount!==Bt.amount&&(We.data={...We.data,amount:Bt.amount}),We.data.amount!==L&&u(We)}},[h,L,u,t]),(0,Rt.useEffect)(()=>{f==="buy"&&w&&N({amount:x?.sellAmount,decimals:K,usdPrice:Q})},[f,x?.sellAmount,K,P?.usd,w,Q,N]);let Ue=Rn();return{maxSellAmount:G,sellFungible:r,notEnoughAssets:!v,uiSellAmountCryptoInput:p,uiSellAmountLocalFiatInput:l,hasMinimumSellAmount:Ue,isFetchingQuote:i,handleToggleCurrencyClick:ce,handleFiatAmountInputChange:ke,handleCryptoAmountInputChange:pe,handleSwapFilterClick:Vo}}s();a();s();a();s();a();s();a();function dm(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function qR(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function db(t,...e){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new TypeError(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function VR(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");dm(t.outputLen),dm(t.blockLen)}function GR(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function KR(t,e){db(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var HR={number:dm,bool:qR,bytes:db,hash:VR,exists:GR,output:KR},rc=HR;s();a();s();a();var $R={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var nc=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),kt=(t,e)=>t<<32-e|t>>>e,zR=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!zR)throw new Error("Non little-endian hardware is not supported");var WR=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function fb(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=WR[t[r]];return e}function fm(t){if(typeof t!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof t}`);return new TextEncoder().encode(t)}function gm(t){if(typeof t=="string"&&(t=fm(t)),!(t instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof t})`);return t}var oc=class{clone(){return this._cloneInto()}};function ym(t){let e=o=>t().update(gm(o)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function jR(t,e,r,o){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,o);let n=BigInt(32),i=BigInt(4294967295),c=Number(r>>n&i),p=Number(r&i),u=o?4:0,l=o?0:4;t.setUint32(e+u,c,o),t.setUint32(e+l,p,o)}var ic=class extends oc{constructor(e,r,o,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=o,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=nc(this.buffer)}update(e){rc.exists(this);let{view:r,buffer:o,blockLen:n}=this;e=gm(e);let i=e.length;for(let c=0;c<i;){let p=Math.min(n-this.pos,i-c);if(p===n){let u=nc(e);for(;n<=i-c;c+=n)this.process(u,c);continue}o.set(e.subarray(c,c+p),this.pos),this.pos+=p,c+=p,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){rc.exists(this),rc.output(e,this),this.finished=!0;let{buffer:r,view:o,blockLen:n,isLE:i}=this,{pos:c}=this;r[c++]=128,this.buffer.subarray(c).fill(0),this.padOffset>n-c&&(this.process(o,0),c=0);for(let g=c;g<n;g++)r[g]=0;jR(o,n-8,BigInt(this.length*8),i),this.process(o,0);let p=nc(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=u/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<l;g++)p.setUint32(4*g,f[g],i)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let o=e.slice(0,r);return this.destroy(),o}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:o,length:n,finished:i,destroyed:c,pos:p}=this;return e.length=n,e.pos=p,e.finished=i,e.destroyed=c,n%r&&e.buffer.set(o),e}};var YR=(t,e,r)=>t&e^~t&r,XR=(t,e,r)=>t&e^t&r^e&r,JR=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Xr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Jr=new Uint32Array(64),sc=class extends ic{constructor(){super(64,32,8,!1),this.A=Xr[0]|0,this.B=Xr[1]|0,this.C=Xr[2]|0,this.D=Xr[3]|0,this.E=Xr[4]|0,this.F=Xr[5]|0,this.G=Xr[6]|0,this.H=Xr[7]|0}get(){let{A:e,B:r,C:o,D:n,E:i,F:c,G:p,H:u}=this;return[e,r,o,n,i,c,p,u]}set(e,r,o,n,i,c,p,u){this.A=e|0,this.B=r|0,this.C=o|0,this.D=n|0,this.E=i|0,this.F=c|0,this.G=p|0,this.H=u|0}process(e,r){for(let g=0;g<16;g++,r+=4)Jr[g]=e.getUint32(r,!1);for(let g=16;g<64;g++){let y=Jr[g-15],w=Jr[g-2],S=kt(y,7)^kt(y,18)^y>>>3,h=kt(w,17)^kt(w,19)^w>>>10;Jr[g]=h+Jr[g-7]+S+Jr[g-16]|0}let{A:o,B:n,C:i,D:c,E:p,F:u,G:l,H:f}=this;for(let g=0;g<64;g++){let y=kt(p,6)^kt(p,11)^kt(p,25),w=f+y+YR(p,u,l)+JR[g]+Jr[g]|0,h=(kt(o,2)^kt(o,13)^kt(o,22))+XR(o,n,i)|0;f=l,l=u,u=p,p=c+w|0,c=i,i=n,n=o,o=w+h|0}o=o+this.A|0,n=n+this.B|0,i=i+this.C|0,c=c+this.D|0,p=p+this.E|0,u=u+this.F|0,l=l+this.G|0,f=f+this.H|0,this.set(o,n,i,c,p,u,l,f)}roundClean(){Jr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Sm=class extends sc{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}},gb=ym(()=>new sc),xce=ym(()=>new Sm);var At=D(U());s();a();var ZR=50,yb=({includeOwnedAssets:t,sellAsset:e,ownedAssets:r,searchAssets:o})=>{if(!t||!e)return o;let n=g=>J(z(g)),i=n(e),c=e.data.chain.id,p=r.filter(g=>n(g)!==i&&I.compareNetworkID(c,g.data.chain.id)===0&&g.type!=="CompressedSPL").slice(0,ZR-1),u=p.map(g=>[n(g),g]),l=new Map(u),f=o.filter(g=>!l.has(n(g)));return[...p,...f]};function ek({enableQuery:t=!0,chainFilter:e}={}){let{sellFungible:r,searchQuery:o,setSearchQuery:n,setNumSearchResults:i}=A(),c=Td(o,150),{fungibles:p,isLoadingTokens:u,isRefetchingTokens:l,tokensError:f}=vt(),g=Eo(),[y,w]=(0,At.useState)(""),{data:S}=ue(),h=(0,At.useMemo)(()=>S?.addresses??[],[S]),{data:b,isSuccess:E,isFetching:T,error:F}=wo({query:c,networkIds:e?[e]:[r?.data.chain.id??I.solana.mainnetID],enableQuery:t,keepPreviousData:!0,searchContext:"swapper",supportedNetworkIds:g,chainAddresses:h}),C=!E&&T,B=(0,At.useMemo)(()=>p.filter(x=>x.type!=="CompressedSPL").map(x=>[J(z(x)),x]),[p]),q=(0,At.useMemo)(()=>{let x=fm(B.map(([Q])=>Q).join("~")),P=gb(x);return fb(P)},[B]),L=(0,At.useMemo)(()=>new Map(B),[q]),K=(0,At.useMemo)(()=>{if(!b||b.length===0)return[];w(pt());let x=b.reduce((P,Q)=>{let _="";if(Oe(Q.type)){if(r&&Oe(r.type)&&Q.data.chain.id===r.data.chain.id)return P;_=J(gt(I.getChainID(Q.data.chain.id)))}else{if(r&&Q.data.tokenAddress===r.data.tokenAddress)return P;_=J(z(Q))}let R,O=L.get(_);return O&&O.data.balance?R=O:R=Q,R&&P.push(R),P},[]);return i(x.length),x},[L,b,r,i]),G=te();(0,At.useEffect)(()=>{E&&K.length===0&&G.capture("swapperNullSearchResult",{data:{searchQuery:c}})},[E,K,c,G]);let v=(0,At.useMemo)(()=>yb({includeOwnedAssets:!c,sellAsset:r,ownedAssets:p,searchAssets:K}),[c,p,K,r]);return(0,At.useMemo)(()=>({assets:v,initialFilterKey:r?.data.chain.id,isLoading:u||C,isFetching:u||C||l,error:f??F,searchRef:y,setSearchQuery:n}),[v,u,C,l,f,F,r,y,n])}s();a();var He=D(U()),wb=D(Qi());s();a();var ac="https://help.phantom.com/hc/en-us/articles/27085326202515";var Qn=[.3,.5,1],tk=Qn.map(t=>`${t}%`),hb=[...tk,"custom"],Ln=[.5,1,2],rk=Ln.map(t=>`${t}%`),ok=[...rk,"custom"],nk="enable-higher-slippage-options",wm=hb.length-1,ik=5,sk=2,hm=.1,bm=30,ak=2,Sb=(t,e)=>{if(!t)return;let r=parseFloat(t);if(isNaN(r))return{message:e("swapSlippageSettingsCustomInvalidValue"),severity:"critical"};if(r>bm)return{message:e("swapSlippageSettingsCustomMaxError",{maxSlippage:bm}),severity:"critical"};if(r>ak)return{message:e("swapSlippageSettingsHighSlippageWarning"),severity:"warning"};if(r<hm)return{message:e("swapSlippageSettingsCustomMinError",{minSlippage:hm}),severity:"critical"}},ck=(t,e)=>e?t&&Ln.indexOf(t)!==-1?Ln.indexOf(t):t?wm:1:t&&Qn.indexOf(t)!==-1?Qn.indexOf(t):t?wm:0,pk=(t,e)=>e?t&&Ln.indexOf(t)===-1?`${t}`:"":t&&Qn.indexOf(t)===-1?`${t}`:"",uk=({onDismiss:t})=>{let{t:e}=tt(),r=te(),{data:[o]}=me([nk]),{data:n,isFetched:i}=Yr(),{mutateAsync:c}=Va(),{selectedSetting:p,isFetched:u,setSlippageSetting:l}=ve(),[f,g]=(0,He.useState)(p.type),y=(0,wb.default)(u),[w,S]=(0,He.useState)(!1),[h,b]=(0,He.useState)(0),[E,T]=(0,He.useState)(),[F,C]=(0,He.useState)(""),[B,q]=(0,He.useState)(),L=f==="auto",K=h===wm,G=L?!1:B?.severity==="critical"||K&&!F;(0,He.useEffect)(()=>{y!==u&&f!==p.type&&g(p.type)},[y,u,p.type,f]);let v=(0,He.useCallback)(O=>{if(h===O)return;q(void 0),b(O);let $=o?Ln:Qn;$[O]?(T($[O]),C("")):T(void 0)},[h,o]),x=(0,He.useCallback)(O=>{let $=Ut(O.substring(0,ik)),N=ft($,sk),ce=parseFloat(N);if(isNaN(ce)){q(void 0),C("");return}C(N),q(Sb(N,e))},[e]),P=(0,He.useCallback)(()=>{if(L)r.capture("slippageChanged",{data:{slippageType:"auto"}});else if(K){let O=parseFloat(F??"");c(O),r.capture("slippageChanged",{data:{slippageValue:O,slippageType:"custom"}}),T(void 0)}else E&&(c(E),r.capture("slippageChanged",{data:{slippageValue:E,slippageType:"preset"}}),C(""));l({type:f}),t()},[L,l,f,t,K,E,F,c,r]),Q=(0,He.useCallback)(()=>{let O=ck(n,o),$=pk(n,o),N=o?Ln:Qn;b(O),T(N[O]),C($),q(Sb($,e)),g(p.type)},[n,e,p.type,o]),_=(0,He.useCallback)(()=>{g(f==="auto"?"fixed":"auto")},[f,g]),R=(0,He.useMemo)(()=>({title:e("swapSlippageSettingsTitle"),subtitle:e("swapSlippageSettingsSubtitle",{minSlippage:hm,maxSlippage:bm}),custom:e("swapSlippageSettingsCustom"),auto:e("swapSlippageSettingsAuto"),autoSubtitle:e("swapSlippageSettingsAutoSubtitle"),learnMore:e("commandLearnMore"),button:e("commandConfirm")}),[e]);return(0,He.useEffect)(()=>{!w&&i&&(Q(),S(!0))},[i,w,Q]),{options:o?ok:hb,selectedIndex:h,customSlippageValue:F,i18nStrings:R,error:B,submitDisabled:G,isAutoEnabled:L,autoLearnMoreUrl:ac,onConfirm:P,onDismiss:t,onSelectOption:v,onChangeCustomSlippage:x,onResetToDefault:Q,onToggleAutoSlippage:_}};s();a();var Le=D(U()),Tb=D(Qi());s();a();var bb=D(U());var lk={type:"auto"},Am=()=>{let{priorityFeeSetting:t,isFetched:e,save:r}=mk();return{isFetched:e,selectedSetting:t,setPriorityFeeSetting:r}},mk=()=>{let{data:t,isFetched:e}=Xe({key:"priorityFeeSettings",queryKey:le.priorityFeeSettings()}),{mutateAsync:r}=st({key:"priorityFeeSettings",queryKey:le.priorityFeeSettings()}),o=(0,bb.useCallback)(async n=>{await r(n)},[r]);return{isFetched:e,priorityFeeSetting:t??lk,save:o}};var Tm={input:{maxLength:10,maxDecimals:6},bounds:{min:1e-6,low:5e-6,high:1,max:5}},Ab=(t,e,r)=>{let o=parseFloat(t);if(isNaN(o))return{message:e("swapPriorityFeeSettingsCustomInvalidValue"),severity:"critical"};if(o>r.max)return{message:e("swapPriorityFeeSettingsCustomMaxError",{maxPriorityFee:r.max}),severity:"critical"};if(o<r.min)return{message:e("swapPriorityFeeSettingsCustomMinError",{minPriorityFee:r.min}),severity:"critical"};if(o>r.high)return{message:e("swapPriorityFeeSettingsHighFeeWarning"),severity:"warning"};if(o<r.low)return{message:e("swapPriorityFeeSettingsLowFeeWarning"),severity:"warning"}},fk=()=>{let[t,e]=(0,Le.useState)(Tm.bounds);return(0,Le.useEffect)(()=>{(async()=>{try{let o=await Zd({accounts:[],transactionType:"Swap"});e({min:o.min,low:o.low,high:o.high,max:o.max})}catch(o){M.captureError(o instanceof Error?o:new Error("Unable to fetch priority fee bounds."),"swapper")}})()},[]),t},gk=({onDismiss:t})=>{let{t:e}=tt(),r=te(),{data:o,isFetched:n}=vr(),{mutateAsync:i}=Fh(),{selectedSetting:c,isFetched:p,setPriorityFeeSetting:u}=Am(),[l,f]=(0,Le.useState)(c.type),g=(0,Tb.default)(p),[y,w]=(0,Le.useState)(!1),[S,h]=(0,Le.useState)(""),[b,E]=(0,Le.useState)("$0"),[T,F]=(0,Le.useState)(),C=l==="auto",B=C?!1:T?.severity==="critical"||!S,q=fk(),L=gt("solana"),{data:K}=rt({query:{data:L}}),G=K?.usd;(0,Le.useEffect)(()=>{if(!G)return;let R=_e(Number(S),G);E(`$${R.toString()}`)},[S,G]),(0,Le.useEffect)(()=>{g!==p&&l!==c.type&&f(c.type)},[g,p,c.type,l]);let v=(0,Le.useCallback)(R=>{let O=Ut(R.substring(0,Tm.input.maxLength)),$=ft(O,Tm.input.maxDecimals);if(isNaN(parseFloat($))){F(void 0),h("");return}h($),F(Ab($,e,q))},[e,q]),x=(0,Le.useCallback)(()=>{if(C)i(null),M.addBreadcrumb("swapper","Priority fee setting changed to auto.","info"),r.capture("swapperPriorityFeeChanged",{data:{priorityFeeType:"auto"}});else if(S){let R=parseFloat(S??"");i(R),M.addBreadcrumb("swapper",`Priority fee setting changed to custom: ${R} SOL`,"info"),r.capture("swapperPriorityFeeChanged",{data:{priorityFeeValue:R,priorityFeeType:"custom"}}),h("")}u({type:l}),t()},[C,u,l,t,S,i,r]),P=(0,Le.useCallback)(()=>{let R=o?`${o}`:"";h(R),F(Ab(R,e,q)),f(c.type)},[o,e,c.type,q]),Q=(0,Le.useCallback)(()=>{f(l==="auto"?"fixed":"auto"),h("")},[l,f]),_=(0,Le.useMemo)(()=>({title:e("swapPriorityFeeSettingsTitle"),custom:e("swapPriorityFeeSettingsCustom"),auto:e("swapPriorityFeeSettingsAuto"),autoSubtitle:e("swapPriorityFeeSettingsAutoSubtitle"),learnMore:e("commandLearnMore"),button:e("commandConfirm")}),[e]);return(0,Le.useEffect)(()=>{!y&&n&&(P(),w(!0))},[n,y,P]),{customPriorityFeeValue:S,customPriorityFeeValueInDollars:b,i18nStrings:_,error:T,submitDisabled:B,isAutoEnabled:C,onConfirm:x,onDismiss:t,onChangeCustomPriorityFee:v,onResetToDefault:P,onToggleAutoPriorityFee:Q}};s();a();var Do=D(U());s();a();s();a();var vb=()=>[{chainId:"solana:101",address:"2b1kV6DkPAnxd5ixfnxCpjxmKwqjjaYmCZfHsFu24GXo",resourceType:"address"}];var Eb=(t,e)=>{let r=[];if(Sk(t)&&!wk(t)&&r.push({level:"warn",titleKey:"swapAssetWarningPermanentDelegate"}),(t.data.spamStatus==="NOT_VERIFIED"||t.data.spamStatus==="SPAM"||t.data.spamStatus==="POSSIBLE_SPAM")&&r.push({level:"info",titleKey:"swapAssetWarningUnverified"}),!Oe(t.type)&&e&&hk(e)){let o=xe.get(t.data.chain.id).nativeFungible;r.push({level:"info",titleKey:"swapAssetWarningLowTokenBalance",options:{token:o.data.symbol??"",network:o.data.chain.name}})}return r};function Sk(t){let e=t.data;return e?.mintExtensions?e.mintExtensions.some(r=>r.extension==="permanentDelegate"):!1}function wk(t){let e=z(t),r=vb();return e.resourceType==="address"?r.some(o=>o.resourceType===e.resourceType&&o.address===e.address&&o.chainId===e.chainId):!1}function hk(t){let e=xe.get(t.data.chain.id);return new V(t.data.amount?t.data.amount:0).lt(e.swapDefaultFee)}s();a();var Ib=D(U());s();a();function xb(){return[new Im,new vm,new xm,new Em]}var vm=class{isEditable({sellAsset:e}){return!!e&&I.isSolanaNetworkID(e.data.chain.id)}},Em=class{isEditable({currencyDenomination:e}){return e==="crypto"}},xm=class{isEditable({sellAsset:e,buyAsset:r}){return!Re(e?.data.chain.id,r?.data.chain.id)}},Im=class{isEditable(){return Ne.isFeatureEnabled("enable-swapper-exact-out")}};var Fm=({sellAsset:t,buyAsset:e,currencyDenomination:r})=>{let o=(0,Ib.useMemo)(()=>xb(),[]);return e?o.every(n=>n.isEditable({sellAsset:t,buyAsset:e,currencyDenomination:r})):!1};s();a();var Pb=D(U());s();a();var Pm=class{isSupported(e,r,o,n,i){switch(e){case"sell":return!!(o&&i);case"buy":return!1}}},Cm=class{isSupported(e){return e!=="buy"}};function Fb(){return[new Pm,new Cm]}var cc=(t,e,r,o,n)=>(0,Pb.useMemo)(()=>Fb(),[]).every(c=>c.isSupported(t,e,r,o,n));s();a();var Rm=class{format(e,r){return`${yt(e)} ${r}`}},km=class{format(e,r){return`${os(e,{compact:!0})} ${r}`}},Dm=class{format(e){return os(e,{compact:!0})}};function Qm(t){switch(t){case"full":return new Rm;case"compact":return new km;case"compactNoSymbol":return new Dm}}var Nm=class{format(e,r,o){return`${yt(Tt(Number(e),o,r.data?.decimals??0))} ${r.data.symbol??""}`}},pc=class{format(e,r,o){return os(Tt(Number(e),o,r.data?.decimals??0),{compact:!0})}},Bm=class{noSymbolDisplayStrategy;constructor(e){this.noSymbolDisplayStrategy=e}format(e,r,o){return`${this.noSymbolDisplayStrategy.format(e,r,o)} ${r.data?.symbol??""}`}};function Lm(t){switch(t){case"full":return new Nm;case"compact":return new Bm(new pc);case"compactNoSymbol":return new pc}}var bk=$e?[.25,.5,1]:[.5,1],Cb=$e?Qm("full"):Qm("compactNoSymbol"),Rb=$e?Lm("full"):Lm("compact"),Ak={chainId:ee.Solana.Mainnet,slip44:"501",resourceType:"nativeToken"},Tk=()=>{let e=A(Ue=>Ue.amountType)==="sell"?"sell":"buy",r=A(Ue=>Ue.primaryCurrency),{currencySymbol:o,toUsd:n}=Pe(),i=r==="fiat"?o:void 0,c=A(Ue=>Ue.swapFilter),p=A(Ue=>Ue.setSwapFilter),u=_d(),{handleCryptoAmountInputChange:l,handleFiatAmountInputChange:f,sellFungible:g,uiSellAmountCryptoInput:y,isFetchingQuote:w,notEnoughAssets:S,hasMinimumSellAmount:h,handleToggleCurrencyClick:b,uiSellAmountLocalFiatInput:E,handleSwapFilterClick:T,maxSellAmount:F}=mm(),C=A(Ue=>Ue.buyFungible),B=C?z(C):Ak,q=Nb(B),L=Nb(z(g)),K=cc("sell",g,L,C,q),G=(0,Do.useMemo)(()=>({fungible:g,amount:r==="crypto"?y:E,secondaryCryptoSubtitle:r==="fiat"?kb(n(E),g,Rb,L):void 0,balance:Db(g,Cb,u,F),isAmountLoading:w&&e!=="sell",isSecondaryCryptoSubtitleLoading:w,isWarning:S||!h,isAmountEditable:!0,supportsCurrencyDenominationSwitching:K,amountPrefix:i,filters:bk,selectedFilter:c,warnings:[],usdAmount:L?_e(Number(y),L):0}),[g,r,y,E,L,u,F,w,e,S,h,K,i,c,n]),{handleSwitchTokensClick:v,cryptoAmountInputValue:x,localFiatAmountInputValue:P,handleCryptoAmountInputChange:Q}=cm(),_=cc("buy",g,L,C,q),R=Fm({sellAsset:g,buyAsset:C,currencyDenomination:r}),O=Re(g?.data.chain.id,C?.data.chain.id),$=C?.data.chain.id,{fungible:N}=or({key:$?hs($,void 0):void 0}),ce=(0,Do.useMemo)(()=>{if(C)return{fungible:C,perspective:"buy",balance:Db(C,Cb,u),amount:r==="crypto"?x:P,secondaryCryptoSubtitle:r==="fiat"?kb(n(P),C,Rb,q):void 0,isAmountLoading:w&&e!=="buy",isSecondaryCryptoSubtitleLoading:w,isWarning:!1,isAmountEditable:R,supportsCurrencyDenominationSwitching:_,amountPrefix:i,filters:[],selectedFilter:void 0,warnings:Eb(C,O?N:void 0),usdAmount:q?_e(Number(x),q):0}},[C,u,r,x,P,q,w,e,R,_,i,n,O,N]),pe=(0,Do.useCallback)((Ue,ie)=>{switch(p(void 0),Ue){case"sell":r==="crypto"?l(ie):f(ie);break;case"buy":if(r==="fiat")return;Q(ie);break}},[p,r,l,f,Q]),ke=te(),Ae=(0,Do.useCallback)(async()=>{e==="sell"&&(b(),await ke.capture("swapperToggleQuoteCurrency",{data:{value:r==="fiat"?"native":"fiat"}}))},[e,ke,r,b]),Vo=(0,Do.useCallback)((Ue,ie)=>{ie==="sell"&&T(Ue)},[T]);return{switchPerspective:v,sell:G,buy:ce,setAmount:pe,switchCurrencyDenomination:Ae,setFilter:Vo,currencyDenomination:r}};function kb(t,e,r,o){let n=e.data?.symbol??"",i=Number(t);return o?r.format(i,e,o):`0 ${n}`}function Db(t,e,r,o){let n=o?V(o):t.data?.balance;if(!(!n||r))return e.format(n,t.data?.symbol??"")}var Nb=t=>{let{data:e}=rt({query:{data:t}});return e?.usd};s();a();var vk=["lastSubmittedPairs","slippageTolerance"],Um=t=>{let e=String(t.queryKey[1]);return vk.includes(e)};s();a();var Bb=D(U());function Mm(t){let{t:e}=tt();return(0,Bb.useMemo)(()=>{let{networkFee:r,phantomFee:o,tokenAccountFee:n,nonIncludedFees:i,destinationNetworkFee:c,liquidityFee:p}=t;return{networkFee:{label:e("swapQuoteNetwork"),valueUsd:r.amountUsd,maxValueUsd:r.maxAmountUsd},bridgeFee:{label:e("swapQuoteBridgeFee"),valueUsd:i.amountUsd,maxValueUsd:i.maxAmountUsd},tokenAccountFee:{label:e("swapQuoteOneTimeTokenAccount"),valueUsd:n.amountUsd},phantomFeePercent:{label:o.pct?e("swapQuoteFeeDisclaimer",{feePercentage:Ed(o.pct)}):"",value:o.pct?`${o.pct}`:""},destinationNetworkFee:{label:e("swapQuoteDestinationNetwork"),valueUsd:c.amountUsd},liquidityProviderFee:{label:e("swapQuoteLiquidityProvider"),valueUsd:p.amountUsd}}},[t,e])}s();a();var Qb=D(U());function Ek(){let t=te(),e=A(g=>g.buyFungible),r=A(g=>g.sellFungible),o=A(g=>g.setBuyFungible),n=A(g=>g.setSellFungible),i=A(g=>g.setSellAmount),c=A(g=>g.setUiSellAmountCryptoInput),p=A(g=>g.resetQuote),u=A(g=>g.setSwapFilter),l=r?.data.amount,{cancelQuotes:f}=$a();return(0,Qb.useCallback)(async g=>{if(r&&Co(g,r)){g&&g.data.amount!==l&&(n(g),u(void 0));return}await f();let y=za(g);t.capture("swapperUpdateFromAsset",{data:y}),n(g),u(void 0),e&&r&&Co(g,e)&&o(r),g&&r?.data.chain.id!==g.data.chain.id&&(p(),o(void 0),i(""),c(""))},[t,e,f,l,p,r,o,i,n,u,c])}s();a();var qb=D(U());s();a();var Zr=D(U());s();a();s();a();s();a();var uc=class{sections(e){let r=xr().map(i=>i.programId),o=e.reduce((i,c)=>{if(c.data.spamStatus==="VERIFIED")return i.verified.push(c),i;if(c.type!=="SPL"||!c.data.ugcTokenMeta||c.data.ugcTokenMeta.status==="graduated"||!r.includes(c.data.ugcTokenMeta.programId))return i.unverified.push(c),i;let p=c.data.ugcTokenMeta.programId,u=i[p]??[];return u.push(c),i[p]=u,i},{verified:[],unverified:[]}),n=xr().map(i=>{let c=o[i.programId]??[];return{id:i.programId,header:{title:k.t("swapSectionTitleTokens",{section:i.name}),iconUrl:i.iconUrl},data:c,behavior:"collapsible"}});return[{id:"verified",data:o.verified,behavior:"static"},{id:"unverified",header:{title:k.t("swapUnverifiedTokens")},data:o.unverified,behavior:"collapsible"},...n]}};function Lb(){return new uc}s();a();var Mb=D(U());s();a();var lc=D(U());var Ub=()=>{let{data:t}=Xe({key:"lastSelectedTokens",queryKey:le.lastSelectedTokens()}),e=(0,lc.useMemo)(()=>t?JSON.parse(t):{},[t]),{mutateAsync:r}=st({key:"lastSelectedTokens",queryKey:le.lastSelectedTokens()}),o=(0,lc.useCallback)(async n=>{let i={...e,[n]:!0};await r(JSON.stringify(i))},[e,r]);return{lastSelectedTokens:e,storeSelectedToken:o}};s();a();var mc=class{constructor(e,r){this.lastSelectedTokens=e;this.storeSelectedToken=r}intercept(e){let r=J(z(e));return this.lastSelectedTokens[r]||this.storeSelectedToken(r),"continue"}};s();a();s();a();var dc=class{constructor(e){this.lastSelectedTokens=e}intercept(e,r){switch(e.type){case"SPL":{let o=J(z(e)),n=this.lastSelectedTokens[o];return e.data.ugcTokenMeta?.status==="preDeploy"&&!n?(Lh(e),r("ugcWarning"),"interrupt"):"continue"}default:return"continue"}}};function Pk({lastSelectedTokens:t,storeSelectedToken:e}){return[new mc(t,e),new dc(t)]}function _b(){let{lastSelectedTokens:t,storeSelectedToken:e}=Ub();return(0,Mb.useMemo)(()=>Pk({lastSelectedTokens:t,storeSelectedToken:e}),[t,e])}var Ob=(0,Zr.createContext)(void 0),Ck=({children:t})=>{let e=(0,Zr.useMemo)(()=>Lb(),[]),r=_b();return Zr.default.createElement(Ob.Provider,{value:{buyAssetSectionAdapter:e,interceptors:r}},t)},Ui=()=>{let t=(0,Zr.useContext)(Ob);if(!t)throw new Error("useSwapAssetSelect must be used within a SwapAssetSelectProvider");return t};var Rk=()=>{let{interceptors:t}=Ui();return{executeInterceptors:(0,qb.useCallback)((r,o)=>{for(let n of t)if(n.intercept(r,o)==="interrupt")return"interrupt";return"continue"},[t])}};s();a();var No=D(U());var Vb=3;function _m(t){return{id:t.id,data:t.data,...t.header?{header:t.header}:{}}}var kk=t=>{let[e,r]=(0,No.useState)({}),o=(0,No.useCallback)((c,p)=>r(u=>({...u,[c]:p})),[]),{buyAssetSectionAdapter:n}=Ui(),i=(0,No.useMemo)(()=>n.sections(t),[n,t]);return(0,No.useMemo)(()=>i.map(c=>{switch(c.behavior){case"static":return _m(c);case"collapsible":{if(c.data.length<=Vb)return _m(c);let p=e[c.id],u=p?c.data:c.data.slice(0,Vb),l=()=>o(c.id,!p),f=_m(c);return{...f,header:{...f.header,button:{label:p?k.t("commandShowLess"):k.t("commandShowMore"),onClick:l}},data:u}}}}),[i,e,o])};s();a();var Dk=()=>{let t=re(),e=j();return de({mutationFn:async o=>{await xf(t,o),e.setQueryData(["termsHaveBeenAcknowledged2"],o)}})};s();a();s();a();var Gb=async t=>!!await t.get("termsHaveBeenAcknowledged2");var Om=()=>{let t=re(),e=async()=>!!await Gb(t);return W({queryKey:["termsHaveBeenAcknowledged2"],queryFn:e})};s();a();s();a();var qm=class{#e;constructor(e){this.#e=e}onBannerSeen=e=>{this.#e.capture("actionBannerSeenByUser",{data:{banner:e}})};onBannerClick=e=>{this.#e.capture("actionBannerClickedByUser",{data:{banner:e}})};onBannerDismiss=e=>{this.#e.capture("actionBannerDismissedByUser",{data:{banner:e}})};onInterstitialSeen=e=>{this.#e.capture("actionBannerInterstitialSeenByUser",{data:{banner:e}})};onInterstitialPrimaryClick=e=>{this.#e.capture("actionBannerInterstitialPrimaryButtonClickedByUser",{data:{banner:e}})};onInterstitialSecondaryClick=e=>{this.#e.capture("actionBannerInterstitialSecondaryButtonClickedByUser",{data:{banner:e}})};onInterstitialDismiss=e=>{this.#e.capture("actionBannerInterstitialDismissedByUser",{data:{banner:e}})}};s();a();var Nk=({id:t,humanReadableId:e,description:r,bannerType:o})=>({id:t,humanReadableId:e,description:r,type:o}),Bk=({id:t,humanReadableId:e,description:r,bannerType:o,interstitial:n})=>{let{title:i,primaryButtonText:c,secondaryButtonText:p}=n,u;if(o==="Modal")for(let[l,f]of Object.values(n.lineItems).entries())u={...u??{},[`lineItem${l+1}`]:{title:f.title,description:f.description}};return{id:t,humanReadableId:e,description:r,type:o,interstitial:{title:i,body:u,primaryButtonText:c??k.t("commandContinue"),secondaryButtonText:p??k.t("commandDismiss")}}};s();a();var Kb=D(U());s();a();var eo=D(U());s();a();var wde=["firstTimeOnboarding","isResettingApp"],Vm=["seed","seedless","privateKey"];var Gm=({onSuccess:t,onError:e}={})=>{let{t:r}=tt(),{data:[o]}=me(["enable-onboarding-claim-username"]),{mutateAsync:n,isIdle:i,isPending:c,error:p}=Ld(),u=Gd(G=>G.username),{refetch:l}=Xo(),{data:f,error:g,refetch:y}=je(),{data:w,refetch:S}=ue(),{data:h}=qd(),b=(0,eo.useMemo)(()=>{if(w)switch(w.type){case"seedless":case"seed":return w.seedIdentifier;case"privateKey":return w.privateKeyIdentifier;default:return}},[w]),E=(0,eo.useMemo)(()=>{let G={};return w?.addresses.forEach(v=>{G[v.networkID]=v.address}),G},[w?.addresses]),T=w&&Vm.includes(w.type),F=!f||g instanceof Ud,C=b&&h&&E,B=o&&T&&F&&C,q=(0,eo.useCallback)(async()=>{if(Ko()||!o)return!1;let G=await S();if(!(G&&G.data&&Vm.includes(G.data.type)))return!1;let x=await l(),P=x&&x.data,Q=await y(),_=Q&&Q.data;return!P||P&&!_},[o,S,l,y]),L=(0,eo.useMemo)(()=>p instanceof Error&&p.message!=="Unknown error"?p.message:r("settingsClaimUsernameError"),[p,r]),K=(0,eo.useCallback)(async()=>{C&&n({username:u,icon:"\u{1F47B}",addresses:E,accountIdentifiers:h.map(G=>G.identifier),secretIdentifiers:[b]}).then(()=>t?.()).catch(()=>e?.())},[h,n,C,e,t,E,b,u]);return(0,eo.useMemo)(()=>({handleClaimUsername:K,shouldNavigateToQuickClaimUsername:q,quickClaimUsernameAvailable:B,claimUsernameErrorMessage:L,isClaimingUsernamePending:c,isClaimUsernameIdle:i}),[L,K,i,c,B,q])};var Qk=()=>{let t=te(),{data:[e]}=me(["enable-onboarding-claim-username-dropoff"]),{data:r}=Cl("QuickClaimUsername"),{quickClaimUsernameAvailable:o}=Gm();return(0,Kb.useMemo)(()=>({shouldShow:e&&r?.length&&o,showFlow:n=>{t.capture("onboardingUsernameClaimDropoff"),n?.()}}),[t,e,o,r?.length])};s();a();s();a();var _k=D(U());s();a();var Hb=zo(te,t=>new Km(t)),Km=class{#e;constructor(e){this.#e=e}onOpen=()=>this.#e.capture("connectHardwareOpen");onSelectedChains=e=>{let r=new Set(e),o=[];for(let i of I.getAllChainIDs())r.has(i)&&o.push(i);let n={numChains:o.length,selectedChains:o.map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(", ")};this.#e.capture("connectHardwareSelectedChains",{data:n})};onDerivedAccounts=e=>{let r={};for(let[o,n]of Object.entries(e.derivedAddresses)){if(!Lk(o))continue;let i={numberOfDerivedAccounts:n.addresses.length};n.duration!==void 0&&(i.derivationDuration=n.duration),r[o]=i}this.#e.capture("connectHardwareAccountsDerived",{data:{...r}})};onDiscoveredAccounts=e=>{let{discoveredAccounts:r}=e,o={};for(let n of r){if(n.status==="undiscovered")continue;let i=n.accounts.reduce((c,{derivationPathType:p,hasAccountActivity:u})=>{let l=so.getAddressType(p);return c[l]={derivationPathType:p,hasAccountActivity:u},c},{});for(let{hasAccountActivity:c,derivationPathType:p}of Object.values(i)){if(!c)continue;let u=o[p]??0;o[p]=u+1}}this.#e.capture("connectHardwareAccountsDiscovered",{data:{numberOfActiveAccounts:o}})};onConnectedAccounts=e=>{let r={};for(let o of e.accounts){let n=[...o.addresses,...o.publicKeys].reduce((i,c)=>{let p=so.getAddressType(c.pathType);return i[p]=c.pathType,i},{});for(let i of Object.values(n)){let c=r[i]??0;r[i]=c+1}}this.#e.capture("connectHardwareAccountsConnected",{data:{numberOfAccountsImported:e.accounts.length,numberOfAccountsImportedByDerivationPath:r}})}};function Lk(t){return typeof t!="string"?!1:Object.keys(wp).includes(t)}s();a();s();a();s();a();var fc="@phantom/onboarding",Ir={firstTimeOnboarding:[`${fc}:first-time-onboarding`],isResettingApp:[`${fc}:is-resetting-app`],deriveLedgerAccounts:[`${fc}:derive-ledger-accounts`],discoverLedgerAccounts:[`${fc}:discover-ledger-accounts`]};s();a();s();a();s();a();s();a();var Ok="/discover/v1",qk={Accept:"application/json"},Vk=t=>{if(!t||!Array.isArray(t.accounts))return!1;for(let e of t.accounts)if(!(typeof e.address=="string"&&typeof e.amount=="string"&&(!e.lastActivityTimestamp||typeof e.lastActivityTimestamp=="number")&&e.chain&&typeof e.chain.id=="string"&&new Set(I.getAllNetworkIDs()).has(e.chain.id)&&typeof e.chain.name=="string"&&typeof e.chain.symbol=="string"&&typeof e.chain.imageUrl=="string"))return!1;return!0},Gk=t=>!!t&&typeof t.message=="string",Hm=async t=>{if(!t.accounts.length)throw new Error("Must send at least 1 account for discovery");let e=await Y.api().headers(qk).post(Ok,t),r=e.data;if(!se(e))throw Gk(r)?new Error(r.message):new Error(`Unable to discover accounts with args: ${JSON.stringify(t)}`);if(Vk(r))return r;throw new Error(`Invalid discover accounts response: ${JSON.stringify(r)}`)};var Kk="fetch-multi-chain-accounts-by-seed",Hk=()=>["bitcoinTaproot","bitcoinNativeSegwit"],$k=()=>["bip44Change","bip44","deprecated"],zk=()=>["bip44Ethereum","bip44EthereumSecondary","bip44EthereumTertiary"],Wk=()=>["bip44Sui"],jk=(t,e)=>Hk().map(r=>{let o={pathType:r,index:t},{publicKey:n}=e.derivePathType(r,t),i=so.getAddressType(r),c=Wn({publicKey:n,addressType:i});return{chainType:i,chainId:ee.Bitcoin.Mainnet,address:c,publicKey:Buffer.from(n).toString("hex"),pathParams:o}}),Yk=(t,e)=>zk().map(r=>{let o={pathType:r,index:t},{publicKey:n}=e.derivePathType(r,t),i=so.getAddressType(r),c=Wn({publicKey:n,addressType:"eip155"});return{chainType:i,pathType:r,address:c,publicKey:Buffer.from(n).toString("hex"),pathParams:o}}),Xk=(t,e)=>$k().map(r=>{let o={pathType:r,index:t},n=e.derivePathType(r,t),i;switch(r){case"bip44Root":case"bip44":case"bip44Change":i=n.publicKey;break;case"deprecated":i=Cd(n.secretKey).publicKey;break}let c=Wn({publicKey:i,addressType:"solana"});return{chainType:"solana",chainId:ee.Solana.Mainnet,address:c,publicKey:Buffer.from(i).toString("hex"),pathParams:o}}),Jk=(t,e)=>Wk().map(r=>{let o={pathType:r,index:t},{publicKey:n}=e.derivePathType(r,t),i=Wn({publicKey:n,addressType:"sui"});return{chainType:"sui",chainId:ee.Sui.Mainnet,address:i,publicKey:Pd(n),pathParams:o}}),Zk=1e4,$b=async(t,e=!0)=>{let r=Object.assign({},...t);try{let o=Object.values(r).map(({account:g})=>({address:g.address,chainId:g.chainId})),n;e?n=(await Ad(async()=>ts(Hm({accounts:o}),Zk),()=>!0,2)).accounts:n=(await Hm({accounts:o})).accounts;let i={};for(let g of n){let{account:y}=r[`${g.chain.id}-${g.address}`],w=y.publicKey,S=y.chainType,h=is(y.pathParams),b={...g,publicKey:w,chainType:S,derivationPathType:y.pathParams.pathType,hasAccountActivity:!!g.lastActivityTimestamp||parseFloat(g.amount)>0};i[h]=[...i[h]||[],b]}Object.keys(i).forEach(g=>{i[g]=i[g].sort((y,w)=>I.compareNetworkID(y.chain.id,w.chain.id))});let c=Object.values(i),p=c.filter(g=>g.some(y=>y.hasAccountActivity)),u=!!p.length;return(u?p:c).map(g=>{let y=g[0];return{status:"discovered",seedIndex:r[`${y.chain.id}-${y.address}`].account.pathParams.index??-1,isSelectedByDefault:u,accounts:g}})}catch{let o=Object.values(r).map(({account:p})=>p),n={};for(let p of o){let{account:u}=r[`${p.chainId}-${p.address}`],l=is(u.pathParams),f={...p,chain:{id:p.chainId,name:I.getNetworkName(p.chainId),symbol:I.getTokenSymbol(p.chainId)},chainType:so.getAddressType(u.pathParams.pathType),derivationPathType:u.pathParams.pathType,hasAccountActivity:!1};n[l]=[...n[l]||[],f]}return Object.keys(n).forEach(p=>{n[p]=n[p].sort((u,l)=>I.compareNetworkID(u.chain.id,l.chain.id))}),Object.values(n).map(p=>{let u=p[0];return{status:"undiscovered",seedIndex:r[`${u.chain.id}-${u.address}`].account.pathParams.index??-1,accounts:p,isSelectedByDefault:!1}})}},eD=async({hdWallet:t,startIndex:e,endIndex:r,enabledAddressTypes:o,enabledChains:n})=>{let i=[];for(let c=e;c<=r;++c){let p={};if(o.includes("bip122_p2wpkh"))for(let u of jk(c,t))p[`${ee.Bitcoin.Mainnet}-${u.address}`]={account:u};if(o.includes("eip155")){let u=Yk(c,t),l=n.filter(f=>I.isEVMNetworkID(I[f].mainnetID));for(let f of l){let g=I[f];for(let{address:y,publicKey:w,chainType:S,pathParams:h}of u)p[`${g.mainnetID}-${y}`]={account:{chainType:S,chainId:g.mainnetID,address:y,publicKey:w,pathParams:h}}}}if(o.includes("solana"))for(let u of Xk(c,t))p[`${u.chainId}-${u.address}`]={account:u};if(o.includes("sui"))for(let u of Jk(c,t))p[`${u.chainId}-${u.address}`]={account:u};i.push(p)}return $b(i)};function qfe({batchSize:t,hdWallet:e,enabledAddressTypes:r,enabledChains:o}){let n=!!e&&r.length!=0;return Qt({enabled:n,queryKey:[Kk,t],queryFn:async({pageParam:u=0})=>{try{if(t<1)throw new Error(`Need positive batchSize: ${t}`);if(!e)throw new Error("Missing HDWallet");let l=[],f=[],g=u===0,y=u,w=!0;for(;w;){let S=y,h=y+t-1,E=(await eD({hdWallet:e,startIndex:S,endIndex:h,enabledAddressTypes:r,enabledChains:o})).flat(1);y+=t,w=!1;for(let T of E)l.push(T),(T.status==="undiscovered"||T.isSelectedByDefault)&&f.push(T),g&&T.status==="discovered"&&T.isSelectedByDefault&&(w=!0)}if(g&&f.length===0&&l.length>1){let S=l[0],h=S.accounts.map(E=>({...E,hasAccountActivity:!1})),b={status:"undiscovered",seedIndex:S.seedIndex,accounts:h,isSelectedByDefault:!1};f.push(b)}return f}catch(l){throw l instanceof Error&&M.captureError(l,"account"),l}},getNextPageParam:(u,l)=>{let f=l.length,g=f?l[0]:[],y=g.length?tD(g[g.length-1].seedIndex,t):0;return f===1?y:y+t*(f-1)},gcTime:0,staleTime:0,initialPageParam:0})}var tD=(t,e)=>Math.ceil(t/e)*e+e;s();a();s();a();var rD=()=>{let t=re(),e=async()=>{let o=await t.get("firstTimeOnboarding");return o===null?!0:o.isFirstTimeOnboarding},{data:r}=W({queryKey:Ir.firstTimeOnboarding,queryFn:e});return r},oD=()=>{let t=re(),e=j();return de({mutationFn:async o=>{await t.set("firstTimeOnboarding",{isFirstTimeOnboarding:o}),If(t,o?void 0:Date.now()),e.setQueryData(Ir.firstTimeOnboarding,o)}})};s();a();var nD=()=>{let t=re(),e=async()=>{let o=await t.get("isResettingApp");return o===null?{isResettingApp:!1,isFirstTimeResettingApp:!1}:o},{data:r}=W({queryKey:Ir.isResettingApp,queryFn:e});return r},iD=()=>{let t=re(),e=j();return de({mutationFn:async o=>{let i=(await t.get("isResettingApp"))?.isFirstTimeResettingApp??!1;await t.set("isResettingApp",{isResettingApp:o,isFirstTimeResettingApp:i}),e.setQueryData(Ir.isResettingApp,{isResettingApp:o,isFirstTimeResettingApp:i})}})},sD=()=>{let t=re(),e=j();return de({mutationFn:async o=>{let i=(await t.get("isResettingApp"))?.isResettingApp??!1;await t.set("isResettingApp",{isResettingApp:i,isFirstTimeResettingApp:o}),e.setQueryData(Ir.isResettingApp,{isResettingApp:i,isFirstTimeResettingApp:o})}})};s();a();var aD=D(lT()),cD=D(U());s();a();s();a();var Xt=D(U());s();a();s();a();s();a();var pD=["SwapperNoQuotes","UnsupportedCountry","UnknownError"],zb=(t,e,r,o)=>{t instanceof Ee&&pD.includes(t.code)||(!e||e>=400&&e<500)&&M.addBreadcrumb(r,JSON.stringify(o),"info")};s();a();var Wb=async(t,e,r=void 0)=>{if(se(t))return Promise.resolve();let o;try{o=t.data}catch{throw new Ee({key:r})}let n=Ca.safeParse(o);throw n.success?(M.addBreadcrumb(e,JSON.stringify(n.data),"info"),new Ee({key:n.data.name})):new Ee({key:r})};s();a();var gc=t=>{let e=new Ee({key:"SwapperNoQuotes"});if(Vl.safeParse(t?.type).success===!1)throw M.captureError(new Error("Failed to parse a valid quote type."),"swapper"),new Error("Invalid input");let r=Gl.safeParse(t);if(!r.success)throw M.captureError(new Error("Failed to parse a valid swap quotes response."),"swapper"),e;if(r.data.quotes.length===0)throw e;return r.data};var jb="swap-quotes";async function yc({sellTokenCaip19:t,buyTokenCaip19:e,taker:r,takerDestination:o,exactOut:n,sellAmount:i,slippageTolerance:c,signal:p,enableAutoSlippage:u,priorityFee:l}){let f;try{ao(r)&&(r.address=r.address.toLowerCase()),o&&ao(o)&&(o.address=o.address.toLowerCase()),ao(e)&&(e.address=e.address.toLowerCase()),ao(t)&&(t.address=t.address.toLowerCase());let g="/swap/v2/quotes",y={sellToken:t,buyToken:e,taker:r,takerDestination:o,exactOut:n,sellAmount:i,slippageTolerance:c,autoSlippage:u,priorityFee:l},w=await Y.api().post(g,y,{signal:p});return f=w.status,await Wb(w,jb,"SwapperNoQuotes"),gc(w.data)}catch(g){let y=g instanceof Ee?g:new Ee;throw zb(y,f,jb,{sellToken:t,buyToken:e,sellAmount:i,slippageTolerance:c}),y}}var Sc=class{getQuotes(e){return yc({sellTokenCaip19:e.sell,buyTokenCaip19:e.buy,taker:e.taker,takerDestination:e.takerDestination,sellAmount:e.amount,slippageTolerance:e.slippageTolerance,signal:e.signal,exactOut:e.exactOutEnabled,priorityFee:e.priorityFee,enableAutoSlippage:e.autoSlippageEnabled})}};s();a();s();a();var wc=class{constructor(e,r,o,n,i,c){this.executingQuote=e;this.takerAddress=r;this.networkId=o;this.quote=n;this.executionId=i;this.evmSwapCommand=c}createTransaction(){return $l({networkId:this.networkId,callerAddress:this.takerAddress,quote:this.quote})}async swap(e,r,o,n,i){return this.evmSwapCommand.swap(e,r,o,n,i)}async waitForConfirmation(e){return this.evmSwapCommand.waitForConfirmation(e)}};s();a();s();a();var Jb=D(U());s();a();var Yb=D(U());function Un(t){return(0,Yb.useMemo)(()=>Te(t),[t])}function Zb({sender:t}){let{t:e}=tt(),{currentQuote:r}=Z(),o=A(g=>g.buyFungible),n=A(g=>g.sellFungible),i=Un(Ce(r)),{data:c}=$t({callerAddress:t,quote:r,sellFungible:n}),p=c?.transactionPairs?.flatMap(g=>[...uo(g.sellToken)??[],...uo(g.buyToken)??[]])??[],u=[...new Set(p)],{fungibles:l}=vt({keys:u});return{pendingActivityRows:(0,Jb.useMemo)(()=>Bo({swapTransactions:c,sellFungible:n,buyFungible:o,fungibles:l,t:e,currentQuote:r,provider:i}),[c,n,o,l,e,r,i])}}function Bo({swapTransactions:t,sellFungible:e,buyFungible:r,fungibles:o,currentQuote:n,provider:i,t:c}){let p={pendingSwapActivityRows:[],pendingApprovalActivityRows:[]};return t?t.type==="evm"?t.transactionTypes.reduce((u,l,f)=>{let g=e,y=r,w,S=t.transactionPairs;if(S&&S[f]){let h=S[f];g=hc(h.sellToken,o)??e,y=hc(h.buyToken,o)??r,w=h.approvalMetadata}if(l.includes("approval")){let h=g?.data.symbol??"";u.pendingApprovalActivityRows.push({topLeft:w?{text:`${c("transactionsPendingApproving")} ${w.symbol}`}:{text:`${c("transactionsPendingApproving")} ${h}`}})}else g&&y&&u.pendingSwapActivityRows.push(Xb({sellFungible:g,buyFungible:y,sellAmount:n?.sellAmount,buyAmount:n?.buyAmount,provider:i,isBridge:l.includes("bridge"),t:c}));return u},p):t.transactionTypes.reduce((u,l,f)=>{let g=e,y=r,w=t.transactionPairs;if(w&&w[f]){let S=w[f];g=hc(S.sellToken,o)??e,y=hc(S.buyToken,o)??r}return g&&y&&u.pendingSwapActivityRows.push(Xb({sellFungible:g,buyFungible:y,sellAmount:n?.sellAmount,buyAmount:n?.buyAmount,provider:i,isBridge:l.includes("bridge"),t:c})),u},p):p}var Xb=({sellFungible:t,buyFungible:e,sellAmount:r,buyAmount:o,provider:n,isBridge:i,t:c})=>{let p=t.data.symbol,u=e.data.symbol,l=ne(r??0,t.data.decimals??0),f=ne(o??0,e.data.decimals??0);return{topLeft:{text:`${c(i?"transactionsPendingBridging":"transactionsPendingSwapping")} on ${n}`},topRight:{text:`${f} ${u}`,color:"accentSuccess"},bottomLeft:{text:`${p} \u2192 ${u}`},bottomRight:{text:`${l} ${p}`}}},hc=(t,e)=>e.find(r=>(uo(t)??[]).includes(r.data.key));var eA="standard",bc=class{constructor(e,r,o,n,i,c){this.executingQuote=e;this.takerAddress=r;this.networkId=o;this.quote=n;this.executionId=i;this.gasEstimation=c}createTransaction(){return Ii({quote:this.quote,callerAddress:this.takerAddress,networkId:this.networkId,sellFungible:this.executingQuote.sell})}async swap(e,r,o,n,i){let c=this.gasEstimation??await this.estimateGas(this.quote,this.executingQuote.response,eA,r,o);if(!c)throw new Error(`No gas estimation found for ${eA}`);let p=this.parsePendingActivity(this.executingQuote,r),{signature:u,error:l}=await M.startSpan({name:"Process EVM Swap Txns"},()=>ja({transactions:r.transactions,transactionTypes:r.transactionTypes,networkID:this.networkId,gasEstimation:c,pendingSwapActivityRows:p.pendingSwapActivityRows,pendingApprovalActivityRows:p.pendingApprovalActivityRows,accountIdentifier:e,accountSigner:n,storage:i}));if(l)throw l;return{networkID:this.networkId,id:u}}async waitForConfirmation(e){await Wd(e.networkID,e.id)}async estimateGas(e,r,o,n,i){let c=await ms(this.networkId,!0);if(!c)return;let p=c[o];if(!p)return;let u={networkID:this.networkId,gasLimit:new H(1),maxFeePerGas:p.maxFeePerGas,maxPriorityFeePerGas:p.maxPriorityFeePerGas};return Cn.estimateGas({swapTransactions:n,evmGasEstimation:u,currentQuote:e,scanResult:i,includeGasBuffer:!0,networkID:this.networkId,gasBuffer:r.gasBuffer})}parsePendingActivity(e,r){let o=Te(Ce(e.quote));return Bo({swapTransactions:r,sellFungible:e.sell,buyFungible:e.buy,fungibles:[],currentQuote:e.quote,provider:o,t:k.t})}};s();a();s();a();var Mn=class{constructor(e,r,o,n,i,c){this.executingQuote=e;this.takerAddress=r;this.networkId=o;this.quote=n;this.executionId=i;this.connection=c}async createTransaction(){return Fi({quote:this.quote,connection:this.connection})}async swap(e,r,o,n,i){let c=this.parsePendingActivity(this.executingQuote,r),{signature:p,error:u}=await Ya({callerAddress:this.takerAddress,connection:this.connection,networkID:this.networkId,transactions:r.transactions,pendingSwapActivityRows:c.pendingSwapActivityRows,accountIdentifier:e,accountSigner:n,storage:i});if(u)throw u;return{networkID:this.networkId,id:p}}async waitForConfirmation(e){let r=Jd(e.networkID);await Ss({connection:r,signature:e.id})}parsePendingActivity(e,r){let o=Te(Ce(e.quote));return Bo({swapTransactions:r,sellFungible:e.sell,buyFungible:e.buy,fungibles:[],currentQuote:e.quote,provider:o,t:k.t})}};var Ac=class{constructor(e,r,o,n,i,c){this.executingQuote=e;this.takerAddress=r;this.networkId=o;this.quote=n;this.executionId=i;this.connection=c;this.solanaSwapCommand=new Mn(e,r,o,e.quote,i,c)}solanaSwapCommand;createTransaction(){return zl({quote:this.quote,connection:this.connection})}async swap(e,r,o,n,i){return this.solanaSwapCommand.swap(e,r,o,n,i)}async waitForConfirmation(e){return this.solanaSwapCommand.waitForConfirmation(e)}};s();a();var Tc=class{constructor(e,r,o,n,i){this.executingQuote=e;this.takerAddress=r;this.networkId=o;this.quote=n;this.executionId=i}async createTransaction(){return Pi({quote:this.quote})}async swap(e,r,o,n,i){let c=this.parsePendingActivity(this.executingQuote,r),{signature:p,error:u}=await Xa({callerAddress:this.takerAddress,networkID:this.networkId,transactions:r.transactions,pendingSwapActivityRows:c.pendingSwapActivityRows,accountIdentifier:e,accountSigner:n,storage:i});if(u)throw u;return{networkID:this.networkId,id:p}}async waitForConfirmation(e){await gs(this.networkId,e.id)}parsePendingActivity(e,r){let o=Te(Ce(e.quote));return Bo({swapTransactions:r,sellFungible:e.sell,buyFungible:e.buy,fungibles:[],currentQuote:e.quote,provider:o,t:k.t})}};var vc=class{create(e,r,o,n,i){if(I.isSolanaNetworkID(o)&&br(e.quote))return new Mn(e,r,o,e.quote,pt(),n);if(I.isEVMNetworkID(o)&&mt(e.quote))return this.createEvmSwapCommand(e,r,o,i);if(I.isSuiNetworkID(o)&&Ar(e.quote))return new Tc(e,r,o,e.quote,pt());if(ae(e.quote)){if(I.isSolanaNetworkID(o))return new Ac(e,r,o,e.quote,pt(),n);if(I.isEVMNetworkID(o)){let c=this.createEvmSwapCommand(e,r,o,i);return new wc(e,r,o,e.quote,pt(),c)}}throw new Error("Unsupported SwapQuote}")}createEvmSwapCommand(e,r,o,n){let i=n?n.filter(ds):void 0;return i&&i.length===0&&(i=void 0),new bc(e,r,o,e.quote,pt(),i)}};s();a();s();a();var uD=["UNSENT","OPENED","HEADERS_RECEIVED","LOADING","DONE"],$m=class{ERROR=-1;CONNECTING=0;OPEN=1;CLOSED=2;CRLF=`\r
`;LF=`
`;CR="\r";lastEventId=null;status=this.CONNECTING;eventHandlers={open:[],message:[],error:[],close:[]};method;timeout;timeoutBeforeConnection;withCredentials;headers;body;debug;interval;lineEndingCharacter;_xhr=null;_pollTimer=null;_lastIndexProcessed=0;url;constructor(e,r={}){if(!e||typeof e!="string"&&typeof e.toString!="function")throw new SyntaxError("[EventSource] Invalid URL argument.");this.url=typeof e.toString=="function"?e.toString():e,this.method=r.method||"GET",this.timeout=r.timeout??0,this.timeoutBeforeConnection=r.timeoutBeforeConnection??500,this.withCredentials=r.withCredentials||!1,this.headers=r.headers||{},this.body=r.body||void 0,this.debug=r.debug||!1,this.interval=r.pollingInterval??5e3,this.lineEndingCharacter=r.lineEndingCharacter||null,this._pollAgain(this.timeoutBeforeConnection,!0)}_pollAgain(e,r){(e>0||r)&&(this._logDebug(`[EventSource] Will open new connection in ${e} ms.`),this._pollTimer=setTimeout(()=>{this.open()},e))}open(){try{this.status=this.CONNECTING,this._lastIndexProcessed=0,this._xhr=new XMLHttpRequest,this._xhr.open(this.method,this.url,!0),this.withCredentials&&(this._xhr.withCredentials=!0),this._xhr.setRequestHeader("Accept","text/event-stream"),this._xhr.setRequestHeader("Cache-Control","no-cache"),this._xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");for(let[e,r]of Object.entries(this.headers))this._xhr.setRequestHeader(e,r);this.lastEventId!==null&&this._xhr.setRequestHeader("Last-Event-ID",this.lastEventId),this._xhr.timeout=this.timeout,this._xhr.onreadystatechange=()=>{if(this.status===this.CLOSED)return;let e=this._xhr;this._logDebug(`[EventSource][onreadystatechange] ReadyState: ${uD[e.readyState]||"Unknown"}(${e.readyState}), status: ${e.status}`),[XMLHttpRequest.DONE,XMLHttpRequest.LOADING].includes(e.readyState)&&(e.status>=200&&e.status<400?(this.status===this.CONNECTING&&(this.status=this.OPEN,this.dispatch("open",{type:"open"}),this._logDebug("[EventSource][onreadystatechange][OPEN] Connection opened.")),this._handleEvent(e.responseText||""),e.readyState===XMLHttpRequest.DONE&&(this._logDebug("[EventSource][onreadystatechange][DONE] Operation done."),this._pollAgain(this.interval,!1))):e.status!==0&&(this.status=this.ERROR,this.dispatch("error",{type:"error",message:e.responseText,xhrStatus:e.status,xhrState:e.readyState}),e.readyState===XMLHttpRequest.DONE&&(this._logDebug("[EventSource][onreadystatechange][ERROR] Response status error."),this._pollAgain(this.interval,!1))))},this._xhr.onerror=()=>{this.status!==this.CLOSED&&(this.status=this.ERROR,this.dispatch("error",{type:"error",message:this._xhr.responseText,xhrStatus:this._xhr.status,xhrState:this._xhr.readyState}))},this.body?this._xhr.send(this.body):this._xhr.send(),this.timeout>0&&setTimeout(()=>{this._xhr.readyState===XMLHttpRequest.LOADING&&(this.dispatch("error",{type:"timeout"}),this.close())},this.timeout)}catch(e){this.status=this.ERROR,this.dispatch("error",{type:"exception",message:e.message,error:e})}}_logDebug(...e){this.debug&&console.debug(...e)}_handleEvent(e){if(this.lineEndingCharacter===null){let l=this._detectNewlineChar(e);if(l!==null)this._logDebug(`[EventSource] Automatically detected lineEndingCharacter: ${JSON.stringify(l).slice(1,-1)}`),this.lineEndingCharacter=l;else{console.warn("[EventSource] Unable to identify the line ending character. Ensure your server delivers a standard line ending character: \\r\\n, \\n, \\r, or specify your custom character using the 'lineEndingCharacter' option.");return}}let r=this._getLastDoubleNewlineIndex(e);if(r<=this._lastIndexProcessed)return;let o=e.substring(this._lastIndexProcessed,r).split(this.lineEndingCharacter);this._lastIndexProcessed=r;let n,i=null,c=[],p=0,u="";for(let l=0;l<o.length;l++)if(u=o[l].trim(),u.startsWith("event"))n=u.replace(/event:?\s*/,"");else if(u.startsWith("retry"))p=parseInt(u.replace(/retry:?\s*/,""),10),isNaN(p)||(this.interval=p);else if(u.startsWith("data"))c.push(u.replace(/data:?\s*/,""));else if(u.startsWith("id"))i=u.replace(/id:?\s*/,""),i!==""?this.lastEventId=i:this.lastEventId=null;else if(u===""&&c.length>0){let f=n||"message",g={type:f,data:c.join(`
`),url:this.url,lastEventId:this.lastEventId};this.dispatch(f,g),c=[],n=void 0}}_detectNewlineChar(e){let r=[this.CRLF,this.LF,this.CR];for(let o of r)if(e.includes(o))return o;return null}_getLastDoubleNewlineIndex(e){let r=this.lineEndingCharacter+this.lineEndingCharacter,o=e.lastIndexOf(r);return o===-1?-1:o+r.length}addEventListener(e,r){this.eventHandlers[e]===void 0&&(this.eventHandlers[e]=[]),this.eventHandlers[e].push(r)}removeEventListener(e,r){this.eventHandlers[e]!==void 0&&(this.eventHandlers[e]=this.eventHandlers[e].filter(o=>o!==r))}removeAllEventListeners(e){let r=Object.keys(this.eventHandlers);if(e===void 0)for(let o of r)this.eventHandlers[o]=[];else{if(!r.includes(e))throw Error(`[EventSource] '${e}' type is not supported event type.`);this.eventHandlers[e]=[]}}dispatch(e,r){if(Object.keys(this.eventHandlers).includes(e))for(let n of Object.values(this.eventHandlers[e]))n(r)}close(){this.status!==this.CLOSED&&(this.status=this.CLOSED,this.dispatch("close",{type:"close"})),clearTimeout(this._pollTimer),this._xhr&&this._xhr.abort()}},Ec=$m;s();a();var lD={"X-Phantom-Version":Se,"X-Phantom-Platform":De},zm={name:"SwapperNoQuotes",message:"No quotes found"},_n=class{getOptions(e={}){return{...e,headers:{...e.headers,...lD}}}createStreamUrl({amount:e,buy:r,sell:o,taker:n,takerDestination:i,slippageTolerance:c,exactOut:p,autoSlippage:u,priorityFee:l}){let f=new URLSearchParams({taker:n,takerDestination:i,buyToken:J(z(r)),sellToken:J(z(o)),sellAmount:e,exactOut:p?"true":"false",autoSlippage:u?"true":"false"});return c&&f.set("slippageTolerance",String(c)),l&&f.set("priorityFee",String(l)),`${kr()}/swap/v2/stream/quotes?${f.toString()}`}handleNewQuoteResponse(e,r){try{if(!e)throw new Error("No data in new-quote-response");let o=JSON.parse(e),n=gc(o);r({type:"newQuoteResponse",quoteResponse:n})}catch{r({type:"error",error:zm})}}handleErrorQuoteResponse(e,r){try{if(!e)throw new Error("No data in error-quote-response");let o=Ca.safeParse(JSON.parse(e));r({type:"error",error:o.success?o.data:zm})}catch{r({type:"error",error:zm})}}};var xc=class extends _n{eventSource;open(e,r){this.close(),this.eventSource=new Ec(this.createStreamUrl(e),this.getOptions());let o=n=>{switch(n.type){case"new-quote-response":this.handleNewQuoteResponse(n.data,r);break;case"error-quote-response":this.handleErrorQuoteResponse(n.data,r);break;case"open":r({type:"open"});break;case"error":r({type:"error",error:{name:"UnknownError",message:n.message}});break;case"close":r({type:"close"});break}};this.eventSource.addEventListener("new-quote-response",o),this.eventSource.addEventListener("error-quote-response",o),this.eventSource.addEventListener("open",o),this.eventSource.addEventListener("error",o),this.eventSource.addEventListener("close",o)}close(){this.eventSource&&(this.eventSource.removeAllEventListeners(),this.eventSource.close())}};s();a();var Ic=class extends _n{eventSource;open(e,r){this.close(),this.eventSource=new Ec(this.createStreamUrl(e),this.getOptions());let o=n=>{switch(n.type){case"new-quote-response":this.handleNewQuoteResponse(n.data,r);break;case"error-quote-response":this.handleErrorQuoteResponse(n.data,r);break;case"open":r({type:"open"});break;case"error":r({type:"error",error:{name:"UnknownError",message:n.message}});break;case"close":r({type:"close"});break}};this.eventSource.addEventListener("new-quote-response",o),this.eventSource.addEventListener("error-quote-response",o),this.eventSource.addEventListener("open",o),this.eventSource.addEventListener("error",o),this.eventSource.addEventListener("close",o)}close(){this.eventSource&&(this.eventSource.removeAllEventListeners(),this.eventSource.close())}};s();a();var Fc=class{constructor(e){this.producer=e}listeners=new Set;openStream(e){this.listeners.forEach(r=>r.onEvent({type:"openRequested"})),this.producer.close(),this.producer.open(e,r=>{this.listeners.forEach(o=>o.onEvent(r))})}closeStream(){this.producer.close()}subscribe(e){this.listeners.add(e)}unsubscribe(e){this.listeners.delete(e)}};s();a();s();a();s();a();async function Pc({transactions:t,locale:e,url:r,deviceId:o,takerAddress:n,networkId:i,slippageType:c,quote:p,quoteResponse:u}){return await Zn(e,o,{type:"transaction",userAccount:n,params:mD(t),url:r,networkID:i,context:ae(p)?"bridge":"swap",provider:dD(p),slippageType:c,metadata:{swapper:{quoteOutputAmount:p.buyAmount,quoteOutputToken:J(u.buyToken),quoteInputAmount:p.sellAmount,quoteInputToken:J(u.sellToken)}}})}var mD=t=>{switch(t.type){case"evm":return{transactions:t.transactions};case"solana":return{transactions:t.transactions,method:"signAndSendTransaction",simulatorConfig:{decodeAccounts:!1}};case"sui":return{transactions:t.transactions,method:"signAndSendTransaction"}}},dD=t=>{let e=ae(t)?Fn(t):t?.sources??[];return Te(e)};var Cc=class{constructor(e,r,o,n,i){this.networkID=e;this.account=r;this.priceClient=o;this.quoteInput=n;this.quoteResponse=i}getNativeTokenCaip19(){return J({chainId:this.networkID,resourceType:"nativeToken",slip44:I.getSlip44(this.networkID)})}async processQuote(e){let r=await this.createSwapTransactions(e),o=await this.calculateNetworkFee(r,e),n=this.appendPhantomFee([o],e);return{quote:e,fees:{totalFees:this.sumFees(n),fees:n},swapTransactions:r}}createSwapTransactions(e){return Ii({networkId:this.networkID,callerAddress:this.checkChainAddress().address,quote:e,sellFungible:this.quoteInput.sell})}appendPhantomFee(e,r){let o=r.fees.find(n=>n.type==="phantom");return o?[...e,{type:"phantom",percentage:new V(o.percentage),amountUsd:new V(0)}]:e}async calculateNetworkFee(e,r){let o=await this.estimateGas(r,e);if(!o)throw new Error("Unable to estimate gas");let n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let i=o[0],c=this.quoteInput.buy,p=i.gasLimit.times(i.maxFeePerGas);return{type:"evmGas",amountUsd:new V(p).shiftedBy(-c.data.decimals).times(n.usd)}}async estimateGas(e,r){let o=await ms(this.networkID,!0);if(!o)return;let n=o.standard;if(!n)return;let i={networkID:this.networkID,gasLimit:new V(1),maxFeePerGas:n.maxFeePerGas,maxPriorityFeePerGas:n.maxPriorityFeePerGas},c=await Pc({transactions:r,locale:"en-us",url:"https://phantom.app",deviceId:"123",takerAddress:this.checkChainAddress().address,networkId:this.networkID,slippageType:this.quoteInput.autoSlippage?"auto":"fixed",quote:e,quoteResponse:this.quoteResponse});return Cn.estimateGas({swapTransactions:r,evmGasEstimation:i,currentQuote:e,scanResult:c,includeGasBuffer:!0,networkID:this.networkID,gasBuffer:this.quoteResponse.gasBuffer})}checkChainAddress(){let e=this.account.addresses.find(r=>r.networkID===this.networkID);if(!e)throw new Error(`No address found for chain ${this.networkID}`);return ns(e)&&(e.address=e.address.toLowerCase()),e}sumFees(e){return e.reduce((r,o)=>r.plus(o.amountUsd),new V(0))}};s();a();var Rc=class{constructor(e,r,o){this.networkID=e;this.priceClient=r;this.connection=o}getNativeTokenCaip19(){return J({chainId:this.networkID,resourceType:"nativeToken",slip44:I.getSlip44(this.networkID)})}async processQuote(e){let r=await this.createSwapTransactions(e),o=await this.calculateNetworkFee(r),n=this.appendPhantomFee([o],e);return{quote:e,fees:{totalFees:this.sumFees(n),fees:n},swapTransactions:r}}createSwapTransactions(e){return Fi({quote:e,connection:this.connection})}appendPhantomFee(e,r){let o=r.fees.find(n=>n.type==="phantom");return o?[...e,{type:"phantom",percentage:new V(o.percentage),amountUsd:new V(0)}]:e}async calculateNetworkFee(e){let r=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!r.usd)throw new Error("Price data not found");let o=e.transactions.map(l=>this.processEncodedTx(l,this.networkID,this.connection)),i=(await Promise.all(o)).map(l=>l.networkFeeEstimation.value);return{type:"solanaNetwork",amountUsd:new V(i[0]).div(new V(Rr.LAMPORTS_PER_SOL)).times(r.usd)}}async processEncodedTx(e,r,o){let n=Cr(e,"bs58");return await Ji(n,o),{networkFeeEstimation:await ys(r,[n.message])}}sumFees(e){return e.reduce((r,o)=>r.plus(o.amountUsd),new V(0))}};s();a();var kc=class{constructor(e,r){this.networkID=e;this.priceClient=r}getNativeTokenCaip19(){return J({chainId:this.networkID,resourceType:"nativeToken",slip44:I.getSlip44(this.networkID)})}async processQuote(e){let r=await this.createSwapTransactions(e),o=await this.calculateNetworkFee(r),n=this.appendPhantomFee([o],e);return{quote:e,fees:{totalFees:this.sumFees(n),fees:n},swapTransactions:r}}createSwapTransactions(e){return Pi({quote:e})}appendPhantomFee(e,r){let o=r.fees.find(n=>n.type==="phantom");return o?[...e,{type:"phantom",percentage:new V(o.percentage),amountUsd:new V(0)}]:e}async calculateNetworkFee(e){let r=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!r.usd)throw new Error("Price data not found");let o=new V(0);try{let n=await Promise.all(e.transactions.map(i=>fs({networkID:this.networkID,transaction:Zo.deserializeTransactionString(i)})));o=new V(n.reduce((i,c)=>i+c.gasBudget.toNumber(),0)).dividedBy(1e9).multipliedBy(r.usd)}catch{return{type:"suiNetwork",amountUsd:new V(0)}}return{type:"suiNetwork",amountUsd:o}}sumFees(e){return e.reduce((r,o)=>r.plus(o.amountUsd),new V(0))}};var Dc=class{create(e,r,o){let n=r.sell.data.chain.id;if(I.isSolanaNetworkID(n)){let i=Sf(e).connection;return new Rc(n,this.priceClient,i)}else{if(I.isEVMNetworkID(n))return new Cc(n,e,this.priceClient,r,o);if(I.isSuiNetworkID(n))return new kc(n,this.priceClient)}throw new Error(`Unsupported network ID: ${n}`)}priceClient={getPrice:async e=>(await mf({tokens:[Wo(e)]}))[e]};isSupportedNetwork(e){return I.isSolanaNetworkID(e)||I.isEVMNetworkID(e)}},Nc=class{create(e,r,o){return{processQuote:async n=>({quote:n,fees:{totalFees:new V(0),fees:[]}})}}};s();a();s();a();s();a();var fD=t=>t.isGreaterThanOrEqualTo(1)?"0,0.[00]":"0,0.[00000]",Qo=t=>{let e=V(t);return Fd(t,fD(e))};var gD=5,yD=5,SD=50;function Wm(t,e,r,o){let{priceImpact:n,slippageTolerance:i}=wD(t),c=e.autoSlippage?r.slippageTolerance:i,p={type:"slippage",slippage:c,slippageType:e.autoSlippage?"auto":"fixed",alert:c&&c>=yD?"highSlippage":void 0},u={type:"priceImpact",priceImpactPercentage:hD(n),alert:n&&n.gte(gD)?"highPriceImpact":void 0,warning:n&&n.gte(SD)?"veryHighPriceImpact":void 0},f=[bD(t,e.buy,e.sell),p,u];return o&&f.push({type:"fees",quoteFees:o}),f}function wD(t){return br(t)?{priceImpact:t.priceImpact?V(t.priceImpact):V(0),slippageTolerance:t.slippageTolerance}:mt(t)?{priceImpact:t.priceImpact?V(t.priceImpact):V(0),slippageTolerance:t.slippageTolerance}:Ar(t)?{priceImpact:t.priceImpact?V(t.priceImpact):V(0),slippageTolerance:t.slippageTolerance}:{priceImpact:V(0),slippageTolerance:void 0}}function hD(t){return t.isZero()?"0%":`${t.toFixed(2)}%`}function bD(t,e,r){let{buyAmount:o,sellAmount:n}=t,i=new V(o).shiftedBy(-e.data.decimals).dividedBy(new V(n).shiftedBy(-r.data.decimals));return{type:"pricing",ratio:i,exchangeRate:`1 ${r.data.symbol} \u2248 ${Qo(i)} ${e.data.symbol}`,exchangeRateFlipped:`1 ${e.data.symbol} \u2248 ${Qo(V(1).dividedBy(i))} ${r.data.symbol}`}}s();a();var Bc=class{queue=[];processing=!1;enqueue(e){this.queue.push(e),this.processNext()}clearQueue(){this.queue=[],this.processing=!1}async processNext(){if(this.processing||this.queue.length===0)return;this.processing=!0;let e=this.queue.shift();if(e)try{await e()}catch(r){console.error("Error processing task:",r)}this.processing=!1,this.processNext()}};s();a();var Mi=class{constructor(e){this.entries=e;for(let r of e)r.alert&&this.alerts.push(r.alert),r.warning&&this.warnings.push(r.warning)}alerts=[];warnings=[]};var AD="swap-quotes",Qc=class{constructor(e,r){this.quoteStreamer=e;this.commandFactory=r}state={type:"idle"};listeners=[];swapTransactionQueue=new Bc;start(e,r){this.setState({type:"starting",input:e,account:r}),this.quoteStreamer.subscribe(this.quoteStreamListener),this.quoteStreamer.openStream(e)}stop(){this.swapTransactionQueue.clearQueue(),this.setState({type:"idle"}),this.quoteStreamer.closeStream(),this.quoteStreamer.unsubscribe(this.quoteStreamListener)}quoteStreamListener={onEvent:e=>{switch(e.type){case"newQuoteResponse":switch(this.state.type){case"starting":this.setState({type:"firstQuoteReceived",input:this.state.input,quote:e.quoteResponse.quotes[0],response:e.quoteResponse,account:this.state.account,quoteDetails:new Mi(Wm(e.quoteResponse.quotes[0],this.state.input,e.quoteResponse))}),this.enqueueQuoteToProcess(this.state.input,e.quoteResponse,this.state.account);break;case"quoteProcessed":this.enqueueQuoteToProcess(this.state.input,e.quoteResponse,this.state.account,this.state.prevProcessedQuote);break}break;case"error":M.addBreadcrumb(AD,JSON.stringify(e.error),"info"),this.setState({type:"error",error:new Ee({key:e.error.name})}),this.stop();break;case"openRequested":break;case"close":this.setState({type:"idle"});break}}};enqueueQuoteToProcess(e,r,o,n){this.swapTransactionQueue.enqueue(()=>this.processQuote(r,e,o,n))}async processQuote(e,r,o,n){try{let i=e.quotes[0],p=await this.commandFactory.create(o,r,e).processQuote(i);return this.setState({type:"quoteProcessed",input:r,response:e,quote:i,prevProcessedQuote:n,nextProcessedQuote:p,account:o,quoteDetails:new Mi(Wm(i,r,e,p.fees))}),p}catch(i){throw M.captureError(i,"swapper"),i}}subscribe(e){this.listeners.push(e)}unsubscribe(e){this.listeners=this.listeners.filter(r=>r!==e)}getState(){return this.state}setState(e){let r=this.state;this.state=e,this.listeners.forEach(o=>o.onStateChange(r,e))}};s();a();s();a();s();a();s();a();var fe=class extends Error{code;detailMessage;constructor(e,r){super(e),this.code=e,this.detailMessage=r}};var TD="slippageToleranceExceeded",vD="INSUFFICIENT_FUNDS",ED=zd,xD="insufficient lamports",ID="lower balance than rent-exempt minimum",FD=$d,PD="Transaction confirmation failed",CD=["Ledger App not open","Ledger not connected","Unable to connect to Ledger","Unable to connect to Ledger device","Need permission to connect to Ledger"],RD="Ledger user rejected action",kD="Ledger Sign Error";function DD(t){try{return Number(t.split('"Custom":')[1].split("}")[0])}catch{return null}}function ND(t){switch(DD(t.message)){case 301:return"slippageToleranceExceeded";case 6e3:return"EmptyRoute";case 6001:return"slippageToleranceExceeded";case 6002:return"InvalidCalculation";case 6003:return"MissingPlatformFeeAccount";case 6004:return"InvalidSlippage";case 6005:return"NotEnoughPercent";case 6006:return"InvalidInputIndex";case 6007:return"InvalidOutputIndex";case 6008:return"NotEnoughAccountKeys";case 6009:return"NonZeroMinimumOutAmountNotSupported";case 6010:return"InvalidRoutePlan";case 6011:return"InvalidReferralAuthority";case 6012:return"LedgerTokenAccountDoesNotMatch";case 6013:return"InvalidTokenLedger";case 6014:return"IncorrectTokenProgramID";case 6015:return"TokenProgramNotProvided";case 6016:return"SwapNotSupported";case 6017:return"ExactOutAmountNotMatched";case 6018:return"SourceAndDstinationMintCannotBeTheSame";default:return null}}function BD(t){return CD.some(r=>t.message.includes(r))?"LedgerConnectionError":t.message.includes(RD)?"LedgerRejectAction":t.message.includes(kD)?"LedgerUnknownSignError":t.message.toLowerCase().includes("ledger")?"LedgerUnknownError":null}function to(t){if(t===void 0)return new fe("UnknownError","No error provided");if(t instanceof fe)return t;let e=QD(t);if(e.message.includes(vD))return new fe("INSUFFICIENT_FUNDS");if(LD(e.message))return new fe("slippageToleranceExceeded");if(e.message==="Scan results are not valid")return new fe("Scan results are not valid");if([ED,xD,FD,ID].some(u=>e.message.includes(u)))return new fe("NotEnoughSol");let i=ND(e);if(i!==null)return new fe(i);if(e.message.includes(PD))return new fe("Transaction confirmation failed");let p=BD(e);return p!==null?new fe(p):new fe("UnknownError",e.message)}function QD(t){return typeof t=="string"?new Error(t):typeof t=="object"&&"logs"in t&&t.logs?.length?new Error(t.logs.join(`
`)):t}function LD(t){return t.includes(TD)}s();a();s();a();var tA=3;function Lc(){try{let t=Ne.getMultivariateAssignment("swapper-high-slippage-threshold"),e=Number(t);return!t||isNaN(e)?tA:e}catch{return tA}}var rA=({currentQuote:t,quoteResponse:e,gasEstimation:r,swapTransactions:o,scanResults:n,isSwapSimulationDisabled:i,slippageTolerance:c})=>{if(!t)throw new fe("Trying to execute swap with no current quote");if(!e)throw new fe("Trying to execute swap with no quote response");if(I.isEVMNetworkID(e.sellToken.chainId)&&(!r||r?.length===0||r?.length<(o?.transactions.length??1)))throw new fe("No gas estimation available");if(!o)throw new fe("No swap transactions available");if(n.state!=="valid"&&(M.addBreadcrumb("swapper","swapSimulationNotValid","info",Dr({scanResults:n.state})),!i)){let u=["Scan results are not valid","AccountFrozen","INSUFFICIENT_FUNDS","INSUFFICIENT_GAS","slippageToleranceExceeded","SIMULATION_TIMEOUT","MissingArgument","STALE_QUOTE","SimulationUnknownError"];if(MD(n.state)&&u.includes(n.state.code)){if(UD(n.state,c))return;throw n.state}else throw new fe("Scan results are not valid")}};function UD(t,e){return t.code==="slippageToleranceExceeded"&&e&&e>=Lc()}function MD(t){return t instanceof fe}var _D={swap:{solana:"executeSolanaSwap",evm:"executeEvmSwap",sui:"executeSuiSwap"},bridge:{solana:"executeSolanaBridge",evm:"executeEvmBridge",sui:"executeSuiBridge"}},jm=(t,e)=>_D[t?"bridge":"swap"][e??"solana"],oA=async({isBridge:t,addressType:e,isSwapSimulationDisabled:r,sender:o,currentQuote:n,quoteResponse:i,gasEstimation:c,swapTransactions:p,scanResults:u,pendingActivityRows:l,connection:f,logSwapFailureNoSignature:g,logTransactionSubmitted:y,onTransactionReceiptReceived:w,onTransactionSubmissionError:S,resetToInitialState:h,slippageTolerance:b,swapFungibles:E})=>{await M.startSpan({name:jm(t,p?.type)},async()=>{h();let T;try{rA({currentQuote:n,quoteResponse:i,gasEstimation:c,swapTransactions:p,scanResults:u,isSwapSimulationDisabled:r,slippageTolerance:b});let F=await E({type:e,callerAddress:o,swapTransactions:p,pendingSwapActivityRows:l.pendingSwapActivityRows,pendingApprovalActivityRows:l.pendingApprovalActivityRows,gasEstimation:c,connection:f});if(w(F),F.error)throw F.id||g(),T=F.id,F.error;y(F)}catch(F){let C=to(F);S(C,T)}})};s();a();s();a();s();a();s();a();var Fr=(u=>(u.SlippageExceeded="SLIPPAGE_EXCEEDED",u.InsufficientFunds="INSUFFICIENT_FUNDS",u.InsufficientGas="INSUFFICIENT_GAS",u.AccountFrozen="ACCOUNT_FROZEN",u.SimulationTimeout="SIMULATION_TIMEOUT",u.StaleQuote="STALE_QUOTE",u.UnknownError="UNKNOWN_ERROR",u.SimulationFailed="SIMULATION_FAILED",u))(Fr||{}),On=class t extends Error{constructor(r,o,n){super(r);this.scannedTransactionResult=o;this.type=n;o&&(this.detailMessage=o.simulationError?.humanReadableError??(o.warnings.length>0?o.warnings[0].message:void 0)),this.type=n}detailMessage;static fromError(r){return r instanceof t?r:new t(r.message)}static fromScannedTransactionResult(r,o){return(i=>Object.values(Fr).includes(i))(r)?new t(r,o,r):new t(r,o)}};s();a();var Lo=class t extends Error{constructor(r,o){super(r);this.type=o}static fromError(r){return new t(r.message)}static fromType(r){return new t(r,r)}};var nA="https://phantom.com",Uc=class{constructor(e,r,o){this.swapCommand=e;this.send=r;this.executingQuote=o;this.takerAddress=e.takerAddress,this.networkId=e.networkId,this.quote=e.quote,this.executionId=e.executionId}takerAddress;networkId;quote;executionId;createTransaction(){return this.send({type:"executeSwapStarted",executionId:this.executionId,executingQuote:this.executingQuote}),this.swapCommand.createTransaction()}async simulate(e,r,o){try{this.send({type:"simulationRequestStarted",executionId:this.executionId,executingQuote:this.executingQuote,networkId:this.networkId});let n,i=Ie(k.language)??"en";switch(I.isSuiNetworkID(this.networkId)?n={type:"transaction",expectedChanges:[],warnings:[],advancedDetails:void 0,error:void 0,simulationError:void 0,block:void 0}:n=await Pc({transactions:e,locale:i,url:nA,deviceId:o,takerAddress:this.takerAddress,networkId:this.networkId,slippageType:this.executingQuote.slippageType,quote:this.quote,quoteResponse:this.executingQuote.response}),n.error){case void 0:break;case"SIMULATION_FAILED":break;case"SLIPPAGE_EXCEEDED":if(this.executingQuote.response.slippageTolerance>=Lc())break;default:throw On.fromScannedTransactionResult(n.error,n)}return this.send({type:"simulationPassed",scannedTransactionResult:n,executionId:this.executionId,networkId:this.networkId}),n}catch(n){throw this.send({type:"simulationFailed",error:On.fromError(n),executionId:this.executionId,networkId:this.networkId,url:nA}),n}}async swap(e,r,o,n,i){this.send({type:"transactionSubmissionStarted",executionId:this.executionId});try{let c=await this.swapCommand.swap(e,r,o,n,i);if(!c.id)throw Lo.fromType("noSignature");return this.send({type:"transactionSubmissionSuccess",txReceipt:c,executionId:this.executionId}),c}catch(c){let p=c instanceof Lo?c:Lo.fromError(c);throw this.send({type:"transactionSubmissionFailed",error:p,executionId:this.executionId}),p}}async waitForConfirmation(e){this.send({type:"transactionConfirmationStarted",executionId:this.executionId,txReceipt:e});try{let r=await this.swapCommand.waitForConfirmation(e);return this.send({type:"transactionConfirmed",executionId:this.executionId,txReceipt:e}),r}catch(r){throw this.send({type:"transactionConfirmationFailed",error:r,txReceipt:e,executionId:this.executionId}),r}}};s();a();s();a();var Ym=class extends Error{constructor(e,r){super(`Can't transition to ${r} from ${e.type}`)}},Mc=class{state=new Map;listeners=new Set;send(e){e.type==="executeSwapStarted"&&this.state.set(e.executionId,{type:"idle",executingQuote:e.executingQuote});let r=this.state.get(e.executionId);if(!r)throw new Error(`No previous state found for execution id: ${e.executionId}`);let o=r;try{return o=this.detectNextState(r,e),o.type==="transactionConfirmed"?this.state.delete(e.executionId):this.state.set(e.executionId,o),o}catch{return r}finally{this.notifyListeners(e,r,o,this.state)}}notifyListeners(e,r,o,n){try{this.listeners.forEach(i=>i.onStateChange(e,r,o,n))}catch{}}getState(){return this.state}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}detectNextState(e,r){switch(r.type){case"executeSwapStarted":return Yt(e,"idle"),{type:"started",executingQuote:r.executingQuote};case"simulationRequestStarted":return Yt(e,"started"),{type:"simulating",executingQuote:e.executingQuote};case"simulationPassed":return Yt(e,"simulating"),{type:"simulated",scannedTransactionResult:r.scannedTransactionResult,executingQuote:e.executingQuote};case"simulationFailed":return Yt(e,"simulating"),{type:"simulationFailed",error:r.error,executingQuote:e.executingQuote};case"transactionSubmissionStarted":return Yt(e,"simulated"),{type:"submittingTransaction",executingQuote:e.executingQuote,scannedTransactionResult:e.scannedTransactionResult};case"transactionSubmissionFailed":return Yt(e,"submittingTransaction"),{type:"transactionSubmissionFailed",error:r.error,executingQuote:e.executingQuote,scannedTransactionResult:e.scannedTransactionResult};case"transactionSubmissionSuccess":return Yt(e,"submittingTransaction"),{type:"transactionSubmitted",txReceipt:r.txReceipt,executingQuote:e.executingQuote,scannedTransactionResult:e.scannedTransactionResult};case"transactionConfirmationStarted":return Yt(e,"transactionSubmitted"),{type:"confirmingTransaction",txReceipt:e.txReceipt,scannedTransactionResult:e.scannedTransactionResult,executingQuote:e.executingQuote};case"transactionConfirmationFailed":return Yt(e,"transactionSubmitted"),{type:"transactionNotConfirmed",txReceipt:e.txReceipt,scannedTransactionResult:e.scannedTransactionResult,error:r.error,executingQuote:e.executingQuote};case"transactionConfirmed":return Yt(e,"confirmingTransaction"),{type:"transactionConfirmed",txReceipt:e.txReceipt,scannedTransactionResult:e.scannedTransactionResult,executingQuote:e.executingQuote}}}};function Yt(t,e){if(t.type!==e)throw new Ym(t,e)}s();a();function iA(t){return t.type==="quote"}s();a();s();a();var qD={"Could not find any routes":"noRoute"},Oi=class t extends Error{type;constructor(e,r){super(r??e),this.type=e}static fromMessage(e){let r=e?qD[e]??"undefinedError":"undefinedError";return new t(r,e)}};var Mo=class extends Error{constructor(e,r){super(`Can't transition to ${r} from ${e.type}`)}},_c=class{state;listeners=new Set;constructor(e){this.state=e??{type:"idle"}}send(e){let r=this.state;try{return r=this.detectNextState(this.state,e),this.state=r,r}catch{return this.state}finally{this.notifyListeners(e,this.state,r)}}getState(){return this.state}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}notifyListeners(e,r,o){try{this.listeners.forEach(n=>n.onStateChange(e,r,o))}catch{}}detectNextState(e,r){switch(r.type){case"setPair":return{type:"pair",buy:r.buy,sell:r.sell,amount:r.amount};case"quoteRequestStarted":switch(e.type){case"pair":case"quote":case"quoteError":return{type:"fetchingQuote",buy:e.buy,sell:e.sell,amount:r.amount,slippageType:r.slippageType};default:throw new Mo(e,r.type)}case"quoteRequestError":if(e.type!=="fetchingQuote")throw new Mo(e,r.type);return{type:"quoteError",buy:e.buy,sell:e.sell,amount:e.amount,error:r.error,slippageType:e.slippageType};case"quoteResponseReceived":if(e.type!=="fetchingQuote")throw new Mo(e,r.type);let o=r.response.quotes[0];return o?{type:"quote",response:r.response,buy:e.buy,sell:e.sell,quote:o,amount:e.amount,slippageType:e.slippageType}:{type:"quoteError",buy:e.buy,sell:e.sell,amount:e.amount,error:new Oi("noRoute"),slippageType:e.slippageType};case"quoteResponseStreamed":switch(e.type){case"pair":case"fetchingQuote":case"quote":case"quoteError":return{type:"quote",response:r.response,buy:e.buy,sell:e.sell,quote:r.response.quotes[0],amount:{amount:r.quoteInput.amount,perspective:r.quoteInput.exactOut?"buy":"sell"},slippageType:r.quoteInput.autoSlippage?"auto":"fixed"};default:throw new Mo(e,r.type)}case"userSelectedQuote":if(e.type!=="quote")throw new Mo(e,r.type);return{type:"quote",quote:r.quote,buy:e.buy,sell:e.sell,response:e.response,amount:e.amount,slippageType:e.slippageType}}}};s();a();var Oc=class{constructor(e="native"){this.initializableTokenType=e}async initialize(e,r){try{let o=await Y.api().headers({"Content-Type":"application/json"}).timeout(X({seconds:20})).post("/swap/v2/initialize",{type:e.type,address:r.address,initializableTokenType:this.initializableTokenType,buyCaip19:e.buyCaip19,sellCaip19:e.sellCaip19});if(o.status!==200)throw new Ee({key:"SwapInitializationFailed"});return await o.data}catch(o){throw M.captureError(o,"swapper"),new Ee({key:"SwapInitializationFailed"})}}};s();a();var qc=class{state={type:"idle"};eventListeners=[];send(e){let r=this.state,o=this.detectNextState(e);this.state=o,this.eventListeners.forEach(n=>n.onStateChange(e,r,o))}detectNextState(e){switch(e.type){case"initializeStarted":return{type:"initializing",mode:e.mode};case"initializeCompleted":if(this.state.type==="initializing")return{type:"pair",mode:this.state.mode,sellToken:e.result.sellToken,buyToken:e.result.buyToken,sellTokenPrice:e.result.sellTokenPrice,buyTokenPrice:e.result.buyTokenPrice};throw new Error("Invalid state")}}getState(){return this.state}subscribe(e){this.eventListeners.push(e)}unsubscribe(e){this.eventListeners=this.eventListeners.filter(r=>r!==e)}};var qi=class{constructor(e,r,o,n){this.apiClient=e;this.swapCommandFactory=r;this.quoteProcessor=o;this.account=n,this.quoteProcessor.subscribe(this.quoteProcessorListener)}stateMachine=new _c;executeSwapStateMachine=new Mc;account;config={slippageType:"auto",slippageTolerance:1.3};swapInitializer=new Oc;tokenStateMachine=new qc;initializeSwap(e,r){let o=e.type==="buy"?e.buyCaip19:e.sellCaip19,n=Wo(o),i=this.checkChainAddress(n.chainId);this.tokenStateMachine.send({type:"initializeStarted",mode:e}),this.swapInitializer.initialize(e,i,r).then(c=>{this.tokenStateMachine.send({type:"initializeCompleted",result:c}),this.setPair(c.buyToken,c.sellToken,{amount:"0",perspective:"sell"})}).catch(c=>{console.error("initializeSwap error",c)})}getTokenState(){return this.tokenStateMachine.getState()}subscribeToken(e){return this.tokenStateMachine.subscribe(e),()=>this.unsubscribeToken(e)}unsubscribeToken(e){this.tokenStateMachine.unsubscribe(e)}quoteProcessorListener={onStateChange:(e,r)=>{(r.type==="firstQuoteReceived"||r.type==="quoteProcessed")&&this.send({type:"quoteResponseStreamed",response:r.response,quoteInput:r.input})}};isValidAmount(e){try{let r=new V(e);return r.isFinite()?!r.isNegative():!1}catch{return!1}}setAmount(e,r){let{amount:o}=e;if(o===""&&(o="0"),!this.isValidAmount(o))return;this.quoteProcessor.stop();let n=this.checkAccount(),i=this.getState(),c={...this.config,...r};switch(i.type){case"pair":case"quote":case"quoteError":if(o==="0"||o===""){this.send({type:"setPair",buy:i.buy,sell:i.sell,amount:e});return}let p=this.checkChainAddress(i.sell.data.chain.id),u=this.checkChainAddress(i.buy.data.chain.id),l={chainId:p.networkID,resourceType:"address",address:p.address},f={chainId:u.networkID,resourceType:"address",address:u.address};try{let g={amount:new V(e.amount).shiftedBy(e.perspective==="buy"?i.buy.data.decimals:i.sell.data.decimals).toString(),buy:i.buy,sell:i.sell,taker:J(l),takerDestination:J(f),slippageTolerance:c.slippageTolerance,autoSlippage:c.slippageType==="auto",exactOut:e.perspective==="buy",priorityFee:c.priorityFee};this.quoteProcessor.start(g,n)}catch(g){console.error("Error when streaming quotes",g)}break}}setPair(e,r,o){this.send({type:"setPair",buy:e,sell:r,amount:o})}setAccount(e){this.account=e}getAccount(){return this.account}async fetchQuotes({amount:e,buy:r,sell:o,slippageTolerance:n,autoSlippageEnabled:i,priorityFee:c,signal:p}){let u=z(o),l=z(r),f=e.perspective==="buy",g=new V(e.amount).shiftedBy(e.perspective==="buy"?r.data.decimals:o.data.decimals).toString();this.send({type:"quoteRequestStarted",amount:e,slippageType:i?"auto":"fixed"});let y=this.checkChainAddress(o.data.chain.id),w={chainId:y.networkID,resourceType:"address",address:y.address},S;if(Re(o.data.chain.id,r.data.chain.id)){let h=this.checkChainAddress(r.data.chain.id);S={chainId:h.networkID,resourceType:"address",address:h.address}}try{let h=await this.apiClient.getQuotes({sell:u,buy:l,amount:g,taker:w,takerDestination:S,slippageTolerance:n??0,autoSlippageEnabled:i,exactOutEnabled:f,priorityFee:c,signal:p});return this.send({type:"quoteResponseReceived",response:h}),h}catch(h){throw this.send({type:"quoteRequestError",error:h}),h}}async swap(e,r,o,n,i,c){let p=this.getState();if(!iA(p))throw new Error(`Can't swap from ${p.type}`);this.quoteProcessor.stop();let u=this.checkAccount(),l=this.checkChainAddress(p.sell.data.chain.id),f={account:u,buy:p.buy,sell:p.sell,amount:p.amount,quote:p.quote,response:p.response,slippageType:p.slippageType},g=this.swapCommandFactory.create(f,l.address,l.networkID,i,c),y=new Uc(g,S=>this.executeSwapStateMachine.send(S),f),w=await y.createTransaction();await M.startSpan({name:jm(ae(p.quote),w.type)},async()=>{let S=await y.simulate(w,o,n),h=await y.swap(u.identifier,w,S,e,r);await y.waitForConfirmation(h)})}selectQuote(e){this.send({type:"userSelectedQuote",quote:e})}setQuoteConfig(e){this.config={...this.config,...e};let r=this.getQuoteProcessorState();switch(r.type){case"starting":case"firstQuoteReceived":case"quoteProcessed":this.setAmount({amount:r.input.amount,perspective:r.input.exactOut?"buy":"sell"});break}}getState(){return this.stateMachine.getState()}getExecuteState(){return this.executeSwapStateMachine.getState()}stopProcessingQuotes(){this.quoteProcessor.stop()}subscribeExecution(e){return this.executeSwapStateMachine.addListener(e),()=>this.unsubscribeExecution(e)}unsubscribeExecution(e){this.executeSwapStateMachine.removeListener(e)}getQuoteProcessorState(){return this.quoteProcessor.getState()}subscribeQuoteProcessor(e){return this.quoteProcessor.subscribe(e),()=>this.unsubscribeQuoteProcessor(e)}unsubscribeQuoteProcessor(e){this.quoteProcessor.unsubscribe(e)}stopQuoteProcessor(){this.quoteProcessor.stop()}send(e){return this.stateMachine.send(e)}checkAccount(){if(!this.account)throw new Error("Must set a MultiChainAccount");return this.account}checkChainAddress(e){let o=this.checkAccount().addresses.find(n=>n.networkID===e);if(!o)throw new Error(`No address found for chain ${e}`);return ns(o)&&(o.address=o.address.toLowerCase()),o}};var aA=(0,Xt.createContext)(null);function GD({children:t,processorMode:e="noOp"}){let{data:r}=ue(),o=(0,Xt.useMemo)(()=>KD(e),[e]);return(0,Xt.useEffect)(()=>{r&&o.setAccount(r)},[r,o]),Xt.default.createElement(aA.Provider,{value:o},t)}function Jt(){let t=(0,Xt.useContext)(aA);if(!t)throw new Error("useSwapper must be used within a SwapperProvider");return t}function KD(t){return new qi(new Sc,new vc,new Qc(new Fc($e?new Ic:new xc),t==="noOp"?new Nc:new Dc))}s();a();s();a();var Vc=D(U());s();a();s();a();s();a();var HD=D(U());s();a();var cA=D(U());s();a();s();a();var Dt=D(U());s();a();s();a();s();a();s();a();function Gc({buyAssetUsdValue:t,buyToken:e,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:i,phantomFeeUiAmount:c,priceImpact:p,provider:u,baseProvider:l,slippageTolerance:f,transactionId:g,slippageType:y,sellSwapFilter:w,isRetry:S,analyticsContext:h}){let b=dh({buyAssetUsdValue:t,buyToken:e,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:i,phantomFeeUiAmount:c,priceImpact:p,provider:u,baseProvider:l,slippageTolerance:f,slippageType:y,sellSwapFilter:w,isRetry:S,analyticsContext:h});return b?{data:{...b,id:g}}:{}}s();a();var Kc=({txReceipt:t,networkID:e,amountType:r,swapAnalytics:o})=>{let n=Qr(e);M.addBreadcrumb("swapper","submittedTransaction","info",{...n,txReceipt:t.id,method:n.chainType==="solana"?"signAndSendTransaction":n.chainType==="eip155"?"eth_sendRawTransaction":n.chainType==="sui"?"signAndExecuteTransaction":"UNKNOWN"}),n.chainType==="solana"?o.submittedTransaction(t.id,{...n,method:"signAndSendTransaction",swapType:r==="sell"?"exactIn":"exactOut"}):n.chainType==="eip155"?o.submittedTransaction(t.id,{...n,method:"eth_sendRawTransaction",swapType:r==="sell"?"exactIn":"exactOut"}):n.chainType==="sui"&&o.submittedTransaction(t.id,{...n,method:"signAndExecuteTransaction",swapType:r==="sell"?"exactIn":"exactOut"})};s();a();var ro=t=>t?ae(t)?void 0:t.priceImpact:0;s();a();var pA=Fe(t=>({lastFailedSwap:void 0,setLastFailedSwap:e=>{t({lastFailedSwap:e})}}));function uA(){return pA.getState().lastFailedSwap}function Xm(t){pA.getState().setLastFailedSwap(t)}var Vi=class{constructor(e,r){this.swapAnalytics=e;this.analytics=r}onStateChange(e,r,o,n){switch(e.type){case"executeSwapStarted":this.analytics.capture("swapperSwap");let i=Di({buyAssetUsdValue:o.executingQuote.buy.data.usd,buyToken:o.executingQuote.buy,sellAssetUsdValue:o.executingQuote.sell.data.usd,sellToken:o.executingQuote.sell,quote:o.executingQuote.quote,slippageTolerance:this.parseSlippageTolerance(o.executingQuote.slippageType,o.executingQuote.quote,o.executingQuote.response),slippageType:o.executingQuote.slippageType,sellSwapFilter:A.getState().swapFilter,isRetry:this.isRetry(o.executingQuote),analyticsContext:o.executingQuote.quote.analyticsContext,baseProvider:o.executingQuote.quote.baseProvider?.id??""});i&&(M.addBreadcrumb("swapper","approved","info",Dr(i.swap)),this.swapAnalytics.approved(i));break;case"simulationFailed":e.error.type!=="SLIPPAGE_EXCEEDED"&&M.captureError(e.error,"swapper"),this.analytics.capture("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:$D(e.error)}});break;case"transactionSubmissionFailed":M.captureError(e.error,"swapper"),e.error.type==="noSignature"&&this.analytics.capture("swapperSwapFailureNoSignature"),this.analytics.capture("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:e.error.message}});break;case"transactionSubmissionSuccess":Kc({txReceipt:e.txReceipt,networkID:e.txReceipt.networkID,amountType:o.executingQuote.amount.perspective==="buy"?"buy":"sell",swapAnalytics:this.swapAnalytics});break;case"transactionConfirmationFailed":let c=to(e.error);M.captureError(e.error,"swapper"),this.analytics.capture("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:c.message}});let p=Qr(e.txReceipt.networkID),u={chainId:I.getChainID(e.txReceipt.networkID),networkId:e.txReceipt.networkID},l=e.txReceipt;switch(this.analytics.capture("waitForTransactionConfirmationError",{data:{...u,errorMessage:c.message}}),p.chainType){case"eip155":case"solana":case"sui":M.addBreadcrumb("swapper","transactionStatus","error",{...p,txReceipt:l.id}),this.swapAnalytics.transactionStatus(l.id,{...p,status:{type:"error"}});break}break;case"transactionConfirmed":this.analytics.capture("swapperSwapSuccess",this.createAnalyticsPayload(o.executingQuote));let f=Qr(e.txReceipt.networkID);switch(M.addBreadcrumb("swapper","transactionStatus","info",{...f,txReceipt:e.txReceipt.id}),f.chainType){case"eip155":case"solana":case"sui":this.swapAnalytics.transactionStatus(e.txReceipt.id,{...f,status:{type:"confirmed"}});break}break}this.isFailureEvent(e)?Xm(o.executingQuote):e.type==="transactionSubmissionSuccess"&&Xm(void 0)}createAnalyticsPayload(e,r){let o=e.quote,n=A.getState();return Gc({buyToken:e.buy,sellToken:e.sell,buyAmount:o.buyAmount.toString(),sellAmount:o.sellAmount.toString(),phantomFeeUiAmount:pm(o).amountUsd?.toString()??"",priceImpact:ro(o),provider:Te(Ce(o)),buyAssetUsdValue:n.buyUsdValue,sellAssetUsdValue:n.sellUsdValue,slippageTolerance:this.parseSlippageTolerance(e.slippageType,o,e.response),transactionId:r?.id??"",slippageType:e.slippageType,sellSwapFilter:n.swapFilter,isRetry:this.isRetry(e),analyticsContext:e.quote.analyticsContext,baseProvider:e.quote.baseProvider?.id??""})}parseSlippageTolerance(e,r,o){switch(e){case"fixed":return o.slippageTolerance;case"auto":return Ht(r)?r.slippageTolerance:o.slippageTolerance}}isRetry(e){let r=uA();if(!r)return!1;let o=J(z(r.buy)),n=J(z(r.sell)),i=J(z(e.buy)),c=J(z(e.sell));return o===i&&n===c}isFailureEvent(e){switch(e.type){case"simulationFailed":case"transactionSubmissionFailed":case"transactionConfirmationFailed":return!0;default:return!1}}};function $D(t){switch(t.type){case"SLIPPAGE_EXCEEDED":return"slippageToleranceExceeded";case"INSUFFICIENT_FUNDS":return"INSUFFICIENT_FUNDS";case"INSUFFICIENT_GAS":return"INSUFFICIENT_GAS";case"ACCOUNT_FROZEN":return"AccountFrozen";case"STALE_QUOTE":return"STALE_QUOTE";case"SIMULATION_TIMEOUT":return"SIMULATION_TIMEOUT";case"UNKNOWN_ERROR":return"SimulationUnknownError";case"SIMULATION_FAILED":return"SIMULATION_FAILED";default:return"Scan results are not valid"}}s();a();var Gi=class{constructor(e){this.queryClient=e}onStateChange(e,r,o,n){let{sell:i,quote:c,account:p}=o.executingQuote;if(e.type==="transactionConfirmed"){let u=new H(i.data.amount),l=new H(c.sellAmount),f=u.minus(l).toString();tc(this.queryClient,{id:Dn(i),amount:f}),this.queryClient.invalidateQueries({queryKey:ff.tokens(p.addresses)})}}};s();a();var zD="swap-validation",Ki=class{simulationAnalytics;constructor(e){this.simulationAnalytics=new Io(e)}onStateChange(e,r,o){switch(e.type){case"simulationPassed":let n=e.scannedTransactionResult;this.simulationAnalytics.onScannedTransactionByUser({networkId:e.networkId,warnings:n.warnings.map(c=>c.severity),shouldBlock:!!n.block,errorCode:n.error??""});break;case"simulationFailed":let i=e.error.scannedTransactionResult;if(i){this.simulationAnalytics.onScannedTransactionByUser({networkId:e.networkId,warnings:i.warnings.map(c=>c.severity),shouldBlock:!!i.block,errorCode:i.error??""}),i?.error&&M.addBreadcrumb(zD,`Simulation error: ${JSON.stringify({error:i.error})}`,"info");return}this.simulationAnalytics.onFailedScannedTransactionByUser({networkId:e.networkId,url:e.url}),M.addBreadcrumb("simulation",`networkID: ${e.networkId}, url: ${e.url}, type: transaction`,"info");break}}};s();a();var Hi=class{onStateChange(e,r,o,n){let i=this.toLegacyTransition(e,o);i&&Da(i.nextState,i.event)}toLegacyTransition(e,r){let{buy:o,sell:n,quote:i,response:c}=r.executingQuote;switch(e.type){case"simulationFailed":return{event:{type:"simulationRequestError",error:e.error},nextState:{type:"simulationFailed",buy:o,sell:n,response:c,quote:i,scannedTransactionResult:e.error.scannedTransactionResult,simulationError:e.error.message}};case"transactionSubmissionFailed":return{event:{type:"transactionSubmissionFailed",error:e.error},nextState:{type:"transactionSubmissionFailed",buy:o,sell:n,response:c,quote:i,error:e.error}};case"transactionConfirmationFailed":return{event:{type:"transactionConfirmationFailed",error:e.error,txReceipt:e.txReceipt},nextState:{type:"transactionNotConfirmed",buy:o,sell:n,response:c,quote:i,error:e.error,txReceipt:e.txReceipt}};default:return}}};s();a();s();a();s();a();var oo=t=>t&&ae(t)?t.executionDuration:0;var Hc=t=>{let e=oo(t);return Ft(e)};s();a();s();a();var jD=3e3,ct=Fe(t=>({toast:void 0,toastId:void 0,visible:!1,currentTimer:null,hideToast(e){t(r=>e&&r.toastId!==e?r:(r.currentTimer&&clearTimeout(r.currentTimer),{visible:!1,currentTimer:null}))},removeToast(){t(e=>(e.currentTimer&&clearTimeout(e.currentTimer),{toast:void 0,toastId:void 0,visible:!1,currentTimer:null}))},success(e){t(r=>{r.currentTimer&&clearTimeout(r.currentTimer);let o=setTimeout(()=>{t({visible:!1,currentTimer:null})},jD);return{toast:{type:"Success",...e},toastId:e.id??pt(),visible:!0,currentTimer:o}})},failed(e){t(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:"Failed",...e},toastId:e.id??pt(),visible:!0,currentTimer:null}))},progress(e){t(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:"Progress",...e},toastId:e.id??pt(),visible:!0,currentTimer:null}))},message(e){t(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:"Default",...e},toastId:e.id??pt(),visible:!0,currentTimer:null}))}}));s();a();s();a();function lA({sell:t,buy:e,onBuyFungiblePress:r}){let o=`${k.t("swapTxConfirmationSwapFailed")} ${t.data.symbol} \u2192 ${e.data.symbol}`,n=I.getChainDefinition(t.data.chain.id).tokenSymbol,i=k.t("buyAssetInterpolated",{tokenSymbol:n});return{title:o,message:k.t("swapTabInsufficientFunds"),onPress:r,buttonText:i}}s();a();function mA(t){switch(t.type){case"SLIPPAGE_EXCEEDED":return k.t("swapTxConfirmationSwapFailedSlippageLimit");case"INSUFFICIENT_FUNDS":return k.t("swapTxConfirmationSwapFailedInsufficientBalance");case"INSUFFICIENT_GAS":return k.t("swapTxConfirmationSwapFailedInsufficientGas");case"ACCOUNT_FROZEN":return k.t("swapTxConfirmationSwapFailedAcountFrozen");case"SIMULATION_TIMEOUT":return k.t("swapTxConfirmationSwapFailedSimulationTimeout");case"STALE_QUOTE":return k.t("swapTxConfirmationSwapFailedStaleQuote");case"UNKNOWN_ERROR":return k.t("swapTxConfirmationSwapFailedSimulationUnknownError");default:return k.t("swapTxConfirmationSwapFailedTryAgain")}}function dA(t,e,r,o,n,i){let{sell:c,buy:p}=e,u=YD(t,c,p,n,o,r,i);return u||{title:`${k.t("swapTxConfirmationSwapFailed")} ${c.data.symbol} \u2192 ${p.data.symbol}`,message:mA(t),onPress:()=>{ct.getState().hideToast(),o()},buttonText:k.t("commandRetry")}}function YD(t,e,r,o,n,i,c){if(!(t.type&&!c.includes(t.type)))switch(t.type){case"INSUFFICIENT_FUNDS":return lA({sell:e,buy:r,onBuyFungiblePress:()=>{ct.getState().hideToast(),i()}});case"SLIPPAGE_EXCEEDED":return o.selectedSetting.type==="auto"?void 0:{title:k.t("swapEnableAutoSlippageTitleToast",{sellSymbol:e.data.symbol,buySymbol:r.data.symbol}),buttonText:k.t("swapEnableAutoSlippageButtonToast"),message:"",onPress:()=>{o.setSlippageSetting({type:"auto"}),n(),ct.getState().hideToast()}}}}var $i=class{constructor(e,r,o,n,i,c=ZD){this.showFungibleDetails=e;this.showBuyFungibleScreen=r;this.slippageSettings=o;this.supportedCustomSimulationToastErrorTypes=n;this.retryAndNavigateToSwapper=i;this.toastMessageParser=c}onStateChange(e,r,o,n){let{sell:i,buy:c,quote:p}=o.executingQuote;switch(e.type){case"executeSwapStarted":XD(ae(p)?k.t("swapInitiatingBridgeToast",{sellSymbol:i.data.symbol,sellChain:i.data.chain.name,buySymbol:c.data.symbol,buyChain:c.data.chain.name}):k.t("swapSwappingToast",{sellSymbol:i.data.symbol,buySymbol:c.data.symbol}));break;case"transactionConfirmed":JD(this.toastMessageParser.parseTransactionConfirmed(i,c,p),()=>this.showFungibleDetails(c));break;case"simulationFailed":fA(dA(e.error,o.executingQuote,this.showBuyFungibleScreen,()=>this.handleRetryPress(o.executingQuote),this.slippageSettings,this.supportedCustomSimulationToastErrorTypes));break;case"transactionSubmissionFailed":case"transactionConfirmationFailed":fA({title:`${k.t("swapTxConfirmationSwapFailed")} ${i.data.symbol} \u2192 ${c.data.symbol}`,message:k.t("swapTxConfirmationSwapFailedUnknownError"),onPress:()=>{this.handleRetryPress(o.executingQuote)},buttonText:k.t("commandRetry")});break}}handleRetryPress(e){ct.getState().hideToast(),this.retryAndNavigateToSwapper(e)}};function XD(t){ct.getState().progress({message:t,onPress:()=>{ct.getState().hideToast()}})}function JD(t,e){ct.getState().success({id:"swap-success",message:t,onPress:()=>{ct.getState().hideToast(),e()}})}function fA(t){ct.getState().failed(t)}var ZD={parseTransactionConfirmed(t,e,r){return ae(r)?k.t("swapBridgeInitiatedToast",{sellSymbol:t.data.symbol,sellChain:t.data.chain.name,buySymbol:e.data.symbol,buyChain:e.data.chain.name,estimatedTime:Hc(r)}):k.t("swapSwappedToast",{sellSymbol:t.data.symbol,buySymbol:e.data.symbol})}};var $c=class{intercept(e){let{swapper:r,connection:o,storage:n,vaultProxy:i,locale:c,analytics:p,resetSwapper:u,queryClient:l,showFungibleDetails:f,showBuyFungibleScreen:g,swapAnalytics:y,gasEstimation:w,slippageSettings:S,supportedCustomSimulationToastErrorTypes:h,navigateToSwapper:b,storePairs:E,isMobile:T}=e;if(!T||r.getAccount()?.type==="ledger")return"continue";let C=r.getState();if(C.type!=="quote")return"continue";let{quote:B,sell:q,buy:L}=C;return this.isSupportedQuote(B)?((async()=>{E(q,L);let K=await p.getDeviceId(),G=new $i(f,g,S,h,_=>{b(_)}),v=new Gi(l),x=new Vi(y,p),P=new Ki(p),Q=new Hi;try{r.subscribeExecution(v),r.subscribeExecution(P),r.subscribeExecution(x),r.subscribeExecution(G),r.subscribeExecution(Q),await Promise.all([r.swap(i,n,c,K,o,w),u()])}catch{}finally{r.unsubscribeExecution(v),r.unsubscribeExecution(P),r.unsubscribeExecution(x),r.unsubscribeExecution(G),r.unsubscribeExecution(Q)}})(),"interrupt"):"continue"}isSupportedQuote(e){return br(e)||mt(e)||Ar(e)||ae(e)}};s();a();s();a();var zc=class{intercept({hasViewedAutoSlippageOptIn:e,selectedSetting:r,setHasViewedAutoSlippageOptIn:o,showOverlay:n}){return!e&&r!=="auto"?(n("autoSlippageOptIn"),o(!0),"interrupt"):"continue"}};s();a();var Wc=class{intercept(){let{review:e}=zr();return e?hr(e):xo(),"continue"}};function gA(t,e,r){let o=[];return t&&o.push(new zc),r&&o.push(new $c),e||o.push(new Wc),o}s();a();var jc=class{async fetch(e){return await yc(e)}stopFetching(){}getFetchInterval(e){return e}};s();a();var Yc=class{constructor(e){this.swapper=e}async fetch(e){let r=tN(e.amount,e.sell,e.buy);return this.swapper.setPair(e.buy,e.sell,r),await this.swapper.fetchQuotes({buy:e.buy,sell:e.sell,amount:r,slippageTolerance:e.slippageTolerance,autoSlippageEnabled:e.enableAutoSlippage,priorityFee:e.priorityFee})}stopFetching(){this.swapper.stopProcessingQuotes()}getFetchInterval(e){return e}};function tN(t,e,r){let o=t.type==="sell"?e:r;return{amount:new V(t.value).shiftedBy(-o.data.decimals).toString(),perspective:t.type}}s();a();var Xc=class{constructor(e,r){this.swapper=e;this.queryClient=r}queryKey;quoteProcessorListener={onStateChange:(e,r)=>{if(!this.queryKey){console.error("queryKey is not set");return}r.type==="quoteProcessed"&&this.queryClient.setQueryData(this.queryKey,r.response)}};async fetch(e,r){return this.queryKey=r,this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener),new Promise((o,n)=>{let i=rN(e.amount,e.sell,e.buy),c={onStateChange:(p,u)=>{switch(u.type){case"firstQuoteReceived":o(u.response),this.swapper.unsubscribeQuoteProcessor(c);break;case"error":n(u.error),this.swapper.unsubscribeQuoteProcessor(c),this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener);break}}};this.swapper.subscribeQuoteProcessor(this.quoteProcessorListener),this.swapper.subscribeQuoteProcessor(c),this.swapper.setPair(e.buy,e.sell,i),this.swapper.setAmount(i,{slippageTolerance:e.slippageTolerance,slippageType:e.enableAutoSlippage?"auto":"fixed",priorityFee:e.priorityFee})})}stopFetching(){this.swapper.getQuoteProcessorState().type!=="idle"&&(this.swapper.stopProcessingQuotes(),this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener))}getFetchInterval(e){return!1}};function rN(t,e,r){let o=t.type==="sell"?e:r;return{amount:new V(t.value).shiftedBy(-o.data.decimals).toString(),perspective:t.type}}s();a();var Jm=D(U());var yA=()=>{let t=(0,Jm.useCallback)(()=>{hr()},[]),e=(0,Jm.useCallback)(()=>{xo()},[]);return{onSwapTabEnter:t,onSwapTabExit:e}};var SA=(0,Dt.createContext)(void 0),oN=({children:t})=>{let{data:[e,r,o,n,i,c]}=me(["enable-auto-slippage","enable-swapper-skip-review","enable-swapper-toasts","enable-swapper-toasts-auto-slippage","enable-swapper-keypad-swap","enable-quote-streaming"]),p=(0,Dt.useMemo)(()=>e?["auto","fixed"]:["fixed"],[e]),u=(0,Dt.useMemo)(()=>n?["SLIPPAGE_EXCEEDED"]:[],[n]),l=(0,Dt.useMemo)(()=>gA(e,r,o),[e,r,o]),f=fp,g=r,y=Jt(),w=j(),S=(0,Dt.useMemo)(()=>c?new Xc(y,w):o&&$e?new Yc(y):new jc,[y,o,c,w]),{onSwapTabEnter:h,onSwapTabExit:b}=yA();return Dt.default.createElement(SA.Provider,{value:{slippageSettingTypes:p,reviewInterceptors:l,inspectorEnabled:f,showStickyCTAButton:g,getSwapQuotesStrategy:S,supportedCustomSimulationToastErrorTypes:u,showKeypadSwapButton:i,onSwapTabEnter:h,onSwapTabExit:b}},t)},Zm=()=>{let t=(0,Dt.useContext)(SA);if(!t)throw new Error("useSwapTab must be used within a SwapTabProvider");return t};s();a();var nN="https://help.phantom.com/hc/en-us/articles/33745013398675";s();a();var iN=t=>Ra.safeParse(t).success;s();a();var no=D(U());s();a();s();a();function wA(){return zr().review!==null?1:0}var hA=(0,no.createContext)(void 0),aN=({children:t})=>{let e=(0,no.useMemo)(()=>wA(),[]);return no.default.createElement(hA.Provider,{value:{infoRowDisplayStrategy:e}},t)},cN=()=>{let t=(0,no.useContext)(hA);if(!t)throw new Error("useSwapReview must be used within a SwapReviewProvider");return t};s();a();var _o=D(U());var pN=d.object({programId:d.string(),complete:d.boolean(),progress:d.string()}),uN=d.object({bondingCurves:d.record(d.string(),pN)});function lN(t){let e=bA(t),o=j().getQueryData(e.queryKey),{data:n,isFetching:i,isError:c}=W({...e,initialData:o,staleTime:0}),p=(0,_o.useMemo)(()=>xr(),[]);return(0,_o.useMemo)(()=>{let u=o===n;if(i&&!u)return{type:"Loading"};if(c)return{type:"Error"};let l=uN.safeParse(n);if(!l.success)return{type:"Error"};let f=l.data.bondingCurves[t];if(!f)return{type:"NoBondingCurve"};let g=p.find(w=>w.programId===f.programId);if(!g)return{type:"NoBondingCurve"};let y=fN(f.progress);return y?f.complete?{type:"Graduated",ugcProgram:g}:{type:u&&i?"BondingCurveRefreshing":"BondingCurve",progressPercentage:y,ugcProgram:g}:{type:"Error"}},[o,t,n,c,i,p])}var mN=t=>{let e=j(),r=bA(t);return(0,_o.useCallback)(async()=>{await e.refetchQueries({queryKey:r.queryKey,type:"active"})},[e,r.queryKey])},bA=t=>{let e=(0,_o.useMemo)(()=>xr(),[]),r=(0,_o.useMemo)(()=>e.map(n=>n.programId),[e]);return{queryKey:["bonding-curve",t,r],queryFn:()=>dN(t,r)}},dN=async(t,e)=>(await Y.api().post("/ugc/v1/bonding-curve",{tokens:[t],programIds:e})).data,fN=t=>{let e=Number(t);if(!isNaN(e))return Math.round(e*100)};s();a();var dt=D(U());s();a();s();a();var Pr=D(U());s();a();var AA=({networkID:t,txReceipt:e,preferredExplorers:r})=>{let o=e?.id??"";if(!o)return;let n=r?.explorers[t];return Md({networkID:t,endpoint:"transaction",explorerType:n,param:o})};s();a();function TA(t,e){if(e){let r=gN(t),o=SN(t,e),n=wN(t,e);return{notEnoughSol:e.message==="NotEnoughSol",txErrorTitle:r,txErrorMessage:o,txErrorHelpButtonLink:n}}return{notEnoughSol:!1,txErrorTitle:"",txErrorMessage:"",txErrorHelpButtonLink:""}}var gN=t=>t?k.t("swapTxBridgeFailed"):k.t("swapTxConfirmationSwapFailed"),yN=t=>{switch(t.message){case"LedgerConnectionError":return k.t("swapTxConfirmationSwapFailedLedgerConnectionError");case"LedgerRejectAction":return k.t("swapTxConfirmationSwapFailedLedgerReject");case"LedgerUnknownSignError":return k.t("swapTxConfirmationSwapFailedLedgerSignError");case"LedgerUnknownError":return k.t("swapTxConfirmationSwapFailedLedgerError");default:return null}},SN=(t,e)=>{let r=yN(e);if(r!==null)return r;if(t)switch(e.message){case"slippageToleranceExceeded":return k.t("swapTxConfirmationSwapFailedSlippageLimit");default:return k.t("swapTxBridgeFailedDescription")}else switch(e.message){case"INSUFFICIENT_FUNDS":return k.t("swapTxConfirmationSwapFailedInsufficientBalance");case"slippageToleranceExceeded":return k.t("swapTxConfirmationSwapFailedSlippageLimit");case"EmptyRoute":return k.t("swapTxConfirmationSwapFailedEmptyRoute");case"AccountFrozen":return k.t("swapTxConfirmationSwapFailedAcountFrozen");case"SIMULATION_TIMEOUT":return k.t("swapTxConfirmationSwapFailedSimulationTimeout");case"INSUFFICIENT_GAS":return k.t("swapTxConfirmationSwapFailedInsufficientGas");case"Scan results are not valid":return k.t("swapTxConfirmationSwapFailedUnknownError");case"STALE_QUOTE":return k.t("swapTxConfirmationSwapFailedStaleQuote");case"SimulationUnknownError":return k.t("swapTxConfirmationSwapFailedSimulationUnknownError");default:return k.t("swapTxConfirmationSwapFailedTryAgain")}},wN=(t,e)=>t?Fa:e.message==="AccountFrozen"?Bw:Fa;s();a();var vA=({sellAmount:t,sellFungible:e,buyAmount:r,buyFungible:o,txStatus:n,txReceipt:i,swapTransactions:c,isReadyToExecute:p,uiEstimatedTime:u,isBridge:l,isLedger:f,notEnoughSol:g,txError:y,txErrorTitle:w,txErrorMessage:S,explorerUrl:h,txErrorHelpButtonLink:b,addressType:E})=>{let T=ne(t,e?.data.decimals??0).toNumber(),F=ne(r,o?.data.decimals??0).toNumber(),C=n==="success",B=n==="error",q=!!i,L=c?.transactions.length||0;return{sellAsset:{amount:T,symbol:e?.data.symbol??"",networkID:e?.data.chain.id??ee.Solana.Mainnet},buyAsset:{amount:F,symbol:o?.data.symbol??"",networkID:o?.data.chain.id??ee.Solana.Mainnet},estimatedTime:u,isBridge:l,isSuccess:C,isFailure:B,isLedger:f,isClosable:q,notEnoughSol:g,txError:y,txErrorTitle:w,txErrorMessage:y?.detailMessage?`${S}

${y?.detailMessage}`:S,txLink:h??"",txErrorHelpButtonLink:b,numberOfTransactions:L,isReadyToExecute:p,addressType:E}};var ed=({sellFungible:t,txReceipt:e,swapTransactions:r,isBridge:o,txError:n,txStatus:i,isReadyToExecute:c,isLedger:p})=>{let u=t?.data.chain.id??ee.Solana.Mainnet,{notEnoughSol:l,txErrorTitle:f,txErrorMessage:g,txErrorHelpButtonLink:y}=(0,Pr.useMemo)(()=>TA(o,n),[o,n]),w=(0,Pr.useMemo)(()=>I.getAddressType(u),[u]),{currentQuote:S}=Z(),[h]=(0,Pr.useState)(S),{buyAmount:b,sellAmount:E}=h??{buyAmount:"0",sellAmount:"0"},T=A(L=>L.buyFungible),{data:F}=Od(),C=(0,Pr.useMemo)(()=>AA({txReceipt:e,networkID:u,preferredExplorers:F}),[e,u,F]),B=(0,Pr.useMemo)(()=>Hc(h),[h]);return(0,Pr.useCallback)(()=>vA({sellFungible:t,txReceipt:e,addressType:w,swapTransactions:r,isBridge:o,txError:n,sellAmount:E,buyAmount:b,buyFungible:T,txStatus:i,isReadyToExecute:c,uiEstimatedTime:B,isLedger:p,notEnoughSol:l,txErrorTitle:f,txErrorMessage:g,explorerUrl:C,txErrorHelpButtonLink:y}),[t,e,w,r,o,n,E,b,T,i,c,B,p,l,f,g,C,y])()};s();a();var qn=D(U());var Oo=()=>{let t=te(),e=Fo(),{currentQuote:r,quoteResponse:o,selectedProviderIndex:n,selectedBaseProvider:i}=Z(),{analyticsContext:c}=r??{analyticsContext:void 0},p=A(L=>L.buyFungible),u=A(L=>L.sellFungible),l=A(L=>L.buyUsdValue),f=A(L=>L.sellUsdValue),g=A(L=>L.swapFilter),{selectedSetting:y}=ve(),w=A.getState().amountType,S=u?.data.chain.id??ee.Solana.Mainnet,h=Ct(),{transition:b}=Tr(),E=(0,qn.useCallback)(L=>{let K=Wr(n,y.type,o);return Gc({buyToken:p,sellToken:u,buyAmount:r?.buyAmount.toString()??"",sellAmount:r?.sellAmount.toString()??"",phantomFeeUiAmount:h.phantomFee.amountUsd?.toString()??"",priceImpact:ro(r),provider:Te(Ce(r)),baseProvider:i,buyAssetUsdValue:l,sellAssetUsdValue:f,slippageTolerance:K,transactionId:L??"",slippageType:y.type,sellSwapFilter:g,analyticsContext:c})},[p,u,r,h.phantomFee.amountUsd,l,f,o,n,y.type,g,c,i]),T=(0,qn.useCallback)(L=>{Kc({txReceipt:L,networkID:S,amountType:w,swapAnalytics:e})},[S,w,e]),F=(0,qn.useCallback)((L,K)=>{b({type:"transactionSubmissionFailed",error:L}),L.message!=="Scan results are not valid"&&L.message!=="slippageToleranceExceeded"&&M.captureError(L,"swapper");let G=E(K);t.capture("swapperSwapFailure",{data:{...G.data,error:L.message}})},[t,E,b]),C=()=>{t.capture("swapperSwapFailureNoSignature")},B=(0,qn.useCallback)(L=>{let K=E(L.id);t.capture("swapperSwapSuccess",K);let G=Qr(L.networkID);M.addBreadcrumb("swapper","transactionStatus","info",{...G,txReceipt:L.id}),(G.chainType==="eip155"||G.chainType==="solana"||G.chainType==="sui")&&e.transactionStatus(L.id,{...G,status:{type:"confirmed"}})},[t,E,e]),q=(0,qn.useCallback)((L,K)=>{let G=L?.networkID?Qr(L.networkID):null;(G?.chainType==="eip155"||G?.chainType==="solana"||G?.chainType==="sui")&&L?.id&&(M.addBreadcrumb("swapper","transactionStatus","error",{...G,txReceipt:L.id}),e.transactionStatus(L.id,{...G,status:{type:"error"}}),b({type:"transactionConfirmationFailed",error:K,txReceipt:L}))},[e,b]);return{logTransactionSubmitted:T,logTransactionSubmissionError:F,logSwapFailureNoSignature:C,logTransactionConfirmed:B,logTransactionConfirmationFailed:q}};s();a();var IA=D(U());s();a();var zi=()=>{let{selectedSetting:t}=ve(),{selectedProviderIndex:e,quoteResponse:r}=Z(),o=Wr(e,t.type,r),{data:n}=Yr();return{slippageSetting:t,slippageTolerance:o??n??void 0}};s();a();s();a();var Jc=D(U());s();a();var td="swap-validation",EA=({scanResult:t,scanResultError:e,quote:r,sellToken:o,buyToken:n})=>{if(e)return"valid";if(!r||!o||!n)return M.addBreadcrumb(td,`Missing necessary args: ${JSON.stringify({quote:!!r,scanResult:!!t,sellToken:o,buyToken:n})}`,"info"),new fe("MissingArgument");if(t?.error===qt.SIMULATION_FAILED)return"valid";if(t?.error){if(M.addBreadcrumb(td,`Simulation error: ${JSON.stringify({error:t.error})}`,"info"),t.error===qt.SLIPPAGE_EXCEEDED)return new fe("slippageToleranceExceeded");if(t.error===qt.INSUFFICIENT_FUNDS)return new fe("INSUFFICIENT_FUNDS");if(t.error===qt.INSUFFICIENT_GAS)return new fe("INSUFFICIENT_GAS");if(t.error===qt.ACCOUNT_FROZEN)return new fe("AccountFrozen");if(t.error===qt.SIMULATION_TIMEOUT)return new fe("SIMULATION_TIMEOUT");if(t.error===qt.STALE_QUOTE)return new fe("STALE_QUOTE");if(t.error===qt.UNKNOWN_ERROR){let i=hN(t);return new fe("SimulationUnknownError",i)}return new fe("Scan results are not valid")}return t?"valid":(M.addBreadcrumb(td,`Missing necessary args: ${JSON.stringify({quote:!!r,scanResult:!1,sellToken:o,buyToken:n})}`,"info"),new fe("MissingArgument"))};function hN(t){return t.simulationError?t.simulationError.humanReadableError:t.warnings[0]?.message}var xA=({swapTransactions:t})=>{let e=A(h=>h.sellFungible),r=A(h=>h.buyFungible),o=e?.data.chain.id??ee.Solana.Mainnet,{selectedSetting:n}=ve(),{currentQuote:i,quoteResponse:c}=Z(),p=Te(Ce(i)),u=Re(e?.data.chain.id,r?.data.chain.id),l=c?.buyToken?J(c?.buyToken):void 0,f=c?.sellToken?J(c?.sellToken):void 0,g={type:"transaction",userAccount:e?.data.walletAddress??"",params:void 0,url:"https://phantom.com",networkID:o,context:u?"bridge":"swap",provider:p,slippageType:n.type,metadata:{swapper:{quoteOutputAmount:i?.buyAmount,quoteOutputToken:l,quoteInputAmount:i?.sellAmount,quoteInputToken:f}}};t?.type==="evm"&&I.isEVMNetworkID(o)&&(g.params={transactions:t.transactions}),t?.type==="solana"&&I.isSolanaNetworkID(o)&&(g.params={transactions:t.transactions,method:"signAndSendTransaction",simulatorConfig:{decodeAccounts:!1}});let{transition:y}=Tr(),w=(0,Jc.useCallback)((h,b)=>{b&&y({type:"simulationRequestError",error:b}),h&&y({type:"simulationResponseReceived",scannedTransactionResult:h})},[y]),S=xi(g,{disableRefetch:!0,onSettled:w,disabled:t?.type==="sui"});return(0,Jc.useMemo)(()=>{if(S.isLoading)return{isLoading:!0,state:"loading"};if(t?.type==="sui")return{isLoading:!1,state:"valid"};let h=EA({scanResult:S.data,scanResultError:S.isError,quote:i,sellToken:c?.sellToken,buyToken:c?.buyToken,simulationTolerance:c?.simulationTolerance});return{isLoading:S.isLoading,state:h}},[S,i,c,t?.type])};function FA({isBridge:t,addressType:e,isSwapSimulationDisabled:r,onTransactionReceiptReceived:o,onTransactionSubmissionError:n,resetToInitialState:i,sender:c}){let{logTransactionSubmitted:p,logSwapFailureNoSignature:u}=Oo(),{connection:l}=Ot(),{data:f}=ue(),{currentQuote:g,quoteResponse:y}=Z(),{slippageTolerance:w}=zi(),S=A(v=>v.gasEstimation.estimateWithBuffer),h=A(v=>v.sellFungible),b=h?.data.chain.id??ee.Solana.Mainnet,{data:E,isSuccess:T}=$t({callerAddress:c,quote:g,sellFungible:h}),F=xA({swapTransactions:E}),{pendingActivityRows:C}=Zb({sender:c}),{mutateAsync:B}=am({accountIdentifier:f?.identifier??"",networkID:b}),[q,L]=(0,IA.useState)(!1),K=async()=>(L(!0),oA({isBridge:t,addressType:e,isSwapSimulationDisabled:r,sender:c,currentQuote:g,quoteResponse:y,gasEstimation:S,swapTransactions:E,scanResults:F,pendingActivityRows:C,connection:l,slippageTolerance:w,logSwapFailureNoSignature:u,logTransactionSubmitted:p,swapFungibles:B,onTransactionSubmissionError:n,onTransactionReceiptReceived:o,resetToInitialState:i}));return{isReadyToExecute:q||(!F.isLoading||r)&&T,executeSwap:K}}s();a();var Zc=D(U());var PA=({goToSwapTab:t,goToSwapReview:e,goToActivityTab:r})=>{let{resume:o}=xt(),{clearQuotes:n}=sm(),i=Er(),c=(0,Zc.useCallback)(()=>{o(),n(),t()},[t,o,n]),p=(0,Zc.useCallback)(()=>{o(),e()},[e,o]),u=(0,Zc.useCallback)(()=>{i(),r()},[r,i]);return{onClose:c,onRetry:p,onSwapSuccess:u}};s();a();function CA(){let{data:[t]}=me(["kill-swapper-simulation"]);return t}s();a();var Vn=D(U());var RA=({onTransactionConfirmationSuccess:t,onTransactionConfirmationError:e,txReceipt:r})=>{let o=j(),{data:n}=ue(),i=(0,Vn.useMemo)(()=>n?.addresses??[],[n]),c=Af(i),p=Er(),{logTransactionConfirmed:u,logTransactionConfirmationFailed:l,logTransactionSubmissionError:f}=Oo(),g=A(T=>T.sellFungible),{currentQuote:y}=Z(),{sellAmount:w}=y??{sellAmount:"0"},S=(0,Vn.useCallback)(async T=>{if(u(T),p(),g){let F=new H(g.data.amount),C=new H(w),B=F.minus(C).toString();tc(o,{id:Dn(g),amount:B})}c()},[u,p,w,g,c,o]),{isSuccess:h,isError:b,error:E}=wf(S,r);(0,Vn.useEffect)(()=>{if(h)t();else if(b){let T=to(E);e(T),l(r,T),f(T,r?.id)}},[h,b,E,r,l,t,e,f])};function kA({isLedger:t,goToSwapTab:e,goToSwapReview:r,goToActivityTab:o}){let{currentQuote:n}=Z(),i=A(N=>N.buyFungible),c=A(N=>N.sellFungible),p=Er(),u=CA(),{logTransactionSubmissionError:l}=Oo(),[f]=(0,dt.useState)(Re(c?.data.chain.id,i?.data.chain.id)),g=c?.data.chain.id??ee.Solana.Mainnet,{data:y}=ue(),w=(0,dt.useMemo)(()=>y?.addresses??[],[y]),S=(0,dt.useMemo)(()=>w.find(N=>N.networkID===c?.data.chain.id)?.address??"",[w,c]),h=(0,dt.useMemo)(()=>I.getAddressType(g),[g]),{data:b}=$t({callerAddress:S,quote:n,sellFungible:c}),[E,T]=(0,dt.useState)(),[F,C]=(0,dt.useState)("loading"),[B,q]=(0,dt.useState)(),L=()=>{C("loading"),q(void 0),T(void 0)},K=N=>{T(N)},G=(0,dt.useCallback)((N,ce)=>{C("error"),q(N),l(N,ce)},[l]),v=(0,dt.useCallback)(()=>{C("success")},[]),x=(0,dt.useCallback)(N=>{C("error"),q(to(N))},[]);RA({onTransactionConfirmationSuccess:v,onTransactionConfirmationError:x,txReceipt:F==="error"?void 0:E});let{executeSwap:P,isReadyToExecute:Q}=FA({isBridge:f,addressType:h,isSwapSimulationDisabled:u,onTransactionSubmissionError:G,onTransactionReceiptReceived:K,resetToInitialState:L,sender:S}),{onClose:_,onRetry:R,onSwapSuccess:O}=PA({goToSwapTab:e,goToSwapReview:r,goToActivityTab:o});return{...ed({sellFungible:c,txReceipt:E,swapTransactions:b,isBridge:f,txStatus:F,isReadyToExecute:Q,isLedger:t,txError:B}),executeSwap:P,resetSwapper:p,onClose:_,onRetry:R,onSwapSuccess:O}}s();a();s();a();var DA=D(U()),NA=()=>{let{data:[t,e]}=me(["enable-auto-slippage","enable-swapper-priority-fee-settings"]);return(0,DA.useMemo)(()=>t?e?"autoWithPriorityFees":"auto":"fixed",[t,e])};s();a();s();a();var BA=D(U());var bN=()=>{let{data:[t]}=me(["enable-swapper-toasts"]),e=Jt();return{selectQuote:(0,BA.useCallback)((o,n)=>{if(t){let i=o[n];i&&e.selectQuote(i)}},[t,e])}};s();a();s();a();s();a();s();a();var Gn=class t{constructor(e,r){this.tracer=r;this.name=e.name,this.context=e.context,this.marks=t.makeMarks(e.marks),this.derivedMarks=e.derivedMarks||[],this.onlyDev=e.onlyDev||!1}name;context;marks;derivedMarks;onlyDev;get markCount(){return this.marks.length+this.derivedMarks.length}getMark(e){return this.marks.find(r=>r.name===e)}qualify(e){return`${this.id}_${e}`}static makeMarks(e){return e.map(r=>typeof r=="string"?{name:r}:{name:r.name,metric:r.metric})}};s();a();var Wi=class extends Gn{get id(){return`${this.context}_${this.name}`}startTrace(){Zt()||this.tracer.startTrace(this,"start")}mark(e){Zt()||this.tracer.mark(this,e)}};s();a();s();a();s();a();var ep=class{nativeTimestamp;constructor(e){this.nativeTimestamp=e.nativeEvent.timeStamp}};var tp=class extends Gn{triggers;constructor(e,r){super(e,r),this.triggers=e.triggers}get id(){return`user_${this.context}_${this.name}`}startTrace(e,r){if(Zt())return;let o=new ep(r);this.tracer.startTrace(this,e,o.nativeTimestamp)}mark(e){Zt()||this.tracer.mark(this,e)}markFrame(e){Zt()||requestAnimationFrame(()=>{this.tracer.mark(this,e)})}};s();a();s();a();s();a();var rp=class{constructor(e){this.cleanupOptions=e}cleanupInterval=null;lastActivityTimestamp=0;signalActive(){this.lastActivityTimestamp=performance.now(),this.ensureCleanup()}ensureCleanup(){this.cleanupInterval||(this.cleanupInterval=setInterval(()=>this.cleanupCycle(),this.cleanupOptions.cleanupIntervalMs))}cleanupCycle(){let{itemsRemaining:e}=this.runCleanup(),r=performance.now()-this.lastActivityTimestamp;e===0&&r>=this.cleanupOptions.maxAgeMs&&this.stopCleanup()}stopCleanup(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}};var op=class extends rp{constructor(r){super({cleanupIntervalMs:10*60*1e3,maxAgeMs:4*60*1e3});this.perf=r}activeTraces=new Map;startTrace(r,o,n=this.perf.now()){let i=new rd(r,o,n);this.activeTraces.set(r.id,i),this.perf.mark(i.startMarkName,{timestamp:n}),this.signalActive()}mark(r,o){let n=this.activeTraces.get(r.id);if(!n||n.hasMark(o))return;let i=r.getMark(o);this.processMark(n,i),this.processDerivedMarks(n),n.numAddedMarks===r.markCount&&this.activeTraces.delete(r.id)}processMark(r,o){r.addMark(o.name);let n=r.operation.qualify(o.name);if(this.perf.mark(n),o.metric){let i=r.operation.qualify(o.metric),c=this.perf.measure(i,r.startMarkName,n);if(c===void 0){M.captureMessage(`[OperationTracer] Unexpected measure duration 'undefined' for mark ${n}, ignoring`,"performance","error");return}console.log(`[OperationTracer] Metric '${i}': ${c}ms (trigger: ${r.trigger})`)}}processDerivedMarks(r){r.operation.derivedMarks.forEach(o=>{if(r.hasMark(o.name))return;o.dependsOn.every(i=>r.hasMark(i))&&this.processMark(r,o)})}runCleanup(){let r=this.perf.now();for(let[o,n]of this.activeTraces)n&&r-n.startTime>this.cleanupOptions.maxAgeMs&&this.activeTraces.delete(o);return{itemsRemaining:this.activeTraces.size}}},rd=class{constructor(e,r,o){this.operation=e;this.trigger=r;this.startTime=o}marks=new Set;get numAddedMarks(){return this.marks.size}get startMarkName(){return this.operation.qualify(this.trigger)}addMark(e){this.marks.add(e)}hasMark(e){return this.marks.has(e)}};s();a();var np=class{now(){return performance.now()}mark(e,r={timestamp:performance.now()}){performance.mark(e,{startTime:r.timestamp})}measure(e,r,o){try{let n=performance.measure(e,r,o).duration;return Math.round(n)}catch{return}}};var AN=new np,od=new op(AN),ip=class t{static createOperation(e){return new Wi(e,od)}static createUserOperation(e){return new tp(e,od)}static measureFunc(e,r,o={onlyDev:!1}){if(Zt())return r();let n=new Wi({name:e,context:"func",marks:[{name:"done",metric:"time"}]},od);n.startTrace();let i=r();return i&&typeof i.then=="function"?i.then(c=>(n.mark("done"),c)):(n.mark("done"),i)}static wrapFunc(e,r,o={onlyDev:!1}){return function(...n){return t.measureFunc(e,()=>r(...n),o)}}};var TN=ip.createUserOperation({name:"switchTokens",context:"swapTab",triggers:["switchButtonClick"],marks:["sellTokenUpdated","buyTokenUpdated"],derivedMarks:[{name:"tokensSwitched",dependsOn:["sellTokenUpdated","buyTokenUpdated"],metric:"switchTime"}],onlyDev:!0});s();a();var UA=D(U());s();a();var QA=D(U());var vN={status:!1,timestamp:""},LA=()=>{let{data:t}=Xe({key:"hasViewedAutoSlippageOptIn",queryKey:le.hasViewedAutoSlippageOptIn()}),{mutateAsync:e}=st({key:"hasViewedAutoSlippageOptIn",queryKey:le.hasViewedAutoSlippageOptIn()}),r=(0,QA.useCallback)(o=>void e({status:o,timestamp:new Date().toISOString()}),[e]);return{viewedOptInState:t??vN,setViewedOptInState:r}};var nd=()=>{let{viewedOptInState:t,setViewedOptInState:e}=LA(),{selectedSetting:r}=ve(),{reviewInterceptors:o,supportedCustomSimulationToastErrorTypes:n}=Zm(),i=Jt(),{connection:c}=Ot(),p=re(),u=Jo(),l=k.language,f=te(),g=Er(),y=j(),w=Fo(),S=A(T=>T.gasEstimation.estimateWithBuffer),h=ve(),{storePairs:b}=Wt();return{executeInterceptors:(0,UA.useCallback)((T,F,C,B)=>{for(let q of o)if(q.intercept({hasViewedAutoSlippageOptIn:t.status,selectedSetting:r.type,setHasViewedAutoSlippageOptIn:e,showOverlay:T,swapper:i,connection:c,storage:p,vaultProxy:u,locale:l,analytics:f,resetSwapper:g,queryClient:y,showFungibleDetails:F,showBuyFungibleScreen:C,swapAnalytics:w,gasEstimation:S,slippageSettings:h,navigateToSwapper:B,supportedCustomSimulationToastErrorTypes:n,storePairs:b,isMobile:$e})==="interrupt")return"interrupt";return"continue"},[o,t.status,r.type,e,i,c,p,u,l,f,g,y,w,S,h,n,b])}};s();a();var LRe=Fe(t=>({quoteSpan:void 0,previousBuyAmount:void 0,previousSellAmount:void 0,setQuoteSpan(e){t({quoteSpan:e})},setPreviousBuyAmount(e){t({previousBuyAmount:e})},setPreviousSellAmount(e){t({previousSellAmount:e})}}));s();a();var VRe=Fe(t=>({initialLoadSpan:void 0,setInitialLoadSpan(e){t({initialLoadSpan:e})}}));s();a();var xN=D(U());var WRe=["simulationRequestErrored","simulationFailed","transactionSubmissionFailed","transactionNotConfirmed"];s();a();var IN=D(U());s();a();var sp=D(U());var FN=["enable","reject"],PN=({continueSwap:t,dismiss:e})=>{let r=te(),{setSlippageSetting:o}=ve(),n=(0,sp.useCallback)(c=>{switch(e(),c){case"enable":r.capture("autoSlippageOptIn",{data:{step:"enabledAutoSlippage"}}),o({type:"auto"}),hr();break;case"reject":r.capture("autoSlippageOptIn",{data:{step:"rejectedAutoSlippage"}}),o({type:"fixed"}),t();break}},[t,e,o,r]),i=(0,sp.useMemo)(()=>FN.map(c=>({label:k.t(c==="enable"?"swapSlippageOptInEnableOption":"swapSlippageOptInRejectOption"),variant:c==="enable"?"primary":"secondary",onPress:()=>n(c)})),[n]);return{title:k.t("swapSlippageOptInTitle"),description:k.t("swapSlippageOptInSubtitle"),learnMoreText:k.t("commandLearnMore"),learnMoreUrl:ac,options:i}};s();a();var _A=D(U());var CN=({goToAssetSelect:t})=>{let{setSearchQuery:e}=A();return(0,_A.useCallback)(r=>{r==="buy"&&e(""),t(r)},[t,e])};s();a();var ji=D(U());var OA="auto-provider-defaulted-to-toast",RN=({showDefaultAutoProvider:t})=>{let{hasDefaultedToBestQuote:e}=Z(),{message:r,hideToast:o}=ct(),n=A(c=>c.setSelectedBaseProvider),i=(0,ji.useRef)(e);(0,ji.useEffect)(()=>{i.current=e},[e]),(0,ji.useEffect)(()=>{e&&setTimeout(()=>{i.current&&(n(ht),r({id:OA,message:k.t("swapProviderAutoUpdateTitle"),icon:"info",onPress:()=>{o(OA),t()}}))},2e3)},[e,r,o,t,n])};s();a();var qA=D(U());s();a();var Kn=D(U());var kN=H(1);function ap(t,e,r){let o=te(),[n,i]=(0,Kn.useState)(!1),c=(0,Kn.useCallback)(async()=>{await o.capture("swapperToggleBestPriceRatio",{data:{unitCurrency:n?"buy token":"sell token"}}),i(!n)},[o,n]),p=A(l=>l.sellFungible),u=A(l=>l.buyFungible);return(0,Kn.useMemo)(()=>{let l=!1,f="";if(e&&r){let g=u?.data,y=p?.data;if(g&&y){let{buyAmount:w,sellAmount:S}=r,h=ne(w,g.decimals),b=ne(S,y.decimals),E=h.dividedBy(b),T=`1 ${y.symbol} \u2248 ${Qo(E)} ${g.symbol}`,F=`1 ${g.symbol} \u2248 ${Qo(kN.dividedBy(E))} ${y.symbol}`;l=new H(r.buyAmount).isEqualTo(t),f=n?F:T}}return{isBestRate:l,rate:f,flip:c}},[t,r,n,e,p,u,c])}var DN=({selectProvider:t})=>{let{currentQuote:e,quoteResponse:r}=Z(),{currencySymbol:o,fromUsd:n}=Pe(),i=e?.buyAmount??"",c=ap(i,r,e),p=Un(Ce(e)),u=e?.baseProvider.name??"";return{details:(0,qA.useMemo)(()=>e?ae(e)?BN({quote:e,selectProvider:t,exchangeRate:c,currencySymbol:o,fromUsd:n}):NN({provider:u,sources:p,exchangeRate:c,selectProvider:t}):[],[e,u,p,c,t,o,n]),footnote:k.t("swapProviderPricingFootnote")}},NN=({provider:t,sources:e,exchangeRate:r,selectProvider:o})=>[{label:k.t("swapProviderPricingProvider"),value:t,icon:"chevron-right",onPress:o},{label:k.t("swapProviderPricingMarket"),value:e},{label:k.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip}],BN=({quote:t,selectProvider:e,exchangeRate:r,currencySymbol:o,fromUsd:n})=>{let i=t.baseProvider.name,c=Ka(t).toString(),p=Ft(oo(t));return[{label:k.t("swapProviderPricingProvider"),value:i,icon:"chevron-right",onPress:e},{label:k.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip},{label:k.t("swapProviderPricingFees"),value:`${o}${n(Number(c),2)} ${k.t("swapProvidersFee")}`},{label:k.t("swapProviderPricingTime"),value:p}]};s();a();s();a();s();a();var Hn=D(U());s();a();var id=D(U());s();a();var KA=D(U());s();a();function VA(t){if(t===void 0)return"#999";let e=parseFloat(t.toFixed(2));switch(!0){case e>=5:return"#EB3742";case(e>=1&&t<5):return"#FFDC62";case(t>=0&&t<1):return"#21E56F";default:return"#777777"}}s();a();function GA(t){if(t===void 0)return"-";switch(!0){case t>=1e3:return">1000%";case(t>=.01&&t<1e3):return`${t.toFixed(2)}%`;case(t>0&&t<.01):return"<0.01%";case t===0:return"0%";default:return"-"}}function cp(t){return(0,KA.useMemo)(()=>{let e="",r="";if(t===void 0)return;let o=t*100;return e=VA(o),r=GA(o),{color:e,text:r,percentage:o}},[t])}s();a();var pp=({priceImpact:t,slippage:e,transferFees:r,shouldShowFees:o,shouldShowPriceImpact:n,shouldShowSlippage:i,isQuoteStreaming:c})=>{let p=c?UN:LN;return[...QN({priceImpact:t,slippage:e,transferFees:r}),...p({shouldShowSlippage:i,shouldShowFees:o,shouldShowPriceImpact:n})]},QN=({priceImpact:t,slippage:e,transferFees:r})=>{let o=[];return t&&t.percentage>Rl&&o.push("highPriceImpact"),e&&e.percentage>=kl&&o.push("highSlippage"),(r?.totalPercentFees??0)>0&&o.push("transferFees"),o},LN=({shouldShowSlippage:t,shouldShowFees:e,shouldShowPriceImpact:r})=>{let o=[];return o.push("providerPressable"),o.push("exchangeRate"),t&&o.push("slippagePressable"),e&&o.push("fees"),r&&o.push("priceImpact"),o},UN=({shouldShowSlippage:t,shouldShowFees:e,shouldShowPriceImpact:r})=>{let o=[];return o.push("pricing"),e&&o.push("fees"),r&&o.push("priceImpact"),t&&o.push("slippagePressable"),o};s();a();function up(t,e){let r="",o="";if(t===void 0)return;r=MN(t);let n=e==="auto"?`${k.t("swapSlippageSettingsAuto")} \u2022 `:"";return o=_N(t),{color:r,text:o,percentage:t,prefix:n}}function MN(t){let e=parseFloat(t.toFixed(2));switch(!0){case e>2:return"#EB3742";case(e>=1&&t<=2):return"#FFDC62";default:return"#777777"}}function _N(t){switch(!0){case t>=1e3:return">1000%";case(t>=.01&&t<1e3):return`${t.toFixed(2)}%`;case(t>0&&t<.01):return"<0.01%";case t===0:return"0%";default:return"-"}}s();a();var lp=t=>t.reduce((e,r)=>{if(!r||r.type!=="SPL")return e;let o;return r.type==="SPL"&&(o=ON(r)),o?{fees:[...e.fees,o],totalPercentFees:e.totalPercentFees+o.percentFee}:e},{fees:[],totalPercentFees:0}),ON=t=>{if(t.type!=="SPL")return;let r=(t.data.mintExtensions??[]).find(o=>o.extension==="transferFeeConfig");if(r)return{caip19:J(z(t)),fungibleKey:t.data.key,symbol:t.data.symbol??"",name:t.data.name??"",percentFee:r.state.newerTransferFee.transferFeeBasisPoints/100}};var HA=()=>{let{currentQuote:t,quoteResponse:e}=Z(),r=cp(ro(t)),{selectedSetting:o}=ve(),n=(0,id.useMemo)(()=>up(e?.slippageTolerance,o.type),[e?.slippageTolerance,o.type]),i=A(g=>g.sellFungible),c=A(g=>g.buyFungible),p=(0,id.useMemo)(()=>lp([i,c]),[i,c]),{data:[u,l]}=me(["enable-swapper-skip-review","enable-quote-streaming"]);return{logSwapHomeState:()=>{let g=pp({priceImpact:r,slippage:n,transferFees:p,shouldShowFees:u,shouldShowPriceImpact:!!r&&u,shouldShowSlippage:!!n&&u,isQuoteStreaming:l}),y={slippage:JSON.stringify(n),priceImpact:JSON.stringify(r),rows:g};M.addBreadcrumb("swapper","swap-home","info",Dr(y))}}};s();a();var zA=D(U());s();a();function $A({sellFungible:t,totalFees:e,minRequiredBalance:r,currentQuote:o}){let n=e.maxAmount??e.amount,i=t?.type?Oe(t?.type):!1,{source:c,destination:p}=r;if(i){let u=new V(o?.sellAmount??0);return n.plus(u)}else{let u=c.plus(p);return n.plus(u)}}var WA=()=>{let{currentQuote:t}=Z(),{totalFees:e}=Ct(),r=A(c=>c.sellFungible),o=Bn(),n=Nn();return(0,zA.useMemo)(()=>$A({sellFungible:r,totalFees:e,minRequiredBalance:{source:o,destination:n},currentQuote:t}),[r,e,o,n,t])};s();a();function jA({sellFungible:t,sellNativeFungible:e,totalNativeRequirement:r}){let o=t?.data.chain.id,n=e?et(e.data.amount,e.data.decimals):"-",i=e?et(r,e.data.decimals):"-";return{networkId:o,balance:n,required:i}}s();a();function YA({quoteResponse:t,hasInsufficientBalance:e,insufficientBalanceArgs:r,isTermsAcknowledged:o,shouldSkipSwapReview:n,logSwapHomeState:i,goToInsufficientBalance:c,goToSwapTermsOfService:p,goToSwapReview:u,onSwap:l,executeInterceptors:f}){if(t)e?c(r):(i(),o?f()==="continue"&&(n?l():u()):p());else return}var sd=({goToSwapTermsOfService:t,goToSwapReview:e,goToInsufficientBalance:r,goToConfirmation:o,showOverlay:n,showFungibleDetails:i,showBuyFungibleScreen:c,navigateToSwapper:p})=>{let{data:[u]}=me(["enable-swapper-skip-review"]),{quoteResponse:l}=Z(),f=A(q=>q.sellFungible),g=f?.data.chain.id,{data:y}=Om(),{logSwapHomeState:w}=HA(),{fungible:S}=or({key:g?hs(g,void 0):void 0}),h=WA(),b=(0,Hn.useMemo)(()=>new V(S?.data.amount??0).lt(h),[S,h]),E=(0,Hn.useMemo)(()=>jA({sellFungible:f,sellNativeFungible:S,totalNativeRequirement:h}),[f,S,h]),T=Ni({goToConfirmation:o}),{executeInterceptors:F}=nd(),C=(0,Hn.useCallback)(()=>F(n,i,c,p),[F,n,i,c,p]);return{onClick:(0,Hn.useCallback)(()=>YA({quoteResponse:l,hasInsufficientBalance:b,insufficientBalanceArgs:E,isTermsAcknowledged:y,shouldSkipSwapReview:u,logSwapHomeState:w,goToInsufficientBalance:r,goToSwapTermsOfService:t,goToSwapReview:e,onSwap:T,executeInterceptors:C}),[l,b,E,y,u,w,r,t,e,T,C])}};s();a();var Yi=D(U()),ad=D(Qi());s();a();s();a();var XA=({sellFungible:t,totalFees:e,transactionSpeedsToUnitCost:r,currentQuote:o,isBridge:n,minRequiredBalance:i,customPriorityFee:c})=>{let p=t?ec({sellFungible:t,totalFees:e.amount,transactionSpeedsToUnitCost:I.isEVMNetworkID(t.data.chain.id)?r:void 0,isBridge:n,minRequiredBalance:i,customPriorityFee:c}):"0",u=t?.data.decimals;return o?.sellAmount?new H(ne(o.sellAmount,u??0)).isLessThanOrEqualTo(new H(p)):!0};var JA=({sellFungible:t,isFetchingQuote:e,quoteResponse:r,currentQuote:o,gasEstimation:n,maxGasEstimation:i,hasNoRoutes:c,totalFees:p,transactionSpeedsToUnitCost:u,isBridge:l,minRequiredBalance:f,shouldSkipSwapReview:g,numTransactions:y,customPriorityFee:w})=>{let S=XA({sellFungible:t,totalFees:p,transactionSpeedsToUnitCost:u,currentQuote:o,isBridge:l,minRequiredBalance:f,customPriorityFee:w});switch(VN({quoteResponse:r,sellFungible:t,currentQuote:o,hasNoRoutes:c,hasEnoughAssets:S,isFetchingQuote:e,gasEstimation:n,maxGasEstimation:i,shouldSkipSwapReview:g,numTransactions:y})){case"notSwappable":return{title:k.t("swapReviewFlowActionButtonPrimary"),type:"secondary",disabled:!0};case"swappable":return{title:k.t("swapReviewFlowActionButtonPrimary"),type:"primary",disabled:!1};case"reviewable":return{title:k.t("swapFlowActionButtonText"),type:"primary",disabled:!1};case"notReviewable":return{title:k.t("swapFlowActionButtonText"),type:"secondary",disabled:!0};case"insufficientBalance":return{title:k.t("swapReviewInsufficientBalance"),type:"alert",disabled:!0};case"noRoutes":return{title:k.t("swapNoQuotesFound"),type:"secondary",disabled:!0}}},qN=({sellFungible:t})=>{let e=t?.data.chain.id??ee.Solana.Mainnet;return I.isEVMNetworkID(e)};function VN({quoteResponse:t,sellFungible:e,currentQuote:r,hasNoRoutes:o,hasEnoughAssets:n,isFetchingQuote:i,gasEstimation:c,maxGasEstimation:p,shouldSkipSwapReview:u,numTransactions:l}){if(!n)return"insufficientBalance";if(o)return"noRoutes";let f=qN({sellFungible:e}),g=!!(c&&(c??[]).length>=l&&(p??[]).length>=l);return!t||!e||!r||f&&!g||i?u?"notSwappable":"notReviewable":u?"swappable":"reviewable"}function GN({goToInsufficientBalance:t,goToSwapReview:e,goToSwapTermsOfService:r,goToConfirmation:o,showOverlay:n,showFungibleDetails:i,showBuyFungibleScreen:c,navigateToSwapper:p}){let{currentQuote:u,isFetchingQuote:l,quoteResponse:f}=Z(),{data:[g]}=me(["enable-swapper-skip-review"]),y=A(Ae=>Ae.hasNoRoutes),w=A(Ae=>Ae.sellFungible),S=w?.data.chain.id,{estimate:h,estimateWithBuffer:b}=A(Ae=>Ae.gasEstimation),T=A(Ae=>Ae.buyFungible)?.data.chain.id,F=Re(S,T),{totalFees:C}=Ct(),{data:B}=ws({networkID:S}),q=Bn(),L=Nn(),K=A(Ae=>Ae.sellAmount),G=A(Ae=>Ae.setIsFetchingQuote),v=Rn(),x=(0,ad.default)(v),P=(0,ad.default)(K);(0,Yi.useEffect)(()=>{K!==P&&K&&v&&x&&G(!0)},[K,P,G,v,x]);let{data:Q}=ue(),_=(0,Yi.useMemo)(()=>Q?.addresses??[],[Q]),R=(0,Yi.useMemo)(()=>_.find(Ae=>Ae.networkID===w?.data.chain.id)?.address??"",[_,w]),{data:O}=$t({callerAddress:R,quote:u,sellFungible:w}),{data:$}=vr(),{title:N,type:ce,disabled:pe}=JA({sellFungible:w,currentQuote:u,quoteResponse:f,isFetchingQuote:l,isBridge:F,gasEstimation:h,maxGasEstimation:b,hasNoRoutes:y,totalFees:C,transactionSpeedsToUnitCost:B,minRequiredBalance:{source:q,destination:L},shouldSkipSwapReview:g,numTransactions:O?.transactions?.length??0,customPriorityFee:new H($??0).multipliedBy(10**9)}),{onClick:ke}=sd({goToInsufficientBalance:t,goToSwapReview:e,goToSwapTermsOfService:r,goToConfirmation:o,showOverlay:n,showFungibleDetails:i,showBuyFungibleScreen:c,navigateToSwapper:p});return{disabled:pe,title:N,type:ce,onClick:ke}}s();a();s();a();var Xi=D(U());s();a();var ZA=({buyNetwork:t,sellNetwork:e,executionDuration:r,priceImpact:o,slippage:n})=>{let i=[];return i.push("provider"),i.push("exchangeRate"),t&&e&&t!==e&&i.push("network"),n&&i.push("slippage"),i.push("fees"),r>0&&i.push("executionDuration"),o&&i.push("priceImpact"),i};function KN({isSwapReview:t,showProviders:e,showSwapSettings:r,showSwapPricing:o}){let{bestBuyAmount:n,currentQuote:i,hasNoRoutes:c,quoteResponse:p,quotes:u,isFetchingQuote:l}=Z(),f=ap(n,p,i),g=cp(ro(i)),{slippageSetting:y,slippageTolerance:w}=zi(),S=(0,Xi.useMemo)(()=>up(w,y.type),[w,y.type]),h=Un(Ce(i)),b=oo(i),E=Ft(b),[T]=(0,Xi.useState)(E),F=p?.sellToken?.chainId?I.getChainName(p.sellToken.chainId):void 0,C=p?.buyToken?.chainId?I.getChainName(p.buyToken.chainId):void 0,B=Ct(),q=Mm(B),L=A(O=>O.sellFungible),K=A(O=>O.buyFungible),G=(0,Xi.useMemo)(()=>lp([L,K]),[L,K]),{data:[v,x]}=me(["enable-swapper-skip-review","enable-quote-streaming"]),P=!!B.phantomFee.pct&&(t||v),_={exchangeRate:f,priceImpact:g,slippage:S,provider:h,fees:B,executionDuration:b,uiEstimatedTime:T,isFetchingQuote:l,sellNetwork:F,buyNetwork:C,feeBreakdown:q,selectProviderEnabled:!t&&!!h,isSwapReview:t,showProviders:e,showSwapSettings:r,showSwapPricing:o,transferFees:G},R=t?ZA({exchangeRate:f,priceImpact:g,slippage:S,buyNetwork:C,sellNetwork:F,executionDuration:b}):pp({priceImpact:g,slippage:S,transferFees:G,shouldShowFees:v,shouldShowPriceImpact:!!g&&v,shouldShowSlippage:!!S&&v,isQuoteStreaming:x});return{exchangeRate:f,hasNoRoutes:c,priceImpact:g,slippage:S,provider:h,fees:B,nrOfQuotes:u.length,executionDuration:b,isFetchingQuote:l,sellNetwork:F,buyNetwork:C,rows:R,sharedRowProps:_,displayPhantomFeeRow:P}}s();a();var qo=D(U());s();a();s();a();var mp=class{getRow({quote:e,buyToken:r}){let o=`${yt(ne(e.buyAmount,r.decimals),rr.get(r.networkId).formDisplayPrecision)} ${r.symbol}`;return{type:"standard",key:e.baseProvider.id,logoUri:e.baseProvider.logoUri,topLeft:{text:e.baseProvider.name,color:"textPrimary",font:"body"},topRight:{text:o,color:"textSecondary",font:"body"}}}getAutoRow(){return{type:"standard",key:ht,topLeft:{text:k.t("selectSwapProviderAutoLabel"),color:"textPrimary",font:"body"},topRight:{text:k.t("selectSwapProviderAutoDescription"),color:"textSecondary",font:"body"}}}},cd=class extends mp{getRow(e){let{quote:r,currencySymbol:o,fromUsd:n}=e;if(!ae(r))throw new Error("Quote is not a bridge quote");let i=super.getRow(e),c=Ft(oo(r)),p=Ka(r).toString();return{...i,type:"bridge",bottomLeft:{text:c,color:"textSecondary",font:"caption"},bottomRight:{text:`${o}${n(Number(p),2)} ${k.t("swapProvidersFee")}`,color:"textSecondary",font:"caption"}}}getAutoRow(){return{type:"bridge",key:ht,topLeft:{text:k.t("selectSwapProviderAutoLabel"),color:"textPrimary",font:"body"},topRight:{text:k.t("selectSwapProviderAutoDescription"),color:"textSecondary",font:"body"},bottomLeft:{text:k.t("selectSwapProviderAutoTBD"),color:"textSecondary",font:"caption"},bottomRight:{text:k.t("selectSwapProviderAutoTBD"),color:"textSecondary",font:"caption"}}}},pd=new mp,ud=new cd;var eT=({quoteResponse:t,buyToken:e,currencySymbol:r,setSelectedProvider:o,fromUsd:n})=>{let i=t.type==="xchain",c=i?ud.getAutoRow():pd.getAutoRow(),p={...c,onPress:()=>o(c.key)},u=t.quotes.reduce((l,f)=>{let y=(i?ud:pd).getRow({quote:f,buyToken:e,currencySymbol:r,fromUsd:n});return[...l,{...y,onPress:()=>o(f.baseProvider.id)}]},[]);return[p,...u]};var HN=({dismiss:t})=>{let{fromUsd:e,currencySymbol:r}=Pe(),o=te(),n=A(w=>w.quoteResponse),i=A(w=>w.buyFungible),c=A(w=>w.selectedBaseProvider),p=A(w=>w.setSelectedBaseProvider),[u,l]=(0,qo.useState)(c),f=(0,qo.useMemo)(()=>!n||!i?[]:eT({quoteResponse:n,buyToken:{networkId:i.data.chain.id,decimals:i.data.decimals,symbol:i.data.symbol??""},currencySymbol:r,setSelectedProvider:l,fromUsd:e}),[n,i,r,e,l]),g=(0,qo.useCallback)(()=>{p(u),o.capture("swapperProviderSelected",{data:{provider:u}}),t()},[u,p,t,o]),y=(0,qo.useMemo)(()=>[{theme:"secondary",disabled:!1,label:k.t("commandCancel"),onPress:t},{theme:"primary",disabled:u===c,label:k.t("commandApply"),onPress:g}],[g,t,u,c]);return{selectedProvider:u,rows:f,buttons:y}};s();a();s();a();var $n=ut(new es);function ld(){return ld=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},ld.apply(this,arguments)}m.NODE_ENV!=="production"&&($n.debugPrivate=!0);var $N=(t,e,r)=>t?.suspense&&zN(e,r),zN=(t,e)=>t.isPending&&!e,WN=({result:t,throwOnError:e,query:r})=>t.isError&&!t.isFetching&&jN(e,[t.error,r]);function jN(t,e){return typeof t=="function"?t(...e):!!t}var YN=t=>t.suspense&&typeof t.staleTime!="number"?ld({},t,{staleTime:1e3}):t;function tT(t,e,r=o=>o($n)){let o=ut(0),n=ut(r);m.NODE_ENV!=="production"&&(n.debugPrivate=!0);let i=ut(()=>new WeakMap);m.NODE_ENV!=="production"&&(i.debugPrivate=!0);let c=ut(l=>{let f=l(n),g=t(l),y=f.defaultQueryOptions(g),w=l(i).get(f);return y._optimisticResults="optimistic",w&&w.setOptions(y,{listeners:!1}),YN(y)});m.NODE_ENV!=="production"&&(c.debugPrivate=!0);let p=ut(l=>{let f=l(n),g=l(c),y=l(i),w=y.get(f);if(w)return w;let S=new e(f,g);return y.set(f,S),S});m.NODE_ENV!=="production"&&(p.debugPrivate=!0);let u=ut(l=>{let f=l(p),g=l(c),y=f.getOptimisticResult(g),w=ut(y);return m.NODE_ENV!=="production"&&(w.debugPrivate=!0),w.onMount=S=>{let h=f.subscribe(Ho.batchCalls(S));return()=>{f.getCurrentResult().isError&&f.getCurrentQuery().reset(),h()}},w});return m.NODE_ENV!=="production"&&(u.debugPrivate=!0),ut(l=>{l(o);let f=l(p),g=l(c),y=l(l(u));if($N(g,y,!1))return f.fetchOptimistic(g);if(WN({result:y,query:f.getCurrentQuery(),throwOnError:g.throwOnError}))throw y.error;return y},(l,f)=>{f(o,g=>g+1)})}function FLe(t,e=r=>r($n)){return tT(t,Sd,e)}function PLe(t,e=r=>r($n)){return tT(t,wd,e)}s();a();var NLe=Symbol((import.meta.env?import.meta.env.MODE:void 0)!=="production"?"RESET":"");function BLe(t,e){let r=null,o=new Map,n=new Set,i=p=>{let u;if(e===void 0)u=o.get(p);else for(let[f,g]of o)if(e(f,p)){u=g;break}if(u!==void 0)if(r?.(u[1],p))i.remove(p);else return u[0];let l=t(p);return o.set(p,[l,Date.now()]),c("CREATE",p,l),l};function c(p,u,l){for(let f of n)f({type:p,param:u,atom:l})}return i.unstable_listen=p=>(n.add(p),()=>{n.delete(p)}),i.getParams=()=>o.keys(),i.remove=p=>{if(e===void 0){if(!o.has(p))return;let[u]=o.get(p);o.delete(p),c("REMOVE",p,u)}else for(let[u,[l]]of o)if(e(u,p)){o.delete(u),c("REMOVE",u,l);break}},i.setShouldRemove=p=>{if(r=p,!!r)for(let[u,[l,f]]of o)r(f,u)&&(o.delete(u),c("REMOVE",u,l))},i}var md=(t,e,r)=>(e.has(r)?e:e.set(r,t())).get(r),XN=new WeakMap,JN=(t,e,r,o)=>{let n=md(()=>new WeakMap,XN,e),i=md(()=>new WeakMap,n,r);return md(t,i,o)};function QLe(t,e,r=Object.is){return JN(()=>{let o=Symbol(),n=([c,p])=>{if(p===o)return e(c);let u=e(c,p);return r(p,u)?p:u},i=ut(c=>{let p=c(i),u=c(t);return n([u,p])});return i.init=o,i},t,e,r)}var ZN=t=>typeof t?.then=="function";function eB(t=()=>{try{return self.localStorage}catch(r){(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&typeof self<"u"&&console.warn(r);return}},e){var r;let o,n,i={getItem:(u,l)=>{var f,g;let y=S=>{if(S=S||"",o!==S){try{n=JSON.parse(S,e?.reviver)}catch{return l}o=S}return n},w=(g=(f=t())==null?void 0:f.getItem(u))!=null?g:null;return ZN(w)?w.then(y):y(w)},setItem:(u,l)=>{var f;return(f=t())==null?void 0:f.setItem(u,JSON.stringify(l,e?.replacer))},removeItem:u=>{var l;return(l=t())==null?void 0:l.removeItem(u)}},c=u=>(l,f,g)=>u(l,y=>{let w;try{w=JSON.parse(y||"")}catch{w=g}f(w)}),p;try{p=(r=t())==null?void 0:r.subscribe}catch{}return!p&&typeof self<"u"&&typeof self.addEventListener=="function"&&self.Storage&&(p=(u,l)=>{if(!(t()instanceof self.Storage))return()=>{};let f=g=>{g.storageArea===t()&&g.key===u&&l(g.newValue)};return self.addEventListener("storage",f),()=>{self.removeEventListener("storage",f)}}),p&&(i.subscribe=c(p)),i}var LLe=eB();s();a();var oT=D(U(),1);var rT=new WeakMap;function nT(t,e){let r=Cs(e),o=tB(r);for(let[n,i]of t)(!o.has(n)||e?.dangerouslyForceHydrate)&&(o.add(n),r.set(n,i))}var tB=t=>{let e=rT.get(t);return e||(e=new WeakSet,rT.set(t,e)),e};var dp=D(U());s();a();var Nt=()=>!0,iT={tokens:Nt,prices:yf,collectibles:Tf,currency:Kd,staking:vf,swapper:Um,transferFungibleLoggingContext:Nt,user:Bd,[Hd]:Nt,[Kr]:Nt,[Tp]:Nt,[Ef]:Nt,[ri]:Nt,[Vt]:Nt,"infinite-tokens":Nt,"token-transfers":Nt,"portfolio-value":Nt,"test-debug-query":Zi},sT=t=>{if(t.queryKey.length===0||t.state.status!=="success")return!1;let e=String(t.queryKey[0]);return iT[e]?iT[e](t):!1};var aT=new es({defaultOptions:{mutations:{retry:!1,networkMode:"offlineFirst"},queries:{retry:!1,staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,networkMode:"offlineFirst"}}}),rB=gd({underlyingStorage:new uf,throttleMs:1e3,enableDebugLogs:Zi()}),oB=({children:t})=>(nT([[$n,aT]]),t),dUe=t=>dp.default.createElement(hd,{client:aT,persistOptions:{persister:rB,dehydrateOptions:{shouldDehydrateQuery:sT},buster:nB,maxAge:1/0}},dp.default.createElement(sg,null,dp.default.createElement(oB,null,t.children))),nB="25.2.0";s();a();var iB=(N=>(N.HasOnboarded="hasOnboarded",N.ResetHasOnboarded="resetHasOnboarded",N.LockExtension="lockExtension",N.UnlockExtension="unlockExtension",N.IsExtensionUnlocked="IsExtensionUnlocked",N.SetPassword="setPassword",N.VerifyPassword="verifyPassword",N.UpdatePassword="updatePassword",N.ImportPrivateKeyAccount="importPrivateKeyAccount",N.ImportReadOnlyAccount="importReadOnlyAccount",N.ImportSeedAccount="importSeedAccount",N.ImportSeedlessAccount="importSocialSeedAccount",N.IsExistingSeed="isExistingSeed",N.AddAccountForSeed="addAccountForSeed",N.AddAccountForSeedless="addAccountForSeedless",N.AddLedgerAccounts="addLedgerAccounts",N.DeriveAddresses="deriveAddresses",N.ExportPrivateKey="exportPrivateKey",N.ExportEntropy="exportEntropy",N.SetAccountIcon="setAccountIcon",N.RemoveAccount="removeAccount",N.ReorderAccount="reorderAccount",N.GetAllAccounts="getAllAccounts",N.GetAllSeeds="getAllSeeds",N.GetAllSeedless="getAllSeedlessSeeds",N.GetAuthenticationPublicKey="getAuthenticationPublicKey",N.Sign="sign",N.SyncAccounts="syncAccounts",N.CheckVaultIntegrity="checkVaultIntegrity",N.LogMessage="logMessage",N.DownloadLogs="downloadLogs",N.ProviderInjectionOptions="providerInjectionOptions",N.ServiceWorkerMutexAcquire="serviceWorkerMutexAcquire",N.ServiceWorkerMutexRelease="serviceWorkerMutexRelease",N))(iB||{});export{$b as a,qfe as b,wde as c,gT as d,BT as e,IT as f,qt as g,FT as h,xs as i,_p as j,LT as k,UT as l,Op as m,Zn as n,ut as o,zT as p,cg as q,WT as r,$n as s,FLe as t,PLe as u,BLe as v,QLe as w,ze as x,wu as y,lo as z,du as A,JT as B,ZT as C,ev as D,Ng as E,av as F,qg as G,RP as H,NP as I,Vu as J,Ix as K,wI as L,ai as M,Lu as N,Uu as O,Mu as P,gP as Q,yP as R,gl as S,FP as T,MP as U,GP as V,$P as W,cC as X,pC as Y,rC as Z,Sr as _,bl as $,bi as aa,uC as ba,fw as ca,hi as da,lC as ea,iC as fa,sC as ga,ht as ha,A as ia,sm as ja,Z as ka,Eo as la,Bl as ma,Ro as na,xt as oa,yC as pa,SC as qa,xi as ra,zC as sa,Ni as ta,rR as ua,oR as va,ek as wa,uk as xa,gk as ya,iR as za,Tk as Aa,uR as Ba,Mm as Ca,Er as Da,om as Ea,Ek as Fa,Ck as Ga,Rk as Ha,gR as Ia,kk as Ja,yR as Ka,rD as La,oD as Ma,nD as Na,iD as Oa,sD as Pa,Dk as Qa,Om as Ra,qm as Sa,Nk as Ta,Bk as Ua,Gm as Va,Qk as Wa,GD as Xa,ct as Ya,oN as Za,Zm as _a,GN as $a,nN as ab,iN as bb,TN as cb,aN as db,cN as eb,lN as fb,mN as gb,kA as hb,NA as ib,bN as jb,KN as kb,PN as lb,CN as mb,RN as nb,HN as ob,DN as pb,sT as qb,aT as rb,dUe as sb,iB as tb};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=chunk-RFHVH32K.js.map
