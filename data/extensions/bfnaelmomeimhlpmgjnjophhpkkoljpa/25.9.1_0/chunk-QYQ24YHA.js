import{$b as ur,$c as mr,A as Qt,Aa as Yt,B as qt,C as Me,Ca as jt,Cc as Be,Db as De,Gc as lr,Hc as et,Ib as rr,Jb as nr,Kb as or,Lb as ar,Mb as Ue,Nb as Ze,Ob as ir,Qb as sr,Ta as $t,Va as zt,Wa as Xt,Wc as tt,Xc as v,Yb as ve,Zb as x,Zc as rt,_c as dr,ab as Jt,ad as gr,bd as fr,dc as cr,gd as yr,hc as Se,id as nt,jd as be,kd as ae,lb as ye,nb as Zt,ob as Pe,od as Sr,pd as ot,qb as er,rb as tr,rd as br,sc as pr,sd as at,td as Ar,ud as Tr,w as Wt,x as Ht,z as Ie}from"./chunk-PQZYPWXP.js";import{K as Gt,S as Kt,a as ze,c as Xe,j as Je,w as Vt}from"./chunk-LWOUUIX7.js";import{h as _t,r as Bn}from"./chunk-ETHULGZP.js";import{Cb as Lt,Cd as z,Ge as pe,K as Ct,L as w,S as ue,V as xt,W as Rt,c as Un,cb as Bt,eb as Ot,fe as Q,gb as C,gd as H,ib as $,lb as Nt,nb as ke,ob as ne,r as vn,rb as oe}from"./chunk-ERHX3GUR.js";import{n as Et}from"./chunk-WY7QFQOG.js";import{c as kt}from"./chunk-DHK5JDA3.js";import{a as m,m as E,n as vt}from"./chunk-FI5JCZQR.js";import{$ as D,B as $e,L as V,N as G,Q as K,V as W}from"./chunk-W476YZUB.js";import{A as It,C as Mt,L as Pt,Z as Dt,a as P,b as f,ba as Ut,l as fe,x as ce}from"./chunk-HTY4DAML.js";import{a as F}from"./chunk-6MAAUKN7.js";import{f as b,h as a,m as Buffer,n as i}from"./chunk-3KENBVE7.js";a();i();a();i();a();i();var ea=new Set(["trustedApplicationsByOwner","trustedApplicationsByOwnerBrowser","trustedApplicationsByOwnerMobile"]),ta="userTrustedApps";a();i();a();i();var ya="userExplorerPreferenceV2";a();i();var ka=new Error("Failed to get cluster from storage");var Ia={"mainnet-beta":$.Solana.Mainnet,devnet:$.Solana.Devnet,testnet:$.Solana.Testnet,localhost:$.Solana.Localnet};a();i();a();i();var Wa="isAnalyticsOptedOut";a();i();a();i();a();i();a();i();var wr=e=>{let{accountIdentifier:t,autoConfirmEnabled:r=!1,trustedAppsByAccount:n}=e;if(!t||!n)return;let o=Object.values(n),s=[],u=[];r?(o.forEach(p=>{p.autoConfirm&&Vt(p.autoConfirm)?s.push(p):u.push(p)}),s.sort((p,d)=>(d.autoConfirm?.sessionStartTime??0)-(p.autoConfirm?.sessionStartTime??0))):u=o;let l=It(u.map(p=>{let d=p.lastConnectedTimestamp??0;return{timestamp:d,data:{...p,lastConnectedTimestamp:d}}}));return{autoConfirmEnabledApps:s,timeBucketedApps:l}};a();i();var Fr=(e,t)=>{if(!t||e.autoConfirm?.sessionStartTime===void 0||e.autoConfirm?.maxSessionDuration===void 0)return;let r=new Date(e.autoConfirm?.sessionStartTime+e.autoConfirm?.maxSessionDuration*1e3);return Mt(r).format("h:mm A")};a();i();var Qn=P.object({data:P.string(),from:P.string(),to:P.string()}),qn=P.object({transaction:Qn});async function Yn({caip19:e,amount:t,owner:r}){let n=await ue.api().post("/tokens/v1/unwrap",{owner:r,caip19:e,amount:t.toNumber()}),o=qn.safeParse(n.data);if(!o.success){let{error:s}=o;throw D.captureError(s,"fungibles"),new ve(`Failed to get unwrap transaction: ${s.message}`)}return o.data.transaction}var jn=({caip19:e,amount:t,owner:r})=>K({gcTime:Ue.Medium,staleTime:1/0,enabled:r!==""&&t.isGreaterThan(0),queryKey:x.unwrapTransaction({caip19:e,amount:t,owner:r}),async queryFn(){return await Yn({caip19:e,amount:t,owner:r})}});a();i();function it(){let e=W(),t=H(),r=V();return G({async mutationFn({accountId:n,mutations:o}){await ur(e,t,{accountId:n,mutations:o})},async onSuccess(n,o){await r.invalidateQueries({queryKey:x.hiddenMints(o.accountId)})}})}a();i();var st=b(Bn());a();i();var Le={recipient:"",recipientHandle:"",addressBookRecipient:void 0,amountAsset:new f(0),amountUsd:0,transactionSpeed:"standard",solana:{references:[]},multichainTransaction:void 0},hr=class extends Error{constructor(t){super(t),this.name="SendFungibleFlowError"}};var Er={sendSessionId:"",fungibleKey:void 0,splTokenAccount:void 0,analyticsRecipient:void 0,sendFormValues:Le,shouldShowFiatValues:!1,retryArgs:void 0,confirmedFungibleAndSender:null},ut=pe((e,t)=>({...(0,st.default)(Er),resetSendSlice:()=>{let r=(0,st.default)(Er);r.sendSessionId=kt(),e(r)},setAnalyticsRecipient:r=>{e({analyticsRecipient:r})},setSendFungibleKey:(r,n)=>{e({fungibleKey:r,splTokenAccount:n})},setSendFormValues:r=>{e({sendFormValues:r})},setInputAmount:r=>{let n=t();e({sendFormValues:{...n.sendFormValues,inputAmount:r}})},setShouldShowFiatValues:r=>{e({shouldShowFiatValues:r})},setRetryArgs:r=>{e({retryArgs:r})}}));a();i();var Cr={collectible:void 0,sendFormValues:Le,shouldRequireAmount:!1},$n=pe(e=>({...Cr,resetSendSlice:()=>{e({...Cr})},setSendCollectible:t=>{e({collectible:t})},setSendFormValues:t=>{e({sendFormValues:t})},setShouldRequireAmount:t=>{e({shouldRequireAmount:t})}}));a();i();a();i();var zn={query:""},Xn=pe(e=>({...zn,setQuery:t=>{e({query:t})}}));a();i();a();i();a();i();var _e=b(Un(),1),Rr=b(vn(),1);var xr=(0,_e.struct)([(0,_e.u8)("instruction")]);function kr(e,t,r,n=[],o=ye){let s=tr([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],r,n),u=Buffer.alloc(xr.span);return xr.encode({instruction:er.CloseAccount},u),new Rr.TransactionInstruction({keys:s,programId:o,data:u})}var Pr=b(F());a();i();function Ir(e,t,r){return w.PublicKey.findProgramAddressSync([e.toBuffer(),r.toBuffer(),t.toBuffer()],Zt)[0]}var Jn=new ve("Unable to unwrap SOL. Wrapped SOL Token account does not exist.");function ct(){let{connection:e}=Be(),{data:t}=Q(),{solanaChainAddress:r,accountIdentifier:n}=(0,Pr.useMemo)(()=>({solanaChainAddress:t?.addresses.find(oe),accountIdentifier:t?.identifier??""}),[t]),o=W(),s=z(),{t:u}=E();return G({mutationFn:async()=>{if(!r)return Promise.reject("solanaChainAddress not loaded");let{networkID:l,address:p}=r,d=new w.PublicKey(p),g=Ir(d,Pe,ye);if(!await e.getAccountInfo(g))throw Jn;let S=kr(g,d,d,[],ye),R=new Ct.Transaction().add(S),U={ownerAddress:p,networkID:l,data:{signature:""},type:"unwrapSOL",display:{summary:{topLeft:{text:u("assetDetailUnwrappingSOL")}}}},Z=await De({accountIdentifier:n,accountSigner:s,connection:e,feePayer:new w.PublicKey(p),pendingTransactionInput:U,storage:o,transaction:R,useSubmissionService:!1});return{networkID:l,id:Z}}})}a();i();var Dr=b(F());var Zn=()=>{let{connection:e}=Be(),{data:t}=Q(),{solanaChainAddress:r,accountIdentifier:n}=(0,Dr.useMemo)(()=>({solanaChainAddress:t?.addresses.find(oe),accountIdentifier:t?.identifier??""}),[t]),o=W(),s=z(),{t:u}=E();return G({mutationFn:async l=>{if(!r)throw new Error("solanaChainAddress not loaded");if(l.type!=="CompressedSPL")throw new Error("SPL is not compressed");let p=await rr({owner:l.data.walletAddress,mint:l.data.mintAddress,amount:l.data.amount,programId:l.data.programId,connection:e}),{networkID:d,address:g}=r,y={ownerAddress:g,networkID:d,data:{signature:""},type:"decompress",display:{summary:{topLeft:{text:u("assetDetailClaiming")}}}};await De({accountIdentifier:n,accountSigner:s,connection:e,feePayer:new w.PublicKey(g),pendingTransactionInput:y,storage:o,transaction:p,useSubmissionService:!1})}})};a();i();var dt=b(F());a();i();var pt=new f(0),lt=({chainAddress:e,type:t,balance:r,decimals:n,recipient:o,gasEstimation:s,clampToZero:u=!0})=>{let{data:l,isLoading:p}=et(e);if(!t||!r)return pt;let d=new f(r).multipliedBy(Ut(n));if(!v(t))return d;if(!s)return;let g=new f(0);if(Ie(s))g=d.minus(new f(s.value));else if(qt(s)){let{gasLimit:y,maxFeePerGas:S,l1Fee:R=new f(0)}=s,U=y.times(S).plus(R);g=d.minus(U)}else if(Me(s)){if(!e||p)return;let y=e.addressType,S=l?.safeToSendUtxos??[],R=Ht(s.btcPerKilobyte),U=o&&Bt.safeParse(o).success?o:"bc1p",ie=[{value:S.reduce((B,ee)=>B.plus(new f(ee.value)),new f(0)).toNumber(),address:U}],Y=$t(y,S,ie,R.toNumber(),[]);if(Y.type==="error")g=new f(Y.maxAmount).integerValue(f.ROUND_DOWN);else{let{inputs:B,fee:ee}=Y;g=B.reduce((de,k)=>de.plus(new f(k.value)),new f(0)).minus(ee).integerValue(f.ROUND_DOWN)}}else if(Qt(s))g=d.minus(s.gasBudget);else return fe(s);return g.isGreaterThan(pt)?g:u?pt:g};a();i();var Ur=(e,t,r)=>{let n=Sr(e,t),{fungibles:o,isLoadingTokens:s,isErrorTokens:u,isErrorPrices:l}=ae({...r,keys:n?[n]:[]});return{isError:l||u,fungible:o.length===1?o[0]:void 0,isLoading:s}};var eo=(e,t,r,n=new f(0),o)=>{let{fungible:s,isLoading:u,isError:l}=Ur(e,t),p="unknown",d="",g=(0,dt.useMemo)(()=>{let S=s?.data.walletAddress;if(!S)return;let R=Lt(e,S);return{networkID:e,address:S,addressType:R}},[e,s?.data.walletAddress]),y=lt({chainAddress:g,type:s?.type,balance:s?.data.balance,decimals:s?.data.decimals??0,recipient:o,gasEstimation:r,clampToZero:!1});return!l&&s&&y&&(y.gte(n)?p="sufficient":p="insufficient",d=s.data.symbol||""),(0,dt.useMemo)(()=>({hasSufficientFunds:p,nativeTokenSymbol:d,isLoading:u,isError:l}),[p,d,u,l])};a();i();var Nr=b(F());a();i();var mt=b(F());a();i();var vr=({chainAddresses:e=[]})=>{let t=x.tokensErrorCount(e);return K({queryKey:t,initialData:0})};a();i();var to=({errors:e})=>e;function Br({chainAddresses:e,queryOptions:t}){return yr({select:to,chainAddresses:e,queryOptions:t})}var Or=3,ro=1,Ve=({networkID:e,chainAddresses:t=[]})=>{let{data:r=[]}=Br({chainAddresses:t}),{data:n=0}=vr({chainAddresses:t}),o=n>=Or,{data:s=0}=pr(),u=s>=Or,l=r.length===ro&&r.some(g=>g.code==="TokensTrimmed"),{t:p}=E(),d=(0,mt.useMemo)(()=>{if(o)return p("partialErrorGeneric");let g=r.filter(S=>e?S.details.chainId===e:!0),y=g.length+(u?1:0);return y?y>1?p("partialErrorGeneric"):u?p("partialErrorTokenPrices"):l?p("partialErrorTokensTrimmed"):e?p("partialErrorTokenDetail"):p("partialErrorBalanceChainName",{chainName:C.getChainName(g[0].details.chainId)}):""},[o,r,u,e,l,p]);return(0,mt.useMemo)(()=>({partialErrorMessage:d,shouldShowPartialError:d!==""}),[d])};function no(e){let{onTappingBuy:t,onTappingReceive:r,onTappingSend:n,onTappingSwap:o,account:s}=e,{shouldShowPartialError:u,partialErrorMessage:l}=Ve({chainAddresses:s?.addresses});return{ctaActions:oo({onTappingBuy:t,onTappingReceive:r,onTappingSend:n,onTappingSwap:o}),shouldShowPartialError:u,partialErrorMessage:l}}function oo(e){let{t}=E();return(0,Nr.useMemo)(()=>{let n=[];return n.push({text:t("commandSend"),type:"send",onClick:e.onTappingSend}),n.push({text:t("commandSwap"),type:"swap",onClick:e.onTappingSwap}),n.push({text:t("commandReceive"),type:"receive",onClick:e.onTappingReceive}),n.push({text:t("commandBuy"),type:"buy",onClick:e.onTappingBuy}),n.sort((o,s)=>(ot.get(o.type)??100)-(ot.get(s.type)??100)),{primary:n,more:[]}},[t,e.onTappingSend,e.onTappingSwap,e.onTappingReceive,e.onTappingBuy])}a();i();a();i();a();i();a();i();var ao="TokenDetailNotLoading";async function gt(e){let t=ke(e.caip19),r=t.resourceType==="nativeToken"?t.slip44:t.address,n=await ue.api().timeout(ce({seconds:10})).get(`/tokens/v1/${t.chainId}/${t.resourceType}/${r}`);if(n.status!==200)throw new vt({key:ao});let o=await n.data;sr.parse(o.data);let s=o.data.description,u=s&&s.replace(/<[^>]*>/g,"");return{...o,data:{...o.data,description:u}}}a();i();var _r={fungibleDetail({caip19:e}){return["fungibleDetail",{caip19:e}]}};var io="get-fungible-detail",Vr=e=>({gcTime:Ue.Short,staleTime:Ze.Long,queryKey:_r.fungibleDetail({caip19:e.caip19}),async queryFn(){try{return(await gt(e)).data}catch(t){if(Rt(t)){let r=t.response?.status;ir(t,r,io)}throw t}}});function ft(e){return K(Vr(e))}var q=b(F());a();i();var Wr=b(F());a();i();var Gr=({canSwap:e,fungible:t,openBuySellToken:r})=>({swapBuy:{enabled:e,onClick:()=>r(ne(be(t)),"buy")},swapSell:{enabled:e&&new f(t.data.amount?t.data.amount:0).gt(0),onClick:()=>r(ne(be(t)),"sell")}});a();i();var so=[{type:"swapBuy",textKey:"commandBuy"},{type:"swapSell",textKey:"commandSell"}],Kr=({t:e,trackFooterCtaClick:t,enabledCtas:r})=>so.reduce((n,o)=>{let s=r[o.type];return s===void 0?n:!!("enabled"in s?s.enabled:s.onClick)&&s.onClick?[...n,{type:o.type,text:e(o.textKey),onClick:()=>{t(o.type),s.onClick()}}]:n},[]);var Hr=({fungible:e,canSwap:t,openBuySellToken:r})=>{let{t:n}=E(),o=H();return(0,Wr.useMemo)(()=>e?Kr({t:n,trackFooterCtaClick:u=>{o.capture("fungibleFooterCtaClicked",{data:{action:u,caip19:ne(be(e))}})},enabledCtas:{...Gr({canSwap:t,fungible:e,openBuySellToken:r})}}):[],[o,e,r,t,n])};a();i();function co({fungibleDetail:e,showSummaryTooltip:t,copyAddress:r,fungibleType:n}){if(!e)return;let o=[];A(o,m.t("nounSymbol"),e.symbol),A(o,m.t("nounNetwork"),e.chain.name),A(o,Ot.safeParse(e.chain.id).success?m.t("publicFungibleDetailMint"):m.t("publicFungibleDetailContract"),r),un(o,m.t("publicFungibleDetailMarketCap"),e.marketCap);let s=he(e.totalSupply);A(o,m.t("publicFungibleDetailTotalSupply"),s);let u=he(e.circulatingSupply);A(o,m.t("publicFungibleDetailCirculatingSupply"),u);let l=go(e.maxSupply);A(o,m.t("publicFungibleDetailMaxSupply"),l);let p=he(e.holders);A(o,m.t("publicFungibleDetailHolders"),p);let d=mo(e.mintExtensions?.find(mr)?.state.newerTransferFee.transferFeeBasisPoints);return A(o,m.t("sendFungibleTransferFee"),d,m.t("sendFungibleTransferFeeToolTip"),t),n==="CompressedSPL"&&A(o,m.t("assetDetailCompressed"),m.t("assetDetailCompressedYes")),o}function po(e){if(!e)return;let t=[],r=Fe(e.volume24hUSDChangePercentage,{includePlusPrefix:!0});un(t,m.t("publicFungibleDetailVolume"),e.volume24hUSD,r);let n=he(e.trades24h),o=Fe(e.trades24hChangePercentage,{includePlusPrefix:!0});Yr(t,m.t("publicFungibleDetailTrades"),n,o);let s=he(e.uniqueWallets24h),u=Fe(e.uniqueWallets24hChangePercentage,{includePlusPrefix:!0});return Yr(t,m.t("publicFungibleDetailTraders"),s,u),t.length>0?t:void 0}function lo(e,t){if(!e)return;let r=[],n=Fe(e.top10HoldersPercent);A(r,m.t("publicFungibleDetailTop10Holders"),n,m.t("publicFungibleDetailTop10HoldersTooltip"),t);let o=Ge(e.mintable);A(r,m.t("publicFungibleDetailMintable"),o,m.t("publicFungibleDetailMintableTooltip"),t);let s=Ge(e.mutableMetadata);A(r,m.t("publicFungibleDetailMutableInfo"),s,m.t("publicFungibleDetailMutableInfoTooltip"),t);let u=Ge(e.ownershipRenounced);A(r,m.t("publicFungibleDetailOwnershipRenounced"),u,m.t("publicFungibleDetailOwnershipRenouncedTooltip"),t);let l=Qr(e.updateAuthority);A(r,m.t("publicFungibleDetailUpdateAuthority"),l,m.t("publicFungibleDetailUpdateAuthorityTooltip"),t);let p=Qr(e.freezeAuthority);A(r,m.t("publicFungibleDetailFreezeAuthority"),p,m.t("publicFungibleDetailFreezeAuthorityTooltip"),t);let d=qr(e.mintExtensions?.find(gr)?.state.delegate);A(r,m.t("permanentDelegateTitle"),d,m.t("permanentDelegateTooltipValue"),t);let g=qr(e.mintExtensions?.find(fr));return A(r,m.t("sendFungibleNonTransferable"),g,m.t("sendFungibleNonTransferableToolTip"),t),r.length>0?r:void 0}function jr(e,{derivedSpamStatus:t,caip19:r,hasFungibleDetail:n}){t!=="VERIFIED"&&n&&e.push({type:"ugcWarningBanner",data:{caip19:r,spamStatus:t}})}function $r(e,{fungible:t,derivedSpamStatus:r,onMarkNotSpamAsync:n}){r!=="VERIFIED"&&t&&r&&r==="POSSIBLE_SPAM"&&e.push({type:"spamTreatment",data:{fungible:t,spamStatus:r,markAsNotSpam:n}})}function zr(e,{isLoading:t,shouldShowPartialError:r,partialErrorMessage:n}){!t&&r&&e.push({type:"partialError",data:n})}function Xr(e,{caip19:t}){e.push({type:"priceHistory",data:{caip19:t}})}function Jr(e,{isLoading:t,isErrorFungibleDetail:r}){t||!r||e.push({type:"error",data:void 0})}function Zr(e,{isLoading:t,actions:r}){if(t){e.push({type:"cta",data:{status:"pending"}});return}r.primary.length>0&&e.push({type:"cta",data:{status:"success",actions:r}})}function en(e,{isLoading:t,fungible:r,isReadOnly:n}){if(t){e.push({type:"balance",data:{status:"pending"}});return}r&&(e.push({type:"balance",data:{status:"success",fungible:r}}),!n&&r.type==="SolanaNative"&&(e.push({type:"sectionHeader",data:m.t("assetDetailStakingLabel")}),e.push({type:"staking",data:r})))}function tn(e,{isLoading:t,fungibleDetail:r}){if(t){e.push({type:"about",data:{status:"pending"}});return}r?.description&&e.push({type:"sectionHeader",data:m.t("publicFungibleDetailAbout")},{type:"about",data:{status:"success",description:r.description.trim()}})}function rn(e,{isLoading:t,fungibleDetail:r,trackLink:n}){t||!r?.links||e.push({type:"links",data:{links:r.links,trackAction:n}})}function nn(e,{isLoading:t,fungible:r,fungibleKeys:n,caip19:o,derivedSpamStatus:s}){t||!r||r.data.balance.gt(0)&&s!=="POSSIBLE_SPAM"&&r.type!=="CompressedSPL"&&e.push({type:"transactionHistory",data:{fungible:r,caip19:o,fungibleKey:(n??[]).find(Boolean)}})}function on(e,{isLoading:t,fungibleDetail:r,showSummaryTooltip:n}){if(t)return;let o=lo(r,n);o&&e.push({type:"sectionHeader",data:m.t("publicFungibleDetailSecurity")},{type:"table",data:{key:"security",rows:o}})}function an(e,{isLoading:t,fungibleDetail:r}){if(t)return;let n=po(r);n&&e.push({type:"sectionHeader",data:m.t("publicFungibleDetailPerformance")},{type:"table",data:{key:"performance",rows:n}})}function sn(e,{isLoading:t,fungibleDetail:r,fungibleType:n,copyAddress:o,showSummaryTooltip:s,caip19:u}){if(t)return;let l=co({fungibleDetail:r,fungibleType:n,copyAddress:o,showSummaryTooltip:s});l&&(e.push({type:"sectionHeader",data:m.t("publicFungibleDetailInfo")}),e.push({type:"tableWithBondingCurveProgress",data:{caip19:u,rows:l,key:"info"}}))}var Qr=e=>e?_t(e):void 0,mo=e=>e?Fe(dr(e)):void 0,Fe=(e,t)=>e?Dt(e/100,t):void 0,he=e=>e?at(e):void 0,go=e=>e===null?"\u221E":e===void 0?void 0:at(e),Ge=e=>e==null?void 0:e?m.t("nounYes"):m.t("nounNo"),qr=e=>e==null?void 0:Ge(!!e);function A(e,t,r,n,o){r&&e.push({label:t,value:r,tooltipContent:n,handleTooltip:o?()=>{o(t,n??"")}:void 0})}function Yr(e,t,r,n,o,s){!r||!n||e.push({label:t,value:r,change:n,tooltipContent:o,handleTooltip:s?()=>{s(t,o??"")}:void 0})}function un(e,t,r,n){if(!r)return;let o={label:t,value:null,usdValue:r};n&&(o.change=n),e.push(o)}a();i();var yt={control:{showSwapButtons:!1,replaceSwapCta:!1},"show-swap-buttons":{showSwapButtons:!0,replaceSwapCta:!1},"replace-swap-cta":{showSwapButtons:!0,replaceSwapCta:!0}},cn=()=>{let e=$e.getMultivariateAssignment("swap-buysell-buttons-config"),t=e?yt[e]:null;return t||($e.isFeatureEnabled("swap-buysell-buttons-config")?yt["show-swap-buttons"]:yt.control)};a();i();var J=b(F());a();i();var pn=b(F());var St=e=>{let{data:t}=Kt();return(0,pn.useMemo)(()=>{if(!e||!t)return;let r=e.data.chain.id,n=t.explorers[r]??ze.get(r).defaultExplorer,o,s;if(v(e.type))s="address",o=e.data.walletAddress;else switch(e.type){case"SuiCoin":{s="token",o=e.data.contractAddress;break}case"ERC20":{s="address",o=e.data.contractAddress;break}case"SPL":case"CompressedSPL":{s="address",o=e.data.mintAddress;break}case"BRC20":return{explorerName:"Unisat",explorerUrl:`https://unisat.io/brc20?q=${e.data.walletAddress}`}}let u=Je({networkID:r,endpoint:s,explorerType:n,param:o});return{explorerName:Xe[n],explorerUrl:u}},[e,t])};var fo=[{type:"receive",text:"commandReceive"},{type:"send",text:"commandSend"},{type:"decompress",text:"commandClaim"},{type:"swap",text:"commandSwap"},{type:"buy",text:"commandBuy"},{type:"share",text:"commandShare"},{text:"assetDetailStakeSOL",singleWordAltText:"commandStake",type:"stakeSol",menuOnly:!0},{text:"commandMintLST",singleWordAltText:"commandMintLST",type:"mintLST",menuOnly:!0},{text:"assetDetailUnwrapAll",singleWordAltText:"commandUnwrap",type:"unwrapWrappedSol",menuOnly:!0},{text:"commandStake",singleWordAltText:"commandStake",type:"stake",menuOnly:!0},{text:"commandUnstake",singleWordAltText:"commandUnstake",type:"unstake",menuOnly:!0},{text:"commandReportAsSpam",type:"reportAsSpam",isDestructive:!0,menuOnly:!0},{text:"commandReportAsNotSpam",type:"reportAsNotSpam",isDestructive:!0,menuOnly:!0},{text:"",singleWordAltText:"commandView",type:"viewOnExplorer",menuOnly:!0}];function yo(e,t){return fo.reduce((r,n)=>{let o=e[n.type];return o===void 0?r:!!("enabled"in o?o.enabled:o.onClick)&&o.onClick?[...r,{...n,onClick:o.onClick,text:o.text?o.text:t(n.text),..."singleWordAltText"in n&&{singleWordAltText:t(n.singleWordAltText)},..."typeSpecificMetadata"in o&&{typeSpecificMetadata:o.typeSpecificMetadata}}]:r},[])}function dn(e){let{accountId:t,caip19:r,showCashBuyText:n,canBuy:o,canSwap:s,fungible:u,fungibleCaip19:l,openBuy:p,openLink:d,openSwapper:g,onReceive:y,onSend:S,title:R,onShare:U,onUnwrapWrappedSol:Z,onDecompressSpl:ie,onStakeSol:Y,derivedSpamStatus:B,onNativeMintLSTPress:ee,onStakeLSTPress:Ee,onUnstakeLSTPress:de,isReadOnly:k}=e,{t:me}=E(),{data:Ce}=Gt(),{onMarkAsSpam:O,onMarkNotSpam:j}=bt({fungible:u,accountId:t,fungibleCaip19:l}),se=ln(y,u),N=ln(S,u),ge=u?.type==="CompressedSPL",He=(0,J.useCallback)(()=>{r&&g({buyFungibleCaip19:r})},[r,g]),L=St(u),Qe=(0,J.useCallback)(()=>{L?.explorerUrl&&d(L?.explorerUrl)},[L?.explorerUrl,d]),_=!!u&&u.data.balance.gt(0),xe=v(u?.type),te=!!u&&!!u.data.walletAddress,M={caip19:r,hasBalance:_,title:R},T=Tr.getUrlFromFungible({caip19:l,isAnalyticsOptedOut:!!Ce}),re=u&&u.type==="SPL"&&u?.data.tokenAddress===Pe.toBase58()&&!k&&u.data.balance.isGreaterThan(f(nr).dividedBy(w.LAMPORTS_PER_SOL)),{mutateAsync:qe}=ct(),Ye=yo({receive:{enabled:!k&&(_||xe)&&te,onClick:se,typeSpecificMetadata:M},send:{enabled:!k&&_&&!ge,onClick:N,typeSpecificMetadata:M},decompress:{enabled:ge,onClick:ie&&u?()=>{ie(u)}:void 0},swap:{enabled:!k&&s,onClick:He,typeSpecificMetadata:M},buy:{enabled:!k&&o,onClick:p,text:n?me("commandCashBuy"):void 0,typeSpecificMetadata:M},unwrapWrappedSol:{enabled:re,onClick:Z?()=>Z(qe):void 0},stakeSol:{enabled:!k&&u?.type==="SolanaNative",onClick:Y,typeSpecificMetadata:M},mintLST:{enabled:!k&&_,onClick:ee},stake:{enabled:!k&&_,onClick:Ee},unstake:{enabled:!k&&_,onClick:de},share:{onClick:T?()=>U(T):void 0,typeSpecificMetadata:M},reportAsSpam:{enabled:B&&!Se(B),onClick:O,typeSpecificMetadata:M},reportAsNotSpam:{enabled:B&&Se(B),onClick:j,typeSpecificMetadata:M},viewOnExplorer:{enabled:!!L,onClick:Qe,text:me("assetDetailViewOnExplorer",{explorer:L?.explorerName}),typeSpecificMetadata:{...M,origin:Pt(L?.explorerUrl)}}},me);return br(Ye,4)}function ln(e,t){return(0,J.useMemo)(()=>{if(e)return()=>{t&&e(t)}},[e,t])}function bt({fungible:e,accountId:t,fungibleCaip19:r}){let n=H(),{mutateAsync:o}=it(),s=(0,J.useCallback)(async()=>{!e||!t||(n.capture("fungiblesReportAsNotSpam",{data:{caip19:ne(r)}}),await o({accountId:t,mutations:[{fungibleKey:e.data.key,visibility:"visible:reported_notSpam"}]}))},[t,e,o,n,r]),u=(0,J.useCallback)(()=>{s()},[s]);return{onMarkAsSpam:(0,J.useMemo)(()=>{if(e&&v(e.type))return;let p=Ar({analytics:n,fungible:e,accountId:t,setVisibilityOverrides:o});if(p)return()=>{p()}},[t,e,o,n]),onMarkNotSpam:u,onMarkNotSpamAsync:s}}function So(e){let{fungibleAnalytics:t,caip19:r,canBuy:n,canSwap:o,entryPoint:s,fungibleKey:u,openBuy:l,openLink:p,openSwapper:d,openBuySellToken:g,showSummaryTooltip:y,title:S,onShare:R,onSend:U,onReceive:Z,copyAddress:ie,refetchBondingCurve:Y,onUnwrapWrappedSol:B,onDecompressSpl:ee,onStakeSol:Ee,onNativeMintLSTPress:de,onStakeLSTPress:k,onUnstakeLSTPress:me}=e,Ce=H(),O=(0,q.useMemo)(()=>ke(r),[r]),{data:j}=Q(),se=j?.isReadOnly??!1,{data:N,refetch:ge,isError:He}=ft({caip19:r}),L=Eo(u,O);!u&&C.getChainName(O.chainId)===C.bitcoin.name&&O.resourceType==="nativeToken"&&(L=rt(O,j?.addresses.find(je=>je.networkID==="bip122:000000000019d6689c085ae165831e93")?.address));let{fungibles:Qe,isLoadingTokens:_,refetch:xe}=ae({keys:L}),te=Fo(Qe),M=ho(N,te,S),T=bo({fungible:te,fungibleDetail:N,fungibleCaip19:O}),I=_||!T,re=wo({fungible:T,accountId:j?.identifier}),{onMarkNotSpamAsync:qe}=bt({fungible:T,accountId:j?.identifier,fungibleCaip19:O}),{partialErrorMessage:Ye,shouldShowPartialError:Rn}=Ve({chainAddresses:j?.addresses,networkID:O.chainId}),At=(0,q.useRef)(!1);(0,q.useEffect)(()=>{!At.current&&!_&&(At.current=!0,t.onPublicFungiblePageOpen({caip19:r,address:T?.data.key??"",symbol:T?.data.symbol??"",uiContext:{name:s},hasBalance:!!T?.data.balance.gt(0)}))},[t,r,T,s,_]);let kn=(0,q.useCallback)(()=>{Promise.all([ge(),xe(),Y()])},[ge,xe,Y]),In=(0,q.useCallback)(je=>{Ce.capture("onPublicFungibleLinkOpen",{data:{url:je}})},[Ce]),Tt=Co({networkEnabled:o(T?.data.chain.id),isCompressedSPL:T?.type==="CompressedSPL",derivedSpamStatus:re}),wt=(0,q.useMemo)(()=>cn(),[]),Ft=wt.showSwapButtons,Mn=Ft&&!se&&Tt,Pn=!wt.replaceSwapCta&&Tt,Dn=Hr({fungible:T,openBuySellToken:g,canSwap:Mn}),Re=dn({caip19:r,showCashBuyText:Ft,canBuy:n,canSwap:Pn,fungible:T,fungibleCaip19:O,openBuy:l,openLink:p,openSwapper:d,onSend:U,onReceive:Z,title:M,onShare:R,isReadOnly:se,derivedSpamStatus:re,accountId:j?.identifier,onUnwrapWrappedSol:B,onDecompressSpl:ee,onStakeSol:Ee,onNativeMintLSTPress:de,onStakeLSTPress:k,onUnstakeLSTPress:me}),ht=!se&&Re.primary.length===0&&Re.more.length>0,h=[];return zr(h,{isLoading:I,shouldShowPartialError:Rn,partialErrorMessage:Ye}),Xr(h,{isLoading:I,caip19:r}),Zr(h,{isLoading:I,actions:Re}),$r(h,{fungible:T,derivedSpamStatus:re,onMarkNotSpamAsync:qe}),jr(h,{derivedSpamStatus:re,caip19:r,hasFungibleDetail:!!N}),en(h,{isLoading:I,fungible:te,isReadOnly:se}),Jr(h,{isLoading:I,isErrorFungibleDetail:He}),tn(h,{isLoading:I,fungibleDetail:N}),rn(h,{isLoading:I,fungibleDetail:N,trackLink:In}),sn(h,{isLoading:I,fungibleDetail:N,copyAddress:ie,showSummaryTooltip:y,caip19:r,fungibleType:te?.type}),an(h,{isLoading:I,fungibleDetail:N}),on(h,{isLoading:I,fungibleDetail:N,showSummaryTooltip:y}),nn(h,{isLoading:I,fungible:te,fungibleKeys:L,caip19:r,derivedSpamStatus:re}),{title:M,caip19:r,fungible:T,items:h,actions:ht?Re:void 0,showMoreInHeader:ht,isLoading:I,footerButtons:Dn,refetch:kn}}function bo({fungible:e,fungibleDetail:t,fungibleCaip19:r}){if(e)return e;if(!t)return;let n="address"in r?Ao(r,t):To(r,t);if(n)return n;D.captureError(new Error(`Fungible type could not be derived from ${JSON.stringify(r)}`),"fungibles")}function Ao(e,t){let r=tt(e);if(v(r))throw new Error("Cannot create fake non-native fungible for native token");let n=t.address??e.address,o={amount:"0",balance:f(0),chain:t.chain,decimals:t.decimals,logoUri:t.logoURI??t.logoUri,name:t.name??"Unknown",symbol:t.symbol??"Unknown",key:n,walletAddress:"",spamStatus:t.spamStatus};switch(r){case"SPL":return{type:r,data:{...o,mintAddress:n,programId:"",splTokenAccountPubkey:""}};case"CompressedSPL":return{type:r,data:{...o,mintAddress:n,programId:""}};case"ERC20":case"SuiCoin":return{type:r,data:{...o,contractAddress:n}};case"BRC20":return{type:r,data:{...o,firstCreatedInscriptionId:n}};default:fe(r)}}function To(e,t){let r=tt(e),n={amount:"0",balance:f(0),chain:t.chain,decimals:t.decimals,logoUri:t.logoURI??t.logoUri,name:t.name??"Unknown",symbol:t.symbol??"Unknown",key:r,walletAddress:"",spamStatus:t.spamStatus};switch(e.slip44){case"501":return{type:"SolanaNative",data:n};case"0":return{type:"BitcoinNative",data:n};case"60":return{type:"EthereumNative",data:n};case"8453":return{type:"BaseNative",data:n};case"143":return{type:"MonadNative",data:n};case"966":return{type:"PolygonNative",data:n};case"784":return{type:"SuiNative",data:n};default:{let o=new Error("Missing native token implementation when creating fake a Fungible");throw fe(e.slip44,o),o}}}function wo({fungible:e,accountId:t}){let{data:r}=nt(t??"");return e?cr(r,{key:e.data.key,spamStatus:e?.data.spamStatus??"NOT_VERIFIED"}):void 0}var Fo=e=>{if(e?.length)return e.reduce((t,r)=>!t||t.data.balance.lt(r.data.balance)?r:t,void 0)},ho=(e,t,r)=>e?.name||t?.data.name||r||"",Eo=(e,t)=>e?[e]:t?rt(t):void 0,Co=({networkEnabled:e,isCompressedSPL:t,derivedSpamStatus:r})=>e&&!t&&!!r&&!Se(r);a();i();var mn=b(F());var xo=({networkID:e,unsignedTransaction:t,pendingActivityRows:r,accountIdentifier:n,accountSigner:o,storage:s,includeCallPayload:u})=>({accountSigner:o,accountIdentifier:n,networkID:e,unsignedTransaction:t,...u&&{callPayload:{from:t.from,to:t.to,data:t.data,value:t.value}},pendingTransactionInput:{ownerAddress:t.from,networkID:e,data:{nonce:"",unsignedTransaction:t,hash:""},type:"swap",display:{summary:r}},storage:s}),Ro=async({t:e,fungible:t,unsignedUnwrapTx:r,gasEstimation:n,storage:o,accountMetadata:s,accountSigner:u})=>{if(!r)throw new Error("Unsigned unwrap transaction is required");if(!n)throw new Error("Gas estimation is required");let{chain:l,balance:p}=t.data;if(!C.isEthereumNetworkID(l.id))throw new Error(`Chain is not supported: ${l.id}`);let d=l.id,g={topRight:{text:`+${p} ${l.symbol}`},topLeft:{text:e("transactionsPendingSwapping")},bottomRight:{text:`-${p} ${t.data.symbol}`},bottomLeft:{text:`${t.data.name}`}},y=Et.parse({type:"0x2",chainId:C.getEVMNetworkIDValue(d),gas:`0x${n.gasLimit.toString(16)}`,maxFeePerGas:`0x${n.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${n.maxPriorityFeePerGas.toString(16)}`,...r}),S=xo({storage:o,accountSigner:u,pendingActivityRows:g,includeCallPayload:!1,networkID:d,unsignedTransaction:y,accountIdentifier:s.accountIdentifier});return Jt(S)},ko=()=>{let{data:e}=Q();return(0,mn.useMemo)(()=>{let r=e?.type,n=e?.name??"",o=e?.identifier??"";return{accountName:n,accountType:r,accountIdentifier:o}},[e])},Io=e=>{let t=W(),r=V(),{t:n}=E(),o=ko(),s=z();return G({async mutationFn({fungible:u,unsignedUnwrapTx:l,gasEstimation:p}){return await Ro({t:n,fungible:u,unsignedUnwrapTx:l,gasEstimation:p,accountMetadata:o,storage:t,accountSigner:s})},async onSuccess(){await r.invalidateQueries({queryKey:x.tokens(e)})}})};a();i();a();i();a();i();var gn=()=>{let{setRetryArgs:e}=ut();return t=>{if(t instanceof Xt){let{successfulTxIds:r}=t,[n,o]=r;e({type:"BRC20",commitTxId:n,revealTxId:o})}}};function Mo(){let e=W(),{data:t}=Q({select:u=>u.identifier}),r=gn(),n=lr(),o=z();return G({mutationFn:async({multichainTransaction:u,pendingTransactionInput:l,senderAddress:p,gasEstimation:d})=>{if(!t)throw new Error("No account identifier found");let{networkID:g}=u,y=await Yt.get(g).onBeforeSend({multichainTransaction:u,gasEstimation:d}),S=await ar({accountIdentifier:t,accountSigner:o,multichainTransaction:y,networkID:g,pendingTransactionInput:l,senderAddress:p,storage:e,utxoManager:n});return or(g,S)},onError(u){u instanceof Error&&(D.captureError(u,"fungibles"),u instanceof zt&&r(u))}})}a();i();var fn=b(F());var Po=(e,t,r)=>{let n=V(),{fungibles:o}=ae({keys:[e]}),s=o.length===1?o[0]:void 0;(0,fn.useEffect)(()=>{if(!s)return;let{type:u,data:l}=s,{balance:p,decimals:d,chain:g}=l,{id:y}=g,S=v(u)===!0;if(!r||!p||S||p.isEqualTo(t))return;let R=x.transferFungibleLoggingContext(e),U={transactionId:r,decimals:d,chainId:y,isNativeToken:S,previousBalance:p,fungibleKey:e};n.setQueryData(R,U)},[r])};a();i();var yn=ce({minutes:1}),Do=(e,t=!0)=>{let r=x.solanaBalance(e);return K({enabled:!!e&&t&&oe(e),gcTime:yn,staleTime:yn,queryKey:r,async queryFn(){if(!e)throw new Error("No chain address provided");if(oe(e))return jt(e.networkID).getBalance(new w.PublicKey(e.address));throw new Error(`SOL balance not implemented for ${e.networkID}`)}})};a();i();a();i();var Sn=b(F());var Uo=e=>{let t=V();return(0,Sn.useCallback)(()=>t.invalidateQueries({queryKey:x.tokens(e)}),[t,e])};a();i();var bn=b(F()),vo=(e,t)=>(0,bn.useMemo)(()=>{if(e)if(Me(e)){let r=Wt(e).toNumber().toLocaleString("en-US");return{leftSubtext:void 0,leftSubtextColor:void 0,rightSubtext:t("satsAmount",{sats:r.toString()})}}else return Ie(e)&&e.highFees?{leftSubtext:t("notificationTransactionApprovalNetworkFeeHighWarning"),leftSubtextColor:"#ffdc62",rightSubtext:""}:void 0},[e,t]);a();i();var Bo=b(F());a();i();a();i();var xn=b(F());a();i();var We=(o=>(o.FAIL_SEVERE="FAIL_SEVERE",o.FAIL_HIGH="FAIL_HIGH",o.NO_ACTION="NO_ACTION",o.DATA_NOT_FOUND="DATA_NOT_FOUND",o))(We||{}),Oo=P.object({action:P.nativeEnum(We),address:Nt,expirationUnixtimeInSec:P.number().nullish().default(null)}),An=P.object({addressScreenResults:P.array(Oo)}),Ke=class extends Error{constructor(t){super(t),this.name="WalletScreenError"}};a();i();a();i();var No="@phantom/wallet-screening",Tn=`${No}:wallet-screen-action`,wn={walletScreenAction(e){return[Tn,e]}};a();i();var Fn=new Error("Failed to fetch wallet screen action.");async function hn(e){try{let t=await ue.api().post("/wallet_screen/v1",e);if(!xt(t))throw Fn;let r=t.data;return An.parse(r)}catch{throw Fn}}var En=ce({days:7}),Cn=e=>{let t=e!==void 0&&C.isMainnetNetworkID(e.networkID),r=[];if(e!==void 0){let l=C.isEVMNetworkID(e.networkID)?e.address.toLowerCase():e.address;r=[{chainId:e.networkID,address:l,resourceType:"address"}]}let n={addresses:r},o=V(),s=wn.walletScreenAction(n),u=[s[0]];return K({enabled:t,queryKey:s,gcTime:En,staleTime:En,refetchInterval:!1,refetchOnMount:!1,async queryFn(){if(Lo(o,u))return"FAIL_SEVERE";let p=await hn(n);return _o(p)}})},Lo=(e,t)=>{let r=e.getQueriesData({queryKey:t,exact:!1}),n=!1;for(let[o,s]of r){let u=s;if(u&&u==="FAIL_SEVERE"){n=!0;break}}return n},_o=e=>{let t=e.addressScreenResults;return t.some(r=>r.action==="FAIL_SEVERE")?"FAIL_SEVERE":t.some(r=>r.action==="FAIL_HIGH")?"FAIL_HIGH":t.some(r=>r.action==="NO_ACTION")?"NO_ACTION":"DATA_NOT_FOUND"};var Vo=(e,t)=>{let r=H(),{data:n}=Cn(e);switch((0,xn.useEffect)(()=>{n&&e&&r.capture("walletScreened",{data:{walletScreen:{action:n.toString(),surface:t},chainId:C.getChainID(e.networkID),networkId:e.networkID}})},[n,e,t,r]),n){case"FAIL_SEVERE":case"FAIL_HIGH":throw new Ke(`Transaction disabled: ${t}`);case"NO_ACTION":case"DATA_NOT_FOUND":return}};a();i();a();i();export{wr as a,Fr as b,kr as c,jn as d,it as e,hr as f,ut as g,$n as h,Mo as i,Po as j,lt as k,ct as l,Zn as m,Do as n,eo as o,no as p,Uo as q,vo as r,So as s,Io as t,Ke as u,Tn as v,Vo as w};
//# sourceMappingURL=chunk-QYQ24YHA.js.map
